./doc/RTD/source/RadiativeTransfer/full_dependency_graph_RT.dot:
  275 : 	 drift_gpart->drift_gpart_out[color=red3,fontcolor=red3]
  276 : 	 drift_gpart->send_gpart[color=red3,fontcolor=red3]
  293 : 	 send_gpart->grav_down[color=red3,fontcolor=red3]
  313 : 	 recv_gpart->pair_grav[color=red3,fontcolor=red3]
./doc/RTD/source/Task/grav.dot:
   46 : 	 drift_gpart->drift_gpart_out[fontcolor=red3,color=red3]
   47 : 	 drift_gpart->send_gpart[fontcolor=red3,color=red3]
   51 : 	 send_gpart->grav_down[fontcolor=red3,color=red3]
   52 : 	 recv_gpart->pair_grav[fontcolor=red3,color=red3]
./doc/RTD/source/Task/reduced.dot:
   50 : 	 drift_gpart->grav[fontcolor=red3,color=red3]
./src/black_holes/EAGLE/black_holes.h:
  230 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
  231 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
  232 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
  409 :   bp->gpart->mass += gas_mass;
  437 :   bp->gpart->v_full[0] = bp->v[0];
  438 :   bp->gpart->v_full[1] = bp->v[1];
  439 :   bp->gpart->v_full[2] = bp->v[2];
  506 :   bpi->gpart->mass += bpj->mass;
  522 :   bpi->gpart->v_full[0] = bpi->v[0];
  523 :   bpi->gpart->v_full[1] = bpi->v[1];
  524 :   bpi->gpart->v_full[2] = bpi->v[2];
./src/black_holes/SIMBA/black_holes.h:
  229 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
  230 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
  231 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
  410 :   bp->gpart->mass += gas_mass;
  438 :   bp->gpart->v_full[0] = bp->v[0];
  439 :   bp->gpart->v_full[1] = bp->v[1];
  440 :   bp->gpart->v_full[2] = bp->v[2];
  503 :   bpi->gpart->mass += bpj->mass;
  519 :   bpi->gpart->v_full[0] = bpi->v[0];
  520 :   bpi->gpart->v_full[1] = bpi->v[1];
  521 :   bpi->gpart->v_full[2] = bpi->v[2];
./src/black_holes/SPIN_JET/black_holes.h:
  269 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
  270 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
  271 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
  469 :   bp->gpart->mass += gas_mass;
  497 :   bp->gpart->v_full[0] = bp->v[0];
  498 :   bp->gpart->v_full[1] = bp->v[1];
  499 :   bp->gpart->v_full[2] = bp->v[2];
  570 :   bpi->gpart->mass += bpj->mass;
  620 :   bpi->gpart->v_full[0] = bpi->v[0];
  621 :   bpi->gpart->v_full[1] = bpi->v[1];
  622 :   bpi->gpart->v_full[2] = bpi->v[2];
./src/cell_convert_part.c:
  228 :       c->stars.parts[i + 1].gpart->id_or_neg_offset--;
  361 :       c->sinks.parts[i + 1].gpart->id_or_neg_offset--;
  489 :     /* Update the gpart->spart links (shift by 1) */
  574 :     p->gpart->time_bin = time_bin_inhibited;
  575 :     p->gpart->id_or_neg_offset = p->id;
  576 :     p->gpart->type = swift_type_dark_matter;
  647 :     sp->gpart->time_bin = time_bin_inhibited;
  648 :     sp->gpart->id_or_neg_offset = sp->id;
  649 :     sp->gpart->type = swift_type_dark_matter;
  686 :     bp->gpart->time_bin = time_bin_inhibited;
  687 :     bp->gpart->id_or_neg_offset = bp->id;
  688 :     bp->gpart->type = swift_type_dark_matter;
  724 :     sink->gpart->time_bin = time_bin_inhibited;
  725 :     sink->gpart->id_or_neg_offset = sink->id;
  726 :     sink->gpart->type = swift_type_dark_matter;
./src/cell_split.c:
  141 :             parts[j].gpart->id_or_neg_offset = -(j + parts_offset);
  148 :           parts[k].gpart->id_or_neg_offset = -(k + parts_offset);
  260 :             sparts[j].gpart->id_or_neg_offset = -(j + sparts_offset);
  266 :           sparts[k].gpart->id_or_neg_offset = -(k + sparts_offset);
  315 :             bparts[j].gpart->id_or_neg_offset = -(j + bparts_offset);
  321 :           bparts[k].gpart->id_or_neg_offset = -(k + bparts_offset);
  370 :             sinks[j].gpart->id_or_neg_offset = -(j + sinks_offset);
  376 :           sinks[k].gpart->id_or_neg_offset = -(k + sinks_offset);
  501 :         parts[i].gpart->id_or_neg_offset = -(i + parts_offset);
  552 :         sparts[i].gpart->id_or_neg_offset = -(i + sparts_offset);
  608 :         sinks[i].gpart->id_or_neg_offset = -(i + sinks_offset);
./src/common_io.c:
 1439 :  * @param vr_data The array of gpart-related VELOCIraptor output.
 1442 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
 1498 :  * @param vr_data The array of gpart-related VELOCIraptor output.
 1501 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
 1557 :  * @param vr_data The array of gpart-related VELOCIraptor output.
 1560 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
./src/engine_redistribute.c:
  363 :             if (parts[k + offset].gpart->id_or_neg_offset > 0)                 \
  365 :           parts[k + offset].gpart->id_or_neg_offset = -count;                  \
  560 :         parts[k].gpart->id_or_neg_offset = -k;
  563 :         parts[nr_parts].gpart->id_or_neg_offset = -nr_parts;
  581 :         s->sparts[k].gpart->id_or_neg_offset = -k;
  584 :         s->sparts[nr_sparts].gpart->id_or_neg_offset = -nr_sparts;
  602 :         s->bparts[k].gpart->id_or_neg_offset = -k;
  605 :         s->bparts[nr_bparts].gpart->id_or_neg_offset = -nr_bparts;
./src/engine_strays.c:
  107 :       s->parts[offset_parts + k].gpart->id_or_neg_offset =
  152 :       s->sparts[offset_sparts + k].gpart->id_or_neg_offset =
  195 :       s->bparts[offset_bparts + k].gpart->id_or_neg_offset =
  318 :         s->parts[k].gpart->id_or_neg_offset = -k;
  336 :         s->sparts[k].gpart->id_or_neg_offset = -k;
  354 :         s->bparts[k].gpart->id_or_neg_offset = -k;
./src/feedback/KIARA/feedback.h:
  346 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  374 :       sp->gpart->fof_data.group_stellar_mass;
  387 :       sp->gpart->fof_data.group_mass;
./src/feedback/KIARA/feedback_iact.h:
  198 :     pj->gpart->a_grav[1] * pj->gpart->v_full[2] -
  199 :         pj->gpart->a_grav[2] * pj->gpart->v_full[1],
  200 :     pj->gpart->a_grav[2] * pj->gpart->v_full[0] -
  201 :         pj->gpart->a_grav[0] * pj->gpart->v_full[2],
  202 :     pj->gpart->a_grav[0] * pj->gpart->v_full[1] -
  203 :         pj->gpart->a_grav[1] * pj->gpart->v_full[0]
  232 :       pj->gpart->fof_data.group_stellar_mass;
  660 :       pow(pi->gpart->fof_data.group_stellar_mass / 102.329, 0.26178) *
  664 :   if (pi->gpart->fof_data.group_stellar_mass==0.f) warning("Wind particle is not linked to any galaxy");
  680 :       phys_const->const_newton_G*pi->gpart->fof_data.group_mass *
  785 :         pi->gpart->fof_data.group_mass * fb_props->mass_to_solar_mass, 
./src/feedback/SIMBA/feedback.c:
   63 :   double galaxy_stellar_mass = p->gpart->fof_data.group_stellar_mass;
  145 :       p->gpart->fof_data.group_stellar_mass;
  151 :       p->gpart->fof_data.group_mass * fb_props->mass_to_solar_mass;
  235 :     p->gpart->a_grav[1] * p->gpart->v_full[2] - 
  236 :         p->gpart->a_grav[2] * p->gpart->v_full[1],
  237 :     p->gpart->a_grav[2] * p->gpart->v_full[0] - 
  238 :         p->gpart->a_grav[0] * p->gpart->v_full[2],
  239 :     p->gpart->a_grav[0] * p->gpart->v_full[1] - 
  240 :         p->gpart->a_grav[1] * p->gpart->v_full[0]
  272 :   p->gpart->fof_data.is_grouppable = 0;
./src/fof.c:
 3219 :       bp->gpart->fof_data.is_grouppable = 1;
 4559 :     p->gpart->fof_data.is_grouppable = 0;
 4575 :     p->gpart->fof_data.is_grouppable = 1;
 4577 :     p->gpart->fof_data.is_grouppable = 0;
 4581 :   p->gpart->fof_data.part_sfr = max(p->sf_data.SFR, 0.f);
 4585 :   sp->gpart->fof_data.is_grouppable = 1;
 4591 :   return gpart->fof_data.is_grouppable;
./src/fof_data:
    2 :   230 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
    3 :   231 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
    4 :   232 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
    5 :   409 :   bp->gpart->mass += gas_mass;
    6 :   437 :   bp->gpart->v_full[0] = bp->v[0];
    7 :   438 :   bp->gpart->v_full[1] = bp->v[1];
    8 :   439 :   bp->gpart->v_full[2] = bp->v[2];
    9 :   506 :   bpi->gpart->mass += bpj->mass;
   10 :   522 :   bpi->gpart->v_full[0] = bpi->v[0];
   11 :   523 :   bpi->gpart->v_full[1] = bpi->v[1];
   12 :   524 :   bpi->gpart->v_full[2] = bpi->v[2];
   14 :   229 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
   15 :   230 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
   16 :   231 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
   17 :   410 :   bp->gpart->mass += gas_mass;
   18 :   438 :   bp->gpart->v_full[0] = bp->v[0];
   19 :   439 :   bp->gpart->v_full[1] = bp->v[1];
   20 :   440 :   bp->gpart->v_full[2] = bp->v[2];
   21 :   503 :   bpi->gpart->mass += bpj->mass;
   22 :   519 :   bpi->gpart->v_full[0] = bpi->v[0];
   23 :   520 :   bpi->gpart->v_full[1] = bpi->v[1];
   24 :   521 :   bpi->gpart->v_full[2] = bpi->v[2];
   26 :   268 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
   27 :   269 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
   28 :   270 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
   29 :   465 :   bp->gpart->mass += gas_mass;
   30 :   493 :   bp->gpart->v_full[0] = bp->v[0];
   31 :   494 :   bp->gpart->v_full[1] = bp->v[1];
   32 :   495 :   bp->gpart->v_full[2] = bp->v[2];
   33 :   566 :   bpi->gpart->mass += bpj->mass;
   34 :   616 :   bpi->gpart->v_full[0] = bpi->v[0];
   35 :   617 :   bpi->gpart->v_full[1] = bpi->v[1];
   36 :   618 :   bpi->gpart->v_full[2] = bpi->v[2];
   38 :   228 :       c->stars.parts[i + 1].gpart->id_or_neg_offset--;
   39 :   361 :       c->sinks.parts[i + 1].gpart->id_or_neg_offset--;
   40 :   489 :     /* Update the gpart->spart links (shift by 1) */
   41 :   574 :     p->gpart->time_bin = time_bin_inhibited;
   42 :   575 :     p->gpart->id_or_neg_offset = p->id;
   43 :   576 :     p->gpart->type = swift_type_dark_matter;
   44 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
   45 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
   46 :   649 :     sp->gpart->type = swift_type_dark_matter;
   47 :   686 :     bp->gpart->time_bin = time_bin_inhibited;
   48 :   687 :     bp->gpart->id_or_neg_offset = bp->id;
   49 :   688 :     bp->gpart->type = swift_type_dark_matter;
   50 :   724 :     sink->gpart->time_bin = time_bin_inhibited;
   51 :   725 :     sink->gpart->id_or_neg_offset = sink->id;
   52 :   726 :     sink->gpart->type = swift_type_dark_matter;
   54 :   141 :             parts[j].gpart->id_or_neg_offset = -(j + parts_offset);
   55 :   148 :           parts[k].gpart->id_or_neg_offset = -(k + parts_offset);
   56 :   260 :             sparts[j].gpart->id_or_neg_offset = -(j + sparts_offset);
   57 :   266 :           sparts[k].gpart->id_or_neg_offset = -(k + sparts_offset);
   58 :   315 :             bparts[j].gpart->id_or_neg_offset = -(j + bparts_offset);
   59 :   321 :           bparts[k].gpart->id_or_neg_offset = -(k + bparts_offset);
   60 :   370 :             sinks[j].gpart->id_or_neg_offset = -(j + sinks_offset);
   61 :   376 :           sinks[k].gpart->id_or_neg_offset = -(k + sinks_offset);
   62 :   501 :         parts[i].gpart->id_or_neg_offset = -(i + parts_offset);
   63 :   552 :         sparts[i].gpart->id_or_neg_offset = -(i + sparts_offset);
   64 :   608 :         sinks[i].gpart->id_or_neg_offset = -(i + sinks_offset);
   66 :  1434 :  * @param vr_data The array of gpart-related VELOCIraptor output.
   67 :  1437 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
   68 :  1493 :  * @param vr_data The array of gpart-related VELOCIraptor output.
   69 :  1496 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
   70 :  1552 :  * @param vr_data The array of gpart-related VELOCIraptor output.
   71 :  1555 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
   73 :   363 :             if (parts[k + offset].gpart->id_or_neg_offset > 0)                 \
   74 :   365 :           parts[k + offset].gpart->id_or_neg_offset = -count;                  \
   75 :   560 :         parts[k].gpart->id_or_neg_offset = -k;
   76 :   563 :         parts[nr_parts].gpart->id_or_neg_offset = -nr_parts;
   77 :   581 :         s->sparts[k].gpart->id_or_neg_offset = -k;
   78 :   584 :         s->sparts[nr_sparts].gpart->id_or_neg_offset = -nr_sparts;
   79 :   602 :         s->bparts[k].gpart->id_or_neg_offset = -k;
   80 :   605 :         s->bparts[nr_bparts].gpart->id_or_neg_offset = -nr_bparts;
   82 :   107 :       s->parts[offset_parts + k].gpart->id_or_neg_offset =
   83 :   152 :       s->sparts[offset_sparts + k].gpart->id_or_neg_offset =
   84 :   195 :       s->bparts[offset_bparts + k].gpart->id_or_neg_offset =
   85 :   318 :         s->parts[k].gpart->id_or_neg_offset = -k;
   86 :   336 :         s->sparts[k].gpart->id_or_neg_offset = -k;
   87 :   354 :         s->bparts[k].gpart->id_or_neg_offset = -k;
   89 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
   90 :   349 :       sp->gpart->fof_data.group_stellar_mass;
   91 :   355 :       sp->gpart->fof_data.group_mass;
   93 :   198 :     pj->gpart->a_grav[1] * pj->gpart->v_full[2] -
   94 :   199 :         pj->gpart->a_grav[2] * pj->gpart->v_full[1],
   95 :   200 :     pj->gpart->a_grav[2] * pj->gpart->v_full[0] -
   96 :   201 :         pj->gpart->a_grav[0] * pj->gpart->v_full[2],
   97 :   202 :     pj->gpart->a_grav[0] * pj->gpart->v_full[1] -
   98 :   203 :         pj->gpart->a_grav[1] * pj->gpart->v_full[0]
   99 :   232 :       pj->gpart->fof_data.group_stellar_mass;
  100 :   658 :       pow(pi->gpart->fof_data.group_stellar_mass / 102.329, 0.26178) *
  101 :   662 :   if (pi->gpart->fof_data.group_stellar_mass==0.f) warning("Wind particle is not linked to any galaxy");
  102 :   678 :       phys_const->const_newton_G*pi->gpart->fof_data.group_mass *
  104 :    63 :   double galaxy_stellar_mass = p->gpart->fof_data.group_stellar_mass;
  105 :   145 :       p->gpart->fof_data.group_stellar_mass;
  106 :   151 :       p->gpart->fof_data.group_mass * fb_props->mass_to_solar_mass;
  107 :   235 :     p->gpart->a_grav[1] * p->gpart->v_full[2] - 
  108 :   236 :         p->gpart->a_grav[2] * p->gpart->v_full[1],
  109 :   237 :     p->gpart->a_grav[2] * p->gpart->v_full[0] - 
  110 :   238 :         p->gpart->a_grav[0] * p->gpart->v_full[2],
  111 :   239 :     p->gpart->a_grav[0] * p->gpart->v_full[1] - 
  112 :   240 :         p->gpart->a_grav[1] * p->gpart->v_full[0]
  113 :   272 :   p->gpart->fof_data.is_grouppable = 0;
  115 :  2435 :       bp->gpart->fof_data.is_grouppable = 1;
  116 :  3603 :     p->gpart->fof_data.is_grouppable = 0;
  117 :  3619 :     p->gpart->fof_data.is_grouppable = 1;
  118 :  3621 :     p->gpart->fof_data.is_grouppable = 0;
  119 :  3625 :   p->gpart->fof_data.part_sfr = max(p->sf_data.SFR, 0.f);
  120 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  121 :  3636 :   return gpart->fof_data.is_grouppable;
  123 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  124 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  125 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
  126 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  127 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  128 :   536 :   355 :       sp->gpart->fof_data.group_mass;
  129 :   670 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  130 :   707 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  131 :   708 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  132 :   709 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
  133 :  1183 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  134 :  1184 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  135 :  1185 :   536 :   355 :       sp->gpart->fof_data.group_mass;
  136 :  1261 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
  137 :  1269 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
  138 :  1270 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
  139 :  1271 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
  140 :  1272 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  141 :  1273 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  142 :  1274 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  143 :  1275 :   331 :   sp->gpart->v_full[0] = sp->v[0];
  144 :  1276 :   332 :   sp->gpart->v_full[1] = sp->v[1];
  145 :  1277 :   333 :   sp->gpart->v_full[2] = sp->v[2];
  146 :  1447 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
  147 :  1490 :   251 :   sp->gpart->mass += gas_mass;
  148 :  1506 :   279 :   sp->gpart->v_full[0] = sp->v[0];
  149 :  1507 :   280 :   sp->gpart->v_full[1] = sp->v[1];
  150 :  1508 :   281 :   sp->gpart->v_full[2] = sp->v[2];
  151 :  1586 :   274 :   sp->gpart->x[0] = sp->x[0];
  152 :  1587 :   275 :   sp->gpart->x[1] = sp->x[1];
  153 :  1588 :   276 :   sp->gpart->x[2] = sp->x[2];
  154 :  1591 :   339 :     sp->gpart->mass = mass_star;
  155 :  1664 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  156 :  1665 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  157 :  1666 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  158 :  1818 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  159 :  1819 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  160 :  1820 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  161 :  1972 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  162 :  1973 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  163 :  1974 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  164 :  2121 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  165 :  2122 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  166 :  2123 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  167 :  2270 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  168 :  2271 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  169 :  2272 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  170 :  2420 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  171 :  2421 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  172 :  2422 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  173 :  2569 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  174 :  2570 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  175 :  2571 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  176 :  2718 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  177 :  2719 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  178 :  2720 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  179 :  2869 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  180 :  2870 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  181 :  2871 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  182 :  3018 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  183 :  3019 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  184 :  3020 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  185 :  3167 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  186 :  3168 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  187 :  3169 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  189 :    31 :   ret[0] = p->gpart->fof_data.group_id;
  190 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
  191 :    43 :   ret[0] = bp->gpart->fof_data.group_id;
  193 :   136 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  194 :   137 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  195 :   138 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  196 :   143 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  197 :   144 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  198 :   145 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  200 :    54 :     acc[0] += p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  201 :    55 :     acc[1] += p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  202 :    56 :     acc[2] += p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  204 :   127 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  205 :   128 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  206 :   129 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  207 :   134 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  208 :   135 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  209 :   136 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  211 :   138 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  212 :   139 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  213 :   140 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  214 :   145 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  215 :   146 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  216 :   147 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  218 :    98 :     p->gpart->v_full[0] = p->v_full[0];
  219 :    99 :     p->gpart->v_full[1] = p->v_full[1];
  220 :   100 :     p->gpart->v_full[2] = p->v_full[2];
  222 :   254 :     p->gpart->mass = p->conserved.mass;
  224 :   149 :     p->gpart->v_full[0] = p->v[0];
  225 :   150 :     p->gpart->v_full[1] = p->v[1];
  226 :   151 :     p->gpart->v_full[2] = p->v[2];
  228 :   696 :     a_grav[0] = p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  229 :   697 :     a_grav[1] = p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  230 :   698 :     a_grav[2] = p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  231 :   700 :     grav_kick_factor[0] = dt_grav * p->gpart->a_grav[0];
  232 :   701 :     grav_kick_factor[1] = dt_grav * p->gpart->a_grav[1];
  233 :   702 :     grav_kick_factor[2] = dt_grav * p->gpart->a_grav[2];
  234 :   704 :       grav_kick_factor[0] += dt_grav_mesh * p->gpart->a_grav_mesh[0];
  235 :   705 :       grav_kick_factor[1] += dt_grav_mesh * p->gpart->a_grav_mesh[1];
  236 :   706 :       grav_kick_factor[2] += dt_grav_mesh * p->gpart->a_grav_mesh[2];
  238 :   310 :     v[0] += p->gpart->a_grav[0] * dt_kick_grav;
  239 :   311 :     v[1] += p->gpart->a_grav[1] * dt_kick_grav;
  240 :   312 :     v[2] += p->gpart->a_grav[2] * dt_kick_grav;
  242 :   141 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  243 :   142 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  244 :   143 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  245 :   148 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  246 :   149 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  247 :   150 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  249 :   137 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  250 :   138 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  251 :   139 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  252 :   144 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  253 :   145 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  254 :   146 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  256 :   152 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  257 :   153 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  258 :   154 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  259 :   159 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  260 :   160 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  261 :   161 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  263 :   138 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  264 :   139 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  265 :   140 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  266 :   145 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  267 :   146 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  268 :   147 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  270 :   139 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  271 :   140 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  272 :   141 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  273 :   146 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  274 :   147 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  275 :   148 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  277 :   139 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  278 :   140 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  279 :   141 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  280 :   146 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  281 :   147 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  282 :   148 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  284 :    54 :     acc[0] += p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  285 :    55 :     acc[1] += p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  286 :    56 :     acc[2] += p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  288 :   134 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  289 :   135 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  290 :   136 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  291 :   141 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  292 :   142 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  293 :   143 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  295 :   551 :     p->gpart->v_full[0] = p->v[0];
  296 :   552 :     p->gpart->v_full[1] = p->v[1];
  297 :   553 :     p->gpart->v_full[2] = p->v[2];
  299 :   250 :     p->v_full[0] += p->gpart->a_grav[0] * dt_kick_grav;
  300 :   251 :     p->v_full[1] += p->gpart->a_grav[1] * dt_kick_grav;
  301 :   252 :     p->v_full[2] += p->gpart->a_grav[2] * dt_kick_grav;
  302 :   257 :     p->v_full[0] += p->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  303 :   258 :     p->v_full[1] += p->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  304 :   259 :     p->v_full[2] += p->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  305 :   264 :     p->gpart->v_full[0] = p->v_full[0];
  306 :   265 :     p->gpart->v_full[1] = p->v_full[1];
  307 :   266 :     p->gpart->v_full[2] = p->v_full[2];
  308 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
  309 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
  310 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
  311 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  312 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  313 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  314 :   331 :   sp->gpart->v_full[0] = sp->v[0];
  315 :   332 :   sp->gpart->v_full[1] = sp->v[1];
  316 :   333 :   sp->gpart->v_full[2] = sp->v[2];
  317 :   378 :   bp->v[0] += bp->gpart->a_grav[0] * dt_kick_grav;
  318 :   379 :   bp->v[1] += bp->gpart->a_grav[1] * dt_kick_grav;
  319 :   380 :   bp->v[2] += bp->gpart->a_grav[2] * dt_kick_grav;
  320 :   383 :   bp->v[0] += bp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  321 :   384 :   bp->v[1] += bp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  322 :   385 :   bp->v[2] += bp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  323 :   388 :   bp->gpart->v_full[0] = bp->v[0];
  324 :   389 :   bp->gpart->v_full[1] = bp->v[1];
  325 :   390 :   bp->gpart->v_full[2] = bp->v[2];
  326 :   437 :   sink->v[0] += sink->gpart->a_grav[0] * dt_kick_grav;
  327 :   438 :   sink->v[1] += sink->gpart->a_grav[1] * dt_kick_grav;
  328 :   439 :   sink->v[2] += sink->gpart->a_grav[2] * dt_kick_grav;
  329 :   442 :   sink->v[0] += sink->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  330 :   443 :   sink->v[1] += sink->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  331 :   444 :   sink->v[2] += sink->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  332 :   447 :   sink->gpart->v_full[0] = sink->v[0];
  333 :   448 :   sink->gpart->v_full[1] = sink->v[1];
  334 :   449 :   sink->gpart->v_full[2] = sink->v[2];
  336 :    47 :       parts[k].gpart->id_or_neg_offset = -(k + offset);
  337 :    63 :       sparts[k].gpart->id_or_neg_offset = -(k + offset);
  338 :    79 :       sinks[k].gpart->id_or_neg_offset = -(k + offset);
  339 :    95 :       bparts[k].gpart->id_or_neg_offset = -(k + offset);
  340 :   433 :       if (parts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  341 :   438 :       if (parts[k].x[0] != parts[k].gpart->x[0] ||
  342 :   439 :           parts[k].x[1] != parts[k].gpart->x[1] ||
  343 :   440 :           parts[k].x[2] != parts[k].gpart->x[2])
  344 :   444 :       if (hydro_get_mass(&parts[k]) != parts[k].gpart->mass)
  345 :   448 :       if (parts[k].time_bin != parts[k].gpart->time_bin)
  346 :   460 :       if (sparts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  347 :   465 :       if (sparts[k].x[0] != sparts[k].gpart->x[0] ||
  348 :   466 :           sparts[k].x[1] != sparts[k].gpart->x[1] ||
  349 :   467 :           sparts[k].x[2] != sparts[k].gpart->x[2])
  350 :   471 :       if (sparts[k].mass != sparts[k].gpart->mass)
  351 :   475 :       if (sparts[k].time_bin != sparts[k].gpart->time_bin)
  352 :   487 :       if (bparts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  353 :   492 :       if (bparts[k].x[0] != bparts[k].gpart->x[0] ||
  354 :   493 :           bparts[k].x[1] != bparts[k].gpart->x[1] ||
  355 :   494 :           bparts[k].x[2] != bparts[k].gpart->x[2])
  356 :   498 :       if (bparts[k].mass != bparts[k].gpart->mass)
  357 :   502 :       if (bparts[k].time_bin != bparts[k].gpart->time_bin)
  358 :   514 :       if (sinks[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  359 :   519 :       if (sinks[k].x[0] != sinks[k].gpart->x[0] ||
  360 :   520 :           sinks[k].x[1] != sinks[k].gpart->x[1] ||
  361 :   521 :           sinks[k].x[2] != sinks[k].gpart->x[2])
  362 :   525 :       if (sinks[k].mass != sinks[k].gpart->mass)
  363 :   529 :       if (sinks[k].time_bin != sinks[k].gpart->time_bin)
  365 :   108 :         p->gpart->mass = hydro_get_mass(p);
  366 :   339 :         cell_bp->gpart->mass = cell_bp->mass;
  367 :   340 :         cell_bp->gpart->v_full[0] = cell_bp->v[0];
  368 :   341 :         cell_bp->gpart->v_full[1] = cell_bp->v[1];
  369 :   342 :         cell_bp->gpart->v_full[2] = cell_bp->v[2];
  371 :   187 :           xp->a_grav[0] = p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  372 :   188 :           xp->a_grav[1] = p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  373 :   189 :           xp->a_grav[2] = p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  374 :   747 :         if (p->gpart != NULL) p->gpart->time_bin = p->time_bin;
  375 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
  376 :  1008 :         sink->gpart->time_bin = get_time_bin(ti_new_step);
  377 :  1078 :         bp->gpart->time_bin = get_time_bin(ti_new_step);
  378 :  1445 :           p->gpart->time_bin = p->time_bin;
  379 :  1597 :         if (p->gpart != NULL) p->gpart->time_bin = new_time_bin;
  380 :  1620 :           p->gpart->time_bin = p->time_bin;
  382 :   251 :   sp->gpart->mass += gas_mass;
  383 :   279 :   sp->gpart->v_full[0] = sp->v[0];
  384 :   280 :   sp->gpart->v_full[1] = sp->v[1];
  385 :   281 :   sp->gpart->v_full[2] = sp->v[2];
  386 :   321 :   spi->gpart->mass += spj->mass;
  387 :   337 :   spi->gpart->v_full[0] = spi->v[0];
  388 :   338 :   spi->gpart->v_full[1] = spi->v[1];
  389 :   339 :   spi->gpart->v_full[2] = spi->v[2];
  391 :    66 :     float potential_i = pi->gpart->potential;
  392 :    67 :     float potential_j = pj->gpart->potential;
  394 :  2239 :       if (parts[k].time_bin != parts[k].gpart->time_bin) {
  395 :  2241 :               parts[k].gpart->time_bin);
  397 :   150 :     /* Check part->gpart->part linkeage. */
  398 :   151 :     if (p[k].gpart && p[k].gpart->id_or_neg_offset != -(k + delta))
  399 :   328 :     if (sp[k].gpart && sp[k].gpart->id_or_neg_offset != -(k + delta))
  400 :   419 :     if (bp[k].gpart && bp[k].gpart->id_or_neg_offset != -(k + delta))
  401 :   485 :     if (sink[k].gpart && sink[k].gpart->id_or_neg_offset != -(k + delta))
  403 :   223 :           s->parts[k].gpart->id_or_neg_offset = -k;
  404 :   226 :           s->parts[nr_parts].gpart->id_or_neg_offset = -nr_parts;
  405 :   275 :           s->sparts[k].gpart->id_or_neg_offset = -k;
  406 :   278 :           s->sparts[nr_sparts].gpart->id_or_neg_offset = -nr_sparts;
  407 :   325 :           s->bparts[k].gpart->id_or_neg_offset = -k;
  408 :   328 :           s->bparts[nr_bparts].gpart->id_or_neg_offset = -nr_bparts;
  409 :   376 :           s->sinks[k].gpart->id_or_neg_offset = -k;
  410 :   379 :           s->sinks[nr_sinks].gpart->id_or_neg_offset = -nr_sinks;
  412 :    76 :           parts[j].gpart->id_or_neg_offset = -(j + parts_offset);
  413 :    82 :         parts[k].gpart->id_or_neg_offset = -(k + parts_offset);
  414 :   138 :           sparts[j].gpart->id_or_neg_offset = -(j + sparts_offset);
  415 :   143 :         sparts[k].gpart->id_or_neg_offset = -(k + sparts_offset);
  416 :   199 :           bparts[j].gpart->id_or_neg_offset = -(j + bparts_offset);
  417 :   204 :         bparts[k].gpart->id_or_neg_offset = -(k + bparts_offset);
  418 :   259 :           sinks[j].gpart->id_or_neg_offset = -(j + sinks_offset);
  419 :   264 :         sinks[k].gpart->id_or_neg_offset = -(k + sinks_offset);
  421 :   274 :   sp->gpart->x[0] = sp->x[0];
  422 :   275 :   sp->gpart->x[1] = sp->x[1];
  423 :   276 :   sp->gpart->x[2] = sp->x[2];
  424 :   297 :   p->gpart->x[0] = p->x[0];
  425 :   298 :   p->gpart->x[1] = p->x[1];
  426 :   299 :   p->gpart->x[2] = p->x[2];
  427 :   339 :     sp->gpart->mass = mass_star;
  428 :   343 :     p->gpart->mass = new_mass_gas;
  430 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  431 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  432 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  434 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  435 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  436 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  438 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  439 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  440 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  441 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  442 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  443 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  444 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  445 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  446 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  447 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  448 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  449 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  450 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  451 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  452 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  453 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  454 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  455 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  457 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  458 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  459 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  460 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  461 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  462 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  463 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  464 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  465 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
./src/fof_data.:
    2 :   230 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
    3 :   231 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
    4 :   232 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
    5 :   409 :   bp->gpart->mass += gas_mass;
    6 :   437 :   bp->gpart->v_full[0] = bp->v[0];
    7 :   438 :   bp->gpart->v_full[1] = bp->v[1];
    8 :   439 :   bp->gpart->v_full[2] = bp->v[2];
    9 :   506 :   bpi->gpart->mass += bpj->mass;
   10 :   522 :   bpi->gpart->v_full[0] = bpi->v[0];
   11 :   523 :   bpi->gpart->v_full[1] = bpi->v[1];
   12 :   524 :   bpi->gpart->v_full[2] = bpi->v[2];
   14 :   229 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
   15 :   230 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
   16 :   231 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
   17 :   410 :   bp->gpart->mass += gas_mass;
   18 :   438 :   bp->gpart->v_full[0] = bp->v[0];
   19 :   439 :   bp->gpart->v_full[1] = bp->v[1];
   20 :   440 :   bp->gpart->v_full[2] = bp->v[2];
   21 :   503 :   bpi->gpart->mass += bpj->mass;
   22 :   519 :   bpi->gpart->v_full[0] = bpi->v[0];
   23 :   520 :   bpi->gpart->v_full[1] = bpi->v[1];
   24 :   521 :   bpi->gpart->v_full[2] = bpi->v[2];
   26 :   268 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
   27 :   269 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
   28 :   270 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
   29 :   465 :   bp->gpart->mass += gas_mass;
   30 :   493 :   bp->gpart->v_full[0] = bp->v[0];
   31 :   494 :   bp->gpart->v_full[1] = bp->v[1];
   32 :   495 :   bp->gpart->v_full[2] = bp->v[2];
   33 :   566 :   bpi->gpart->mass += bpj->mass;
   34 :   616 :   bpi->gpart->v_full[0] = bpi->v[0];
   35 :   617 :   bpi->gpart->v_full[1] = bpi->v[1];
   36 :   618 :   bpi->gpart->v_full[2] = bpi->v[2];
   38 :   228 :       c->stars.parts[i + 1].gpart->id_or_neg_offset--;
   39 :   361 :       c->sinks.parts[i + 1].gpart->id_or_neg_offset--;
   40 :   489 :     /* Update the gpart->spart links (shift by 1) */
   41 :   574 :     p->gpart->time_bin = time_bin_inhibited;
   42 :   575 :     p->gpart->id_or_neg_offset = p->id;
   43 :   576 :     p->gpart->type = swift_type_dark_matter;
   44 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
   45 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
   46 :   649 :     sp->gpart->type = swift_type_dark_matter;
   47 :   686 :     bp->gpart->time_bin = time_bin_inhibited;
   48 :   687 :     bp->gpart->id_or_neg_offset = bp->id;
   49 :   688 :     bp->gpart->type = swift_type_dark_matter;
   50 :   724 :     sink->gpart->time_bin = time_bin_inhibited;
   51 :   725 :     sink->gpart->id_or_neg_offset = sink->id;
   52 :   726 :     sink->gpart->type = swift_type_dark_matter;
   54 :   141 :             parts[j].gpart->id_or_neg_offset = -(j + parts_offset);
   55 :   148 :           parts[k].gpart->id_or_neg_offset = -(k + parts_offset);
   56 :   260 :             sparts[j].gpart->id_or_neg_offset = -(j + sparts_offset);
   57 :   266 :           sparts[k].gpart->id_or_neg_offset = -(k + sparts_offset);
   58 :   315 :             bparts[j].gpart->id_or_neg_offset = -(j + bparts_offset);
   59 :   321 :           bparts[k].gpart->id_or_neg_offset = -(k + bparts_offset);
   60 :   370 :             sinks[j].gpart->id_or_neg_offset = -(j + sinks_offset);
   61 :   376 :           sinks[k].gpart->id_or_neg_offset = -(k + sinks_offset);
   62 :   501 :         parts[i].gpart->id_or_neg_offset = -(i + parts_offset);
   63 :   552 :         sparts[i].gpart->id_or_neg_offset = -(i + sparts_offset);
   64 :   608 :         sinks[i].gpart->id_or_neg_offset = -(i + sinks_offset);
   66 :  1434 :  * @param vr_data The array of gpart-related VELOCIraptor output.
   67 :  1437 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
   68 :  1493 :  * @param vr_data The array of gpart-related VELOCIraptor output.
   69 :  1496 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
   70 :  1552 :  * @param vr_data The array of gpart-related VELOCIraptor output.
   71 :  1555 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
   73 :   363 :             if (parts[k + offset].gpart->id_or_neg_offset > 0)                 \
   74 :   365 :           parts[k + offset].gpart->id_or_neg_offset = -count;                  \
   75 :   560 :         parts[k].gpart->id_or_neg_offset = -k;
   76 :   563 :         parts[nr_parts].gpart->id_or_neg_offset = -nr_parts;
   77 :   581 :         s->sparts[k].gpart->id_or_neg_offset = -k;
   78 :   584 :         s->sparts[nr_sparts].gpart->id_or_neg_offset = -nr_sparts;
   79 :   602 :         s->bparts[k].gpart->id_or_neg_offset = -k;
   80 :   605 :         s->bparts[nr_bparts].gpart->id_or_neg_offset = -nr_bparts;
   82 :   107 :       s->parts[offset_parts + k].gpart->id_or_neg_offset =
   83 :   152 :       s->sparts[offset_sparts + k].gpart->id_or_neg_offset =
   84 :   195 :       s->bparts[offset_bparts + k].gpart->id_or_neg_offset =
   85 :   318 :         s->parts[k].gpart->id_or_neg_offset = -k;
   86 :   336 :         s->sparts[k].gpart->id_or_neg_offset = -k;
   87 :   354 :         s->bparts[k].gpart->id_or_neg_offset = -k;
   89 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
   90 :   349 :       sp->gpart->fof_data.group_stellar_mass;
   91 :   355 :       sp->gpart->fof_data.group_mass;
   93 :   198 :     pj->gpart->a_grav[1] * pj->gpart->v_full[2] -
   94 :   199 :         pj->gpart->a_grav[2] * pj->gpart->v_full[1],
   95 :   200 :     pj->gpart->a_grav[2] * pj->gpart->v_full[0] -
   96 :   201 :         pj->gpart->a_grav[0] * pj->gpart->v_full[2],
   97 :   202 :     pj->gpart->a_grav[0] * pj->gpart->v_full[1] -
   98 :   203 :         pj->gpart->a_grav[1] * pj->gpart->v_full[0]
   99 :   232 :       pj->gpart->fof_data.group_stellar_mass;
  100 :   658 :       pow(pi->gpart->fof_data.group_stellar_mass / 102.329, 0.26178) *
  101 :   662 :   if (pi->gpart->fof_data.group_stellar_mass==0.f) warning("Wind particle is not linked to any galaxy");
  102 :   678 :       phys_const->const_newton_G*pi->gpart->fof_data.group_mass *
  104 :    63 :   double galaxy_stellar_mass = p->gpart->fof_data.group_stellar_mass;
  105 :   145 :       p->gpart->fof_data.group_stellar_mass;
  106 :   151 :       p->gpart->fof_data.group_mass * fb_props->mass_to_solar_mass;
  107 :   235 :     p->gpart->a_grav[1] * p->gpart->v_full[2] - 
  108 :   236 :         p->gpart->a_grav[2] * p->gpart->v_full[1],
  109 :   237 :     p->gpart->a_grav[2] * p->gpart->v_full[0] - 
  110 :   238 :         p->gpart->a_grav[0] * p->gpart->v_full[2],
  111 :   239 :     p->gpart->a_grav[0] * p->gpart->v_full[1] - 
  112 :   240 :         p->gpart->a_grav[1] * p->gpart->v_full[0]
  113 :   272 :   p->gpart->fof_data.is_grouppable = 0;
  115 :  2435 :       bp->gpart->fof_data.is_grouppable = 1;
  116 :  3603 :     p->gpart->fof_data.is_grouppable = 0;
  117 :  3619 :     p->gpart->fof_data.is_grouppable = 1;
  118 :  3621 :     p->gpart->fof_data.is_grouppable = 0;
  119 :  3625 :   p->gpart->fof_data.part_sfr = max(p->sf_data.SFR, 0.f);
  120 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  121 :  3636 :   return gpart->fof_data.is_grouppable;
  123 :     2 :   230 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
  124 :     3 :   231 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
  125 :     4 :   232 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
  126 :     5 :   409 :   bp->gpart->mass += gas_mass;
  127 :     6 :   437 :   bp->gpart->v_full[0] = bp->v[0];
  128 :     7 :   438 :   bp->gpart->v_full[1] = bp->v[1];
  129 :     8 :   439 :   bp->gpart->v_full[2] = bp->v[2];
  130 :     9 :   506 :   bpi->gpart->mass += bpj->mass;
  131 :    10 :   522 :   bpi->gpart->v_full[0] = bpi->v[0];
  132 :    11 :   523 :   bpi->gpart->v_full[1] = bpi->v[1];
  133 :    12 :   524 :   bpi->gpart->v_full[2] = bpi->v[2];
  134 :    14 :   229 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
  135 :    15 :   230 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
  136 :    16 :   231 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
  137 :    17 :   410 :   bp->gpart->mass += gas_mass;
  138 :    18 :   438 :   bp->gpart->v_full[0] = bp->v[0];
  139 :    19 :   439 :   bp->gpart->v_full[1] = bp->v[1];
  140 :    20 :   440 :   bp->gpart->v_full[2] = bp->v[2];
  141 :    21 :   503 :   bpi->gpart->mass += bpj->mass;
  142 :    22 :   519 :   bpi->gpart->v_full[0] = bpi->v[0];
  143 :    23 :   520 :   bpi->gpart->v_full[1] = bpi->v[1];
  144 :    24 :   521 :   bpi->gpart->v_full[2] = bpi->v[2];
  145 :    26 :   268 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
  146 :    27 :   269 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
  147 :    28 :   270 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
  148 :    29 :   465 :   bp->gpart->mass += gas_mass;
  149 :    30 :   493 :   bp->gpart->v_full[0] = bp->v[0];
  150 :    31 :   494 :   bp->gpart->v_full[1] = bp->v[1];
  151 :    32 :   495 :   bp->gpart->v_full[2] = bp->v[2];
  152 :    33 :   566 :   bpi->gpart->mass += bpj->mass;
  153 :    34 :   616 :   bpi->gpart->v_full[0] = bpi->v[0];
  154 :    35 :   617 :   bpi->gpart->v_full[1] = bpi->v[1];
  155 :    36 :   618 :   bpi->gpart->v_full[2] = bpi->v[2];
  156 :    38 :   228 :       c->stars.parts[i + 1].gpart->id_or_neg_offset--;
  157 :    39 :   361 :       c->sinks.parts[i + 1].gpart->id_or_neg_offset--;
  158 :    40 :   489 :     /* Update the gpart->spart links (shift by 1) */
  159 :    41 :   574 :     p->gpart->time_bin = time_bin_inhibited;
  160 :    42 :   575 :     p->gpart->id_or_neg_offset = p->id;
  161 :    43 :   576 :     p->gpart->type = swift_type_dark_matter;
  162 :    44 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  163 :    45 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  164 :    46 :   649 :     sp->gpart->type = swift_type_dark_matter;
  165 :    47 :   686 :     bp->gpart->time_bin = time_bin_inhibited;
  166 :    48 :   687 :     bp->gpart->id_or_neg_offset = bp->id;
  167 :    49 :   688 :     bp->gpart->type = swift_type_dark_matter;
  168 :    50 :   724 :     sink->gpart->time_bin = time_bin_inhibited;
  169 :    51 :   725 :     sink->gpart->id_or_neg_offset = sink->id;
  170 :    52 :   726 :     sink->gpart->type = swift_type_dark_matter;
  171 :    54 :   141 :             parts[j].gpart->id_or_neg_offset = -(j + parts_offset);
  172 :    55 :   148 :           parts[k].gpart->id_or_neg_offset = -(k + parts_offset);
  173 :    56 :   260 :             sparts[j].gpart->id_or_neg_offset = -(j + sparts_offset);
  174 :    57 :   266 :           sparts[k].gpart->id_or_neg_offset = -(k + sparts_offset);
  175 :    58 :   315 :             bparts[j].gpart->id_or_neg_offset = -(j + bparts_offset);
  176 :    59 :   321 :           bparts[k].gpart->id_or_neg_offset = -(k + bparts_offset);
  177 :    60 :   370 :             sinks[j].gpart->id_or_neg_offset = -(j + sinks_offset);
  178 :    61 :   376 :           sinks[k].gpart->id_or_neg_offset = -(k + sinks_offset);
  179 :    62 :   501 :         parts[i].gpart->id_or_neg_offset = -(i + parts_offset);
  180 :    63 :   552 :         sparts[i].gpart->id_or_neg_offset = -(i + sparts_offset);
  181 :    64 :   608 :         sinks[i].gpart->id_or_neg_offset = -(i + sinks_offset);
  182 :    66 :  1434 :  * @param vr_data The array of gpart-related VELOCIraptor output.
  183 :    67 :  1437 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
  184 :    68 :  1493 :  * @param vr_data The array of gpart-related VELOCIraptor output.
  185 :    69 :  1496 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
  186 :    70 :  1552 :  * @param vr_data The array of gpart-related VELOCIraptor output.
  187 :    71 :  1555 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
  188 :    73 :   363 :             if (parts[k + offset].gpart->id_or_neg_offset > 0)                 \
  189 :    74 :   365 :           parts[k + offset].gpart->id_or_neg_offset = -count;                  \
  190 :    75 :   560 :         parts[k].gpart->id_or_neg_offset = -k;
  191 :    76 :   563 :         parts[nr_parts].gpart->id_or_neg_offset = -nr_parts;
  192 :    77 :   581 :         s->sparts[k].gpart->id_or_neg_offset = -k;
  193 :    78 :   584 :         s->sparts[nr_sparts].gpart->id_or_neg_offset = -nr_sparts;
  194 :    79 :   602 :         s->bparts[k].gpart->id_or_neg_offset = -k;
  195 :    80 :   605 :         s->bparts[nr_bparts].gpart->id_or_neg_offset = -nr_bparts;
  196 :    82 :   107 :       s->parts[offset_parts + k].gpart->id_or_neg_offset =
  197 :    83 :   152 :       s->sparts[offset_sparts + k].gpart->id_or_neg_offset =
  198 :    84 :   195 :       s->bparts[offset_bparts + k].gpart->id_or_neg_offset =
  199 :    85 :   318 :         s->parts[k].gpart->id_or_neg_offset = -k;
  200 :    86 :   336 :         s->sparts[k].gpart->id_or_neg_offset = -k;
  201 :    87 :   354 :         s->bparts[k].gpart->id_or_neg_offset = -k;
  202 :    89 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  203 :    90 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  204 :    91 :   355 :       sp->gpart->fof_data.group_mass;
  205 :    93 :   198 :     pj->gpart->a_grav[1] * pj->gpart->v_full[2] -
  206 :    94 :   199 :         pj->gpart->a_grav[2] * pj->gpart->v_full[1],
  207 :    95 :   200 :     pj->gpart->a_grav[2] * pj->gpart->v_full[0] -
  208 :    96 :   201 :         pj->gpart->a_grav[0] * pj->gpart->v_full[2],
  209 :    97 :   202 :     pj->gpart->a_grav[0] * pj->gpart->v_full[1] -
  210 :    98 :   203 :         pj->gpart->a_grav[1] * pj->gpart->v_full[0]
  211 :    99 :   232 :       pj->gpart->fof_data.group_stellar_mass;
  212 :   100 :   658 :       pow(pi->gpart->fof_data.group_stellar_mass / 102.329, 0.26178) *
  213 :   101 :   662 :   if (pi->gpart->fof_data.group_stellar_mass==0.f) warning("Wind particle is not linked to any galaxy");
  214 :   102 :   678 :       phys_const->const_newton_G*pi->gpart->fof_data.group_mass *
  215 :   104 :    63 :   double galaxy_stellar_mass = p->gpart->fof_data.group_stellar_mass;
  216 :   105 :   145 :       p->gpart->fof_data.group_stellar_mass;
  217 :   106 :   151 :       p->gpart->fof_data.group_mass * fb_props->mass_to_solar_mass;
  218 :   107 :   235 :     p->gpart->a_grav[1] * p->gpart->v_full[2] - 
  219 :   108 :   236 :         p->gpart->a_grav[2] * p->gpart->v_full[1],
  220 :   109 :   237 :     p->gpart->a_grav[2] * p->gpart->v_full[0] - 
  221 :   110 :   238 :         p->gpart->a_grav[0] * p->gpart->v_full[2],
  222 :   111 :   239 :     p->gpart->a_grav[0] * p->gpart->v_full[1] - 
  223 :   112 :   240 :         p->gpart->a_grav[1] * p->gpart->v_full[0]
  224 :   113 :   272 :   p->gpart->fof_data.is_grouppable = 0;
  225 :   115 :  2435 :       bp->gpart->fof_data.is_grouppable = 1;
  226 :   116 :  3603 :     p->gpart->fof_data.is_grouppable = 0;
  227 :   117 :  3619 :     p->gpart->fof_data.is_grouppable = 1;
  228 :   118 :  3621 :     p->gpart->fof_data.is_grouppable = 0;
  229 :   119 :  3625 :   p->gpart->fof_data.part_sfr = max(p->sf_data.SFR, 0.f);
  230 :   120 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  231 :   121 :  3636 :   return gpart->fof_data.is_grouppable;
  232 :   123 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  233 :   124 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  234 :   125 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
  235 :   126 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  236 :   127 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  237 :   128 :   536 :   355 :       sp->gpart->fof_data.group_mass;
  238 :   129 :   670 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  239 :   130 :   707 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  240 :   131 :   708 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  241 :   132 :   709 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
  242 :   133 :  1183 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  243 :   134 :  1184 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  244 :   135 :  1185 :   536 :   355 :       sp->gpart->fof_data.group_mass;
  245 :   136 :  1261 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
  246 :   137 :  1269 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
  247 :   138 :  1270 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
  248 :   139 :  1271 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
  249 :   140 :  1272 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  250 :   141 :  1273 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  251 :   142 :  1274 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  252 :   143 :  1275 :   331 :   sp->gpart->v_full[0] = sp->v[0];
  253 :   144 :  1276 :   332 :   sp->gpart->v_full[1] = sp->v[1];
  254 :   145 :  1277 :   333 :   sp->gpart->v_full[2] = sp->v[2];
  255 :   146 :  1447 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
  256 :   147 :  1490 :   251 :   sp->gpart->mass += gas_mass;
  257 :   148 :  1506 :   279 :   sp->gpart->v_full[0] = sp->v[0];
  258 :   149 :  1507 :   280 :   sp->gpart->v_full[1] = sp->v[1];
  259 :   150 :  1508 :   281 :   sp->gpart->v_full[2] = sp->v[2];
  260 :   151 :  1586 :   274 :   sp->gpart->x[0] = sp->x[0];
  261 :   152 :  1587 :   275 :   sp->gpart->x[1] = sp->x[1];
  262 :   153 :  1588 :   276 :   sp->gpart->x[2] = sp->x[2];
  263 :   154 :  1591 :   339 :     sp->gpart->mass = mass_star;
  264 :   155 :  1664 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  265 :   156 :  1665 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  266 :   157 :  1666 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  267 :   158 :  1818 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  268 :   159 :  1819 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  269 :   160 :  1820 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  270 :   161 :  1972 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  271 :   162 :  1973 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  272 :   163 :  1974 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  273 :   164 :  2121 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  274 :   165 :  2122 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  275 :   166 :  2123 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  276 :   167 :  2270 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  277 :   168 :  2271 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  278 :   169 :  2272 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  279 :   170 :  2420 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  280 :   171 :  2421 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  281 :   172 :  2422 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  282 :   173 :  2569 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  283 :   174 :  2570 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  284 :   175 :  2571 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  285 :   176 :  2718 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  286 :   177 :  2719 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  287 :   178 :  2720 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  288 :   179 :  2869 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  289 :   180 :  2870 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  290 :   181 :  2871 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  291 :   182 :  3018 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  292 :   183 :  3019 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  293 :   184 :  3020 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  294 :   185 :  3167 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  295 :   186 :  3168 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  296 :   187 :  3169 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  297 :   189 :    31 :   ret[0] = p->gpart->fof_data.group_id;
  298 :   190 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
  299 :   191 :    43 :   ret[0] = bp->gpart->fof_data.group_id;
  300 :   193 :   136 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  301 :   194 :   137 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  302 :   195 :   138 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  303 :   196 :   143 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  304 :   197 :   144 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  305 :   198 :   145 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  306 :   200 :    54 :     acc[0] += p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  307 :   201 :    55 :     acc[1] += p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  308 :   202 :    56 :     acc[2] += p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  309 :   204 :   127 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  310 :   205 :   128 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  311 :   206 :   129 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  312 :   207 :   134 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  313 :   208 :   135 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  314 :   209 :   136 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  315 :   211 :   138 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  316 :   212 :   139 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  317 :   213 :   140 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  318 :   214 :   145 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  319 :   215 :   146 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  320 :   216 :   147 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  321 :   218 :    98 :     p->gpart->v_full[0] = p->v_full[0];
  322 :   219 :    99 :     p->gpart->v_full[1] = p->v_full[1];
  323 :   220 :   100 :     p->gpart->v_full[2] = p->v_full[2];
  324 :   222 :   254 :     p->gpart->mass = p->conserved.mass;
  325 :   224 :   149 :     p->gpart->v_full[0] = p->v[0];
  326 :   225 :   150 :     p->gpart->v_full[1] = p->v[1];
  327 :   226 :   151 :     p->gpart->v_full[2] = p->v[2];
  328 :   228 :   696 :     a_grav[0] = p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  329 :   229 :   697 :     a_grav[1] = p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  330 :   230 :   698 :     a_grav[2] = p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  331 :   231 :   700 :     grav_kick_factor[0] = dt_grav * p->gpart->a_grav[0];
  332 :   232 :   701 :     grav_kick_factor[1] = dt_grav * p->gpart->a_grav[1];
  333 :   233 :   702 :     grav_kick_factor[2] = dt_grav * p->gpart->a_grav[2];
  334 :   234 :   704 :       grav_kick_factor[0] += dt_grav_mesh * p->gpart->a_grav_mesh[0];
  335 :   235 :   705 :       grav_kick_factor[1] += dt_grav_mesh * p->gpart->a_grav_mesh[1];
  336 :   236 :   706 :       grav_kick_factor[2] += dt_grav_mesh * p->gpart->a_grav_mesh[2];
  337 :   238 :   310 :     v[0] += p->gpart->a_grav[0] * dt_kick_grav;
  338 :   239 :   311 :     v[1] += p->gpart->a_grav[1] * dt_kick_grav;
  339 :   240 :   312 :     v[2] += p->gpart->a_grav[2] * dt_kick_grav;
  340 :   242 :   141 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  341 :   243 :   142 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  342 :   244 :   143 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  343 :   245 :   148 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  344 :   246 :   149 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  345 :   247 :   150 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  346 :   249 :   137 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  347 :   250 :   138 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  348 :   251 :   139 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  349 :   252 :   144 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  350 :   253 :   145 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  351 :   254 :   146 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  352 :   256 :   152 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  353 :   257 :   153 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  354 :   258 :   154 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  355 :   259 :   159 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  356 :   260 :   160 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  357 :   261 :   161 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  358 :   263 :   138 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  359 :   264 :   139 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  360 :   265 :   140 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  361 :   266 :   145 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  362 :   267 :   146 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  363 :   268 :   147 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  364 :   270 :   139 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  365 :   271 :   140 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  366 :   272 :   141 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  367 :   273 :   146 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  368 :   274 :   147 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  369 :   275 :   148 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  370 :   277 :   139 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  371 :   278 :   140 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  372 :   279 :   141 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  373 :   280 :   146 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  374 :   281 :   147 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  375 :   282 :   148 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  376 :   284 :    54 :     acc[0] += p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  377 :   285 :    55 :     acc[1] += p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  378 :   286 :    56 :     acc[2] += p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  379 :   288 :   134 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  380 :   289 :   135 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  381 :   290 :   136 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  382 :   291 :   141 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  383 :   292 :   142 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  384 :   293 :   143 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  385 :   295 :   551 :     p->gpart->v_full[0] = p->v[0];
  386 :   296 :   552 :     p->gpart->v_full[1] = p->v[1];
  387 :   297 :   553 :     p->gpart->v_full[2] = p->v[2];
  388 :   299 :   250 :     p->v_full[0] += p->gpart->a_grav[0] * dt_kick_grav;
  389 :   300 :   251 :     p->v_full[1] += p->gpart->a_grav[1] * dt_kick_grav;
  390 :   301 :   252 :     p->v_full[2] += p->gpart->a_grav[2] * dt_kick_grav;
  391 :   302 :   257 :     p->v_full[0] += p->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  392 :   303 :   258 :     p->v_full[1] += p->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  393 :   304 :   259 :     p->v_full[2] += p->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  394 :   305 :   264 :     p->gpart->v_full[0] = p->v_full[0];
  395 :   306 :   265 :     p->gpart->v_full[1] = p->v_full[1];
  396 :   307 :   266 :     p->gpart->v_full[2] = p->v_full[2];
  397 :   308 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
  398 :   309 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
  399 :   310 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
  400 :   311 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  401 :   312 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  402 :   313 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  403 :   314 :   331 :   sp->gpart->v_full[0] = sp->v[0];
  404 :   315 :   332 :   sp->gpart->v_full[1] = sp->v[1];
  405 :   316 :   333 :   sp->gpart->v_full[2] = sp->v[2];
  406 :   317 :   378 :   bp->v[0] += bp->gpart->a_grav[0] * dt_kick_grav;
  407 :   318 :   379 :   bp->v[1] += bp->gpart->a_grav[1] * dt_kick_grav;
  408 :   319 :   380 :   bp->v[2] += bp->gpart->a_grav[2] * dt_kick_grav;
  409 :   320 :   383 :   bp->v[0] += bp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  410 :   321 :   384 :   bp->v[1] += bp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  411 :   322 :   385 :   bp->v[2] += bp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  412 :   323 :   388 :   bp->gpart->v_full[0] = bp->v[0];
  413 :   324 :   389 :   bp->gpart->v_full[1] = bp->v[1];
  414 :   325 :   390 :   bp->gpart->v_full[2] = bp->v[2];
  415 :   326 :   437 :   sink->v[0] += sink->gpart->a_grav[0] * dt_kick_grav;
  416 :   327 :   438 :   sink->v[1] += sink->gpart->a_grav[1] * dt_kick_grav;
  417 :   328 :   439 :   sink->v[2] += sink->gpart->a_grav[2] * dt_kick_grav;
  418 :   329 :   442 :   sink->v[0] += sink->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  419 :   330 :   443 :   sink->v[1] += sink->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  420 :   331 :   444 :   sink->v[2] += sink->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  421 :   332 :   447 :   sink->gpart->v_full[0] = sink->v[0];
  422 :   333 :   448 :   sink->gpart->v_full[1] = sink->v[1];
  423 :   334 :   449 :   sink->gpart->v_full[2] = sink->v[2];
  424 :   336 :    47 :       parts[k].gpart->id_or_neg_offset = -(k + offset);
  425 :   337 :    63 :       sparts[k].gpart->id_or_neg_offset = -(k + offset);
  426 :   338 :    79 :       sinks[k].gpart->id_or_neg_offset = -(k + offset);
  427 :   339 :    95 :       bparts[k].gpart->id_or_neg_offset = -(k + offset);
  428 :   340 :   433 :       if (parts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  429 :   341 :   438 :       if (parts[k].x[0] != parts[k].gpart->x[0] ||
  430 :   342 :   439 :           parts[k].x[1] != parts[k].gpart->x[1] ||
  431 :   343 :   440 :           parts[k].x[2] != parts[k].gpart->x[2])
  432 :   344 :   444 :       if (hydro_get_mass(&parts[k]) != parts[k].gpart->mass)
  433 :   345 :   448 :       if (parts[k].time_bin != parts[k].gpart->time_bin)
  434 :   346 :   460 :       if (sparts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  435 :   347 :   465 :       if (sparts[k].x[0] != sparts[k].gpart->x[0] ||
  436 :   348 :   466 :           sparts[k].x[1] != sparts[k].gpart->x[1] ||
  437 :   349 :   467 :           sparts[k].x[2] != sparts[k].gpart->x[2])
  438 :   350 :   471 :       if (sparts[k].mass != sparts[k].gpart->mass)
  439 :   351 :   475 :       if (sparts[k].time_bin != sparts[k].gpart->time_bin)
  440 :   352 :   487 :       if (bparts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  441 :   353 :   492 :       if (bparts[k].x[0] != bparts[k].gpart->x[0] ||
  442 :   354 :   493 :           bparts[k].x[1] != bparts[k].gpart->x[1] ||
  443 :   355 :   494 :           bparts[k].x[2] != bparts[k].gpart->x[2])
  444 :   356 :   498 :       if (bparts[k].mass != bparts[k].gpart->mass)
  445 :   357 :   502 :       if (bparts[k].time_bin != bparts[k].gpart->time_bin)
  446 :   358 :   514 :       if (sinks[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  447 :   359 :   519 :       if (sinks[k].x[0] != sinks[k].gpart->x[0] ||
  448 :   360 :   520 :           sinks[k].x[1] != sinks[k].gpart->x[1] ||
  449 :   361 :   521 :           sinks[k].x[2] != sinks[k].gpart->x[2])
  450 :   362 :   525 :       if (sinks[k].mass != sinks[k].gpart->mass)
  451 :   363 :   529 :       if (sinks[k].time_bin != sinks[k].gpart->time_bin)
  452 :   365 :   108 :         p->gpart->mass = hydro_get_mass(p);
  453 :   366 :   339 :         cell_bp->gpart->mass = cell_bp->mass;
  454 :   367 :   340 :         cell_bp->gpart->v_full[0] = cell_bp->v[0];
  455 :   368 :   341 :         cell_bp->gpart->v_full[1] = cell_bp->v[1];
  456 :   369 :   342 :         cell_bp->gpart->v_full[2] = cell_bp->v[2];
  457 :   371 :   187 :           xp->a_grav[0] = p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  458 :   372 :   188 :           xp->a_grav[1] = p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  459 :   373 :   189 :           xp->a_grav[2] = p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  460 :   374 :   747 :         if (p->gpart != NULL) p->gpart->time_bin = p->time_bin;
  461 :   375 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
  462 :   376 :  1008 :         sink->gpart->time_bin = get_time_bin(ti_new_step);
  463 :   377 :  1078 :         bp->gpart->time_bin = get_time_bin(ti_new_step);
  464 :   378 :  1445 :           p->gpart->time_bin = p->time_bin;
  465 :   379 :  1597 :         if (p->gpart != NULL) p->gpart->time_bin = new_time_bin;
  466 :   380 :  1620 :           p->gpart->time_bin = p->time_bin;
  467 :   382 :   251 :   sp->gpart->mass += gas_mass;
  468 :   383 :   279 :   sp->gpart->v_full[0] = sp->v[0];
  469 :   384 :   280 :   sp->gpart->v_full[1] = sp->v[1];
  470 :   385 :   281 :   sp->gpart->v_full[2] = sp->v[2];
  471 :   386 :   321 :   spi->gpart->mass += spj->mass;
  472 :   387 :   337 :   spi->gpart->v_full[0] = spi->v[0];
  473 :   388 :   338 :   spi->gpart->v_full[1] = spi->v[1];
  474 :   389 :   339 :   spi->gpart->v_full[2] = spi->v[2];
  475 :   391 :    66 :     float potential_i = pi->gpart->potential;
  476 :   392 :    67 :     float potential_j = pj->gpart->potential;
  477 :   394 :  2239 :       if (parts[k].time_bin != parts[k].gpart->time_bin) {
  478 :   395 :  2241 :               parts[k].gpart->time_bin);
  479 :   397 :   150 :     /* Check part->gpart->part linkeage. */
  480 :   398 :   151 :     if (p[k].gpart && p[k].gpart->id_or_neg_offset != -(k + delta))
  481 :   399 :   328 :     if (sp[k].gpart && sp[k].gpart->id_or_neg_offset != -(k + delta))
  482 :   400 :   419 :     if (bp[k].gpart && bp[k].gpart->id_or_neg_offset != -(k + delta))
  483 :   401 :   485 :     if (sink[k].gpart && sink[k].gpart->id_or_neg_offset != -(k + delta))
  484 :   403 :   223 :           s->parts[k].gpart->id_or_neg_offset = -k;
  485 :   404 :   226 :           s->parts[nr_parts].gpart->id_or_neg_offset = -nr_parts;
  486 :   405 :   275 :           s->sparts[k].gpart->id_or_neg_offset = -k;
  487 :   406 :   278 :           s->sparts[nr_sparts].gpart->id_or_neg_offset = -nr_sparts;
  488 :   407 :   325 :           s->bparts[k].gpart->id_or_neg_offset = -k;
  489 :   408 :   328 :           s->bparts[nr_bparts].gpart->id_or_neg_offset = -nr_bparts;
  490 :   409 :   376 :           s->sinks[k].gpart->id_or_neg_offset = -k;
  491 :   410 :   379 :           s->sinks[nr_sinks].gpart->id_or_neg_offset = -nr_sinks;
  492 :   412 :    76 :           parts[j].gpart->id_or_neg_offset = -(j + parts_offset);
  493 :   413 :    82 :         parts[k].gpart->id_or_neg_offset = -(k + parts_offset);
  494 :   414 :   138 :           sparts[j].gpart->id_or_neg_offset = -(j + sparts_offset);
  495 :   415 :   143 :         sparts[k].gpart->id_or_neg_offset = -(k + sparts_offset);
  496 :   416 :   199 :           bparts[j].gpart->id_or_neg_offset = -(j + bparts_offset);
  497 :   417 :   204 :         bparts[k].gpart->id_or_neg_offset = -(k + bparts_offset);
  498 :   418 :   259 :           sinks[j].gpart->id_or_neg_offset = -(j + sinks_offset);
  499 :   419 :   264 :         sinks[k].gpart->id_or_neg_offset = -(k + sinks_offset);
  500 :   421 :   274 :   sp->gpart->x[0] = sp->x[0];
  501 :   422 :   275 :   sp->gpart->x[1] = sp->x[1];
  502 :   423 :   276 :   sp->gpart->x[2] = sp->x[2];
  503 :   424 :   297 :   p->gpart->x[0] = p->x[0];
  504 :   425 :   298 :   p->gpart->x[1] = p->x[1];
  505 :   426 :   299 :   p->gpart->x[2] = p->x[2];
  506 :   427 :   339 :     sp->gpart->mass = mass_star;
  507 :   428 :   343 :     p->gpart->mass = new_mass_gas;
  508 :   430 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  509 :   431 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  510 :   432 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  511 :   434 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  512 :   435 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  513 :   436 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  514 :   438 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  515 :   439 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  516 :   440 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  517 :   441 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  518 :   442 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  519 :   443 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  520 :   444 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  521 :   445 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  522 :   446 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  523 :   447 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  524 :   448 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  525 :   449 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  526 :   450 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  527 :   451 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  528 :   452 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  529 :   453 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  530 :   454 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  531 :   455 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  532 :   457 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  533 :   458 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  534 :   459 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  535 :   460 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  536 :   461 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  537 :   462 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  538 :   463 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  539 :   464 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  540 :   465 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  542 :     2 :   230 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
  543 :     3 :   231 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
  544 :     4 :   232 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
  545 :     5 :   409 :   bp->gpart->mass += gas_mass;
  546 :     6 :   437 :   bp->gpart->v_full[0] = bp->v[0];
  547 :     7 :   438 :   bp->gpart->v_full[1] = bp->v[1];
  548 :     8 :   439 :   bp->gpart->v_full[2] = bp->v[2];
  549 :     9 :   506 :   bpi->gpart->mass += bpj->mass;
  550 :    10 :   522 :   bpi->gpart->v_full[0] = bpi->v[0];
  551 :    11 :   523 :   bpi->gpart->v_full[1] = bpi->v[1];
  552 :    12 :   524 :   bpi->gpart->v_full[2] = bpi->v[2];
  553 :    14 :   229 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
  554 :    15 :   230 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
  555 :    16 :   231 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
  556 :    17 :   410 :   bp->gpart->mass += gas_mass;
  557 :    18 :   438 :   bp->gpart->v_full[0] = bp->v[0];
  558 :    19 :   439 :   bp->gpart->v_full[1] = bp->v[1];
  559 :    20 :   440 :   bp->gpart->v_full[2] = bp->v[2];
  560 :    21 :   503 :   bpi->gpart->mass += bpj->mass;
  561 :    22 :   519 :   bpi->gpart->v_full[0] = bpi->v[0];
  562 :    23 :   520 :   bpi->gpart->v_full[1] = bpi->v[1];
  563 :    24 :   521 :   bpi->gpart->v_full[2] = bpi->v[2];
  564 :    26 :   268 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
  565 :    27 :   269 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
  566 :    28 :   270 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
  567 :    29 :   465 :   bp->gpart->mass += gas_mass;
  568 :    30 :   493 :   bp->gpart->v_full[0] = bp->v[0];
  569 :    31 :   494 :   bp->gpart->v_full[1] = bp->v[1];
  570 :    32 :   495 :   bp->gpart->v_full[2] = bp->v[2];
  571 :    33 :   566 :   bpi->gpart->mass += bpj->mass;
  572 :    34 :   616 :   bpi->gpart->v_full[0] = bpi->v[0];
  573 :    35 :   617 :   bpi->gpart->v_full[1] = bpi->v[1];
  574 :    36 :   618 :   bpi->gpart->v_full[2] = bpi->v[2];
  575 :    38 :   228 :       c->stars.parts[i + 1].gpart->id_or_neg_offset--;
  576 :    39 :   361 :       c->sinks.parts[i + 1].gpart->id_or_neg_offset--;
  577 :    40 :   489 :     /* Update the gpart->spart links (shift by 1) */
  578 :    41 :   574 :     p->gpart->time_bin = time_bin_inhibited;
  579 :    42 :   575 :     p->gpart->id_or_neg_offset = p->id;
  580 :    43 :   576 :     p->gpart->type = swift_type_dark_matter;
  581 :    44 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  582 :    45 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  583 :    46 :   649 :     sp->gpart->type = swift_type_dark_matter;
  584 :    47 :   686 :     bp->gpart->time_bin = time_bin_inhibited;
  585 :    48 :   687 :     bp->gpart->id_or_neg_offset = bp->id;
  586 :    49 :   688 :     bp->gpart->type = swift_type_dark_matter;
  587 :    50 :   724 :     sink->gpart->time_bin = time_bin_inhibited;
  588 :    51 :   725 :     sink->gpart->id_or_neg_offset = sink->id;
  589 :    52 :   726 :     sink->gpart->type = swift_type_dark_matter;
  590 :    54 :   141 :             parts[j].gpart->id_or_neg_offset = -(j + parts_offset);
  591 :    55 :   148 :           parts[k].gpart->id_or_neg_offset = -(k + parts_offset);
  592 :    56 :   260 :             sparts[j].gpart->id_or_neg_offset = -(j + sparts_offset);
  593 :    57 :   266 :           sparts[k].gpart->id_or_neg_offset = -(k + sparts_offset);
  594 :    58 :   315 :             bparts[j].gpart->id_or_neg_offset = -(j + bparts_offset);
  595 :    59 :   321 :           bparts[k].gpart->id_or_neg_offset = -(k + bparts_offset);
  596 :    60 :   370 :             sinks[j].gpart->id_or_neg_offset = -(j + sinks_offset);
  597 :    61 :   376 :           sinks[k].gpart->id_or_neg_offset = -(k + sinks_offset);
  598 :    62 :   501 :         parts[i].gpart->id_or_neg_offset = -(i + parts_offset);
  599 :    63 :   552 :         sparts[i].gpart->id_or_neg_offset = -(i + sparts_offset);
  600 :    64 :   608 :         sinks[i].gpart->id_or_neg_offset = -(i + sinks_offset);
  601 :    66 :  1434 :  * @param vr_data The array of gpart-related VELOCIraptor output.
  602 :    67 :  1437 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
  603 :    68 :  1493 :  * @param vr_data The array of gpart-related VELOCIraptor output.
  604 :    69 :  1496 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
  605 :    70 :  1552 :  * @param vr_data The array of gpart-related VELOCIraptor output.
  606 :    71 :  1555 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
  607 :    73 :   363 :             if (parts[k + offset].gpart->id_or_neg_offset > 0)                 \
  608 :    74 :   365 :           parts[k + offset].gpart->id_or_neg_offset = -count;                  \
  609 :    75 :   560 :         parts[k].gpart->id_or_neg_offset = -k;
  610 :    76 :   563 :         parts[nr_parts].gpart->id_or_neg_offset = -nr_parts;
  611 :    77 :   581 :         s->sparts[k].gpart->id_or_neg_offset = -k;
  612 :    78 :   584 :         s->sparts[nr_sparts].gpart->id_or_neg_offset = -nr_sparts;
  613 :    79 :   602 :         s->bparts[k].gpart->id_or_neg_offset = -k;
  614 :    80 :   605 :         s->bparts[nr_bparts].gpart->id_or_neg_offset = -nr_bparts;
  615 :    82 :   107 :       s->parts[offset_parts + k].gpart->id_or_neg_offset =
  616 :    83 :   152 :       s->sparts[offset_sparts + k].gpart->id_or_neg_offset =
  617 :    84 :   195 :       s->bparts[offset_bparts + k].gpart->id_or_neg_offset =
  618 :    85 :   318 :         s->parts[k].gpart->id_or_neg_offset = -k;
  619 :    86 :   336 :         s->sparts[k].gpart->id_or_neg_offset = -k;
  620 :    87 :   354 :         s->bparts[k].gpart->id_or_neg_offset = -k;
  621 :    89 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  622 :    90 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  623 :    91 :   355 :       sp->gpart->fof_data.group_mass;
  624 :    93 :   198 :     pj->gpart->a_grav[1] * pj->gpart->v_full[2] -
  625 :    94 :   199 :         pj->gpart->a_grav[2] * pj->gpart->v_full[1],
  626 :    95 :   200 :     pj->gpart->a_grav[2] * pj->gpart->v_full[0] -
  627 :    96 :   201 :         pj->gpart->a_grav[0] * pj->gpart->v_full[2],
  628 :    97 :   202 :     pj->gpart->a_grav[0] * pj->gpart->v_full[1] -
  629 :    98 :   203 :         pj->gpart->a_grav[1] * pj->gpart->v_full[0]
  630 :    99 :   232 :       pj->gpart->fof_data.group_stellar_mass;
  631 :   100 :   658 :       pow(pi->gpart->fof_data.group_stellar_mass / 102.329, 0.26178) *
  632 :   101 :   662 :   if (pi->gpart->fof_data.group_stellar_mass==0.f) warning("Wind particle is not linked to any galaxy");
  633 :   102 :   678 :       phys_const->const_newton_G*pi->gpart->fof_data.group_mass *
  634 :   104 :    63 :   double galaxy_stellar_mass = p->gpart->fof_data.group_stellar_mass;
  635 :   105 :   145 :       p->gpart->fof_data.group_stellar_mass;
  636 :   106 :   151 :       p->gpart->fof_data.group_mass * fb_props->mass_to_solar_mass;
  637 :   107 :   235 :     p->gpart->a_grav[1] * p->gpart->v_full[2] - 
  638 :   108 :   236 :         p->gpart->a_grav[2] * p->gpart->v_full[1],
  639 :   109 :   237 :     p->gpart->a_grav[2] * p->gpart->v_full[0] - 
  640 :   110 :   238 :         p->gpart->a_grav[0] * p->gpart->v_full[2],
  641 :   111 :   239 :     p->gpart->a_grav[0] * p->gpart->v_full[1] - 
  642 :   112 :   240 :         p->gpart->a_grav[1] * p->gpart->v_full[0]
  643 :   113 :   272 :   p->gpart->fof_data.is_grouppable = 0;
  644 :   115 :  2435 :       bp->gpart->fof_data.is_grouppable = 1;
  645 :   116 :  3603 :     p->gpart->fof_data.is_grouppable = 0;
  646 :   117 :  3619 :     p->gpart->fof_data.is_grouppable = 1;
  647 :   118 :  3621 :     p->gpart->fof_data.is_grouppable = 0;
  648 :   119 :  3625 :   p->gpart->fof_data.part_sfr = max(p->sf_data.SFR, 0.f);
  649 :   120 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  650 :   121 :  3636 :   return gpart->fof_data.is_grouppable;
  651 :   123 :     2 :   230 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
  652 :   124 :     3 :   231 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
  653 :   125 :     4 :   232 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
  654 :   126 :     5 :   409 :   bp->gpart->mass += gas_mass;
  655 :   127 :     6 :   437 :   bp->gpart->v_full[0] = bp->v[0];
  656 :   128 :     7 :   438 :   bp->gpart->v_full[1] = bp->v[1];
  657 :   129 :     8 :   439 :   bp->gpart->v_full[2] = bp->v[2];
  658 :   130 :     9 :   506 :   bpi->gpart->mass += bpj->mass;
  659 :   131 :    10 :   522 :   bpi->gpart->v_full[0] = bpi->v[0];
  660 :   132 :    11 :   523 :   bpi->gpart->v_full[1] = bpi->v[1];
  661 :   133 :    12 :   524 :   bpi->gpart->v_full[2] = bpi->v[2];
  662 :   134 :    14 :   229 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
  663 :   135 :    15 :   230 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
  664 :   136 :    16 :   231 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
  665 :   137 :    17 :   410 :   bp->gpart->mass += gas_mass;
  666 :   138 :    18 :   438 :   bp->gpart->v_full[0] = bp->v[0];
  667 :   139 :    19 :   439 :   bp->gpart->v_full[1] = bp->v[1];
  668 :   140 :    20 :   440 :   bp->gpart->v_full[2] = bp->v[2];
  669 :   141 :    21 :   503 :   bpi->gpart->mass += bpj->mass;
  670 :   142 :    22 :   519 :   bpi->gpart->v_full[0] = bpi->v[0];
  671 :   143 :    23 :   520 :   bpi->gpart->v_full[1] = bpi->v[1];
  672 :   144 :    24 :   521 :   bpi->gpart->v_full[2] = bpi->v[2];
  673 :   145 :    26 :   268 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
  674 :   146 :    27 :   269 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
  675 :   147 :    28 :   270 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
  676 :   148 :    29 :   465 :   bp->gpart->mass += gas_mass;
  677 :   149 :    30 :   493 :   bp->gpart->v_full[0] = bp->v[0];
  678 :   150 :    31 :   494 :   bp->gpart->v_full[1] = bp->v[1];
  679 :   151 :    32 :   495 :   bp->gpart->v_full[2] = bp->v[2];
  680 :   152 :    33 :   566 :   bpi->gpart->mass += bpj->mass;
  681 :   153 :    34 :   616 :   bpi->gpart->v_full[0] = bpi->v[0];
  682 :   154 :    35 :   617 :   bpi->gpart->v_full[1] = bpi->v[1];
  683 :   155 :    36 :   618 :   bpi->gpart->v_full[2] = bpi->v[2];
  684 :   156 :    38 :   228 :       c->stars.parts[i + 1].gpart->id_or_neg_offset--;
  685 :   157 :    39 :   361 :       c->sinks.parts[i + 1].gpart->id_or_neg_offset--;
  686 :   158 :    40 :   489 :     /* Update the gpart->spart links (shift by 1) */
  687 :   159 :    41 :   574 :     p->gpart->time_bin = time_bin_inhibited;
  688 :   160 :    42 :   575 :     p->gpart->id_or_neg_offset = p->id;
  689 :   161 :    43 :   576 :     p->gpart->type = swift_type_dark_matter;
  690 :   162 :    44 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  691 :   163 :    45 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  692 :   164 :    46 :   649 :     sp->gpart->type = swift_type_dark_matter;
  693 :   165 :    47 :   686 :     bp->gpart->time_bin = time_bin_inhibited;
  694 :   166 :    48 :   687 :     bp->gpart->id_or_neg_offset = bp->id;
  695 :   167 :    49 :   688 :     bp->gpart->type = swift_type_dark_matter;
  696 :   168 :    50 :   724 :     sink->gpart->time_bin = time_bin_inhibited;
  697 :   169 :    51 :   725 :     sink->gpart->id_or_neg_offset = sink->id;
  698 :   170 :    52 :   726 :     sink->gpart->type = swift_type_dark_matter;
  699 :   171 :    54 :   141 :             parts[j].gpart->id_or_neg_offset = -(j + parts_offset);
  700 :   172 :    55 :   148 :           parts[k].gpart->id_or_neg_offset = -(k + parts_offset);
  701 :   173 :    56 :   260 :             sparts[j].gpart->id_or_neg_offset = -(j + sparts_offset);
  702 :   174 :    57 :   266 :           sparts[k].gpart->id_or_neg_offset = -(k + sparts_offset);
  703 :   175 :    58 :   315 :             bparts[j].gpart->id_or_neg_offset = -(j + bparts_offset);
  704 :   176 :    59 :   321 :           bparts[k].gpart->id_or_neg_offset = -(k + bparts_offset);
  705 :   177 :    60 :   370 :             sinks[j].gpart->id_or_neg_offset = -(j + sinks_offset);
  706 :   178 :    61 :   376 :           sinks[k].gpart->id_or_neg_offset = -(k + sinks_offset);
  707 :   179 :    62 :   501 :         parts[i].gpart->id_or_neg_offset = -(i + parts_offset);
  708 :   180 :    63 :   552 :         sparts[i].gpart->id_or_neg_offset = -(i + sparts_offset);
  709 :   181 :    64 :   608 :         sinks[i].gpart->id_or_neg_offset = -(i + sinks_offset);
  710 :   182 :    66 :  1434 :  * @param vr_data The array of gpart-related VELOCIraptor output.
  711 :   183 :    67 :  1437 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
  712 :   184 :    68 :  1493 :  * @param vr_data The array of gpart-related VELOCIraptor output.
  713 :   185 :    69 :  1496 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
  714 :   186 :    70 :  1552 :  * @param vr_data The array of gpart-related VELOCIraptor output.
  715 :   187 :    71 :  1555 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
  716 :   188 :    73 :   363 :             if (parts[k + offset].gpart->id_or_neg_offset > 0)                 \
  717 :   189 :    74 :   365 :           parts[k + offset].gpart->id_or_neg_offset = -count;                  \
  718 :   190 :    75 :   560 :         parts[k].gpart->id_or_neg_offset = -k;
  719 :   191 :    76 :   563 :         parts[nr_parts].gpart->id_or_neg_offset = -nr_parts;
  720 :   192 :    77 :   581 :         s->sparts[k].gpart->id_or_neg_offset = -k;
  721 :   193 :    78 :   584 :         s->sparts[nr_sparts].gpart->id_or_neg_offset = -nr_sparts;
  722 :   194 :    79 :   602 :         s->bparts[k].gpart->id_or_neg_offset = -k;
  723 :   195 :    80 :   605 :         s->bparts[nr_bparts].gpart->id_or_neg_offset = -nr_bparts;
  724 :   196 :    82 :   107 :       s->parts[offset_parts + k].gpart->id_or_neg_offset =
  725 :   197 :    83 :   152 :       s->sparts[offset_sparts + k].gpart->id_or_neg_offset =
  726 :   198 :    84 :   195 :       s->bparts[offset_bparts + k].gpart->id_or_neg_offset =
  727 :   199 :    85 :   318 :         s->parts[k].gpart->id_or_neg_offset = -k;
  728 :   200 :    86 :   336 :         s->sparts[k].gpart->id_or_neg_offset = -k;
  729 :   201 :    87 :   354 :         s->bparts[k].gpart->id_or_neg_offset = -k;
  730 :   202 :    89 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  731 :   203 :    90 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  732 :   204 :    91 :   355 :       sp->gpart->fof_data.group_mass;
  733 :   205 :    93 :   198 :     pj->gpart->a_grav[1] * pj->gpart->v_full[2] -
  734 :   206 :    94 :   199 :         pj->gpart->a_grav[2] * pj->gpart->v_full[1],
  735 :   207 :    95 :   200 :     pj->gpart->a_grav[2] * pj->gpart->v_full[0] -
  736 :   208 :    96 :   201 :         pj->gpart->a_grav[0] * pj->gpart->v_full[2],
  737 :   209 :    97 :   202 :     pj->gpart->a_grav[0] * pj->gpart->v_full[1] -
  738 :   210 :    98 :   203 :         pj->gpart->a_grav[1] * pj->gpart->v_full[0]
  739 :   211 :    99 :   232 :       pj->gpart->fof_data.group_stellar_mass;
  740 :   212 :   100 :   658 :       pow(pi->gpart->fof_data.group_stellar_mass / 102.329, 0.26178) *
  741 :   213 :   101 :   662 :   if (pi->gpart->fof_data.group_stellar_mass==0.f) warning("Wind particle is not linked to any galaxy");
  742 :   214 :   102 :   678 :       phys_const->const_newton_G*pi->gpart->fof_data.group_mass *
  743 :   215 :   104 :    63 :   double galaxy_stellar_mass = p->gpart->fof_data.group_stellar_mass;
  744 :   216 :   105 :   145 :       p->gpart->fof_data.group_stellar_mass;
  745 :   217 :   106 :   151 :       p->gpart->fof_data.group_mass * fb_props->mass_to_solar_mass;
  746 :   218 :   107 :   235 :     p->gpart->a_grav[1] * p->gpart->v_full[2] - 
  747 :   219 :   108 :   236 :         p->gpart->a_grav[2] * p->gpart->v_full[1],
  748 :   220 :   109 :   237 :     p->gpart->a_grav[2] * p->gpart->v_full[0] - 
  749 :   221 :   110 :   238 :         p->gpart->a_grav[0] * p->gpart->v_full[2],
  750 :   222 :   111 :   239 :     p->gpart->a_grav[0] * p->gpart->v_full[1] - 
  751 :   223 :   112 :   240 :         p->gpart->a_grav[1] * p->gpart->v_full[0]
  752 :   224 :   113 :   272 :   p->gpart->fof_data.is_grouppable = 0;
  753 :   225 :   115 :  2435 :       bp->gpart->fof_data.is_grouppable = 1;
  754 :   226 :   116 :  3603 :     p->gpart->fof_data.is_grouppable = 0;
  755 :   227 :   117 :  3619 :     p->gpart->fof_data.is_grouppable = 1;
  756 :   228 :   118 :  3621 :     p->gpart->fof_data.is_grouppable = 0;
  757 :   229 :   119 :  3625 :   p->gpart->fof_data.part_sfr = max(p->sf_data.SFR, 0.f);
  758 :   230 :   120 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  759 :   231 :   121 :  3636 :   return gpart->fof_data.is_grouppable;
  760 :   232 :   123 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  761 :   233 :   124 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  762 :   234 :   125 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
  763 :   235 :   126 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  764 :   236 :   127 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  765 :   237 :   128 :   536 :   355 :       sp->gpart->fof_data.group_mass;
  766 :   238 :   129 :   670 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  767 :   239 :   130 :   707 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  768 :   240 :   131 :   708 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  769 :   241 :   132 :   709 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
  770 :   242 :   133 :  1183 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  771 :   243 :   134 :  1184 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  772 :   244 :   135 :  1185 :   536 :   355 :       sp->gpart->fof_data.group_mass;
  773 :   245 :   136 :  1261 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
  774 :   246 :   137 :  1269 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
  775 :   247 :   138 :  1270 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
  776 :   248 :   139 :  1271 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
  777 :   249 :   140 :  1272 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  778 :   250 :   141 :  1273 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  779 :   251 :   142 :  1274 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  780 :   252 :   143 :  1275 :   331 :   sp->gpart->v_full[0] = sp->v[0];
  781 :   253 :   144 :  1276 :   332 :   sp->gpart->v_full[1] = sp->v[1];
  782 :   254 :   145 :  1277 :   333 :   sp->gpart->v_full[2] = sp->v[2];
  783 :   255 :   146 :  1447 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
  784 :   256 :   147 :  1490 :   251 :   sp->gpart->mass += gas_mass;
  785 :   257 :   148 :  1506 :   279 :   sp->gpart->v_full[0] = sp->v[0];
  786 :   258 :   149 :  1507 :   280 :   sp->gpart->v_full[1] = sp->v[1];
  787 :   259 :   150 :  1508 :   281 :   sp->gpart->v_full[2] = sp->v[2];
  788 :   260 :   151 :  1586 :   274 :   sp->gpart->x[0] = sp->x[0];
  789 :   261 :   152 :  1587 :   275 :   sp->gpart->x[1] = sp->x[1];
  790 :   262 :   153 :  1588 :   276 :   sp->gpart->x[2] = sp->x[2];
  791 :   263 :   154 :  1591 :   339 :     sp->gpart->mass = mass_star;
  792 :   264 :   155 :  1664 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  793 :   265 :   156 :  1665 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  794 :   266 :   157 :  1666 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  795 :   267 :   158 :  1818 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  796 :   268 :   159 :  1819 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  797 :   269 :   160 :  1820 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  798 :   270 :   161 :  1972 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  799 :   271 :   162 :  1973 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  800 :   272 :   163 :  1974 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  801 :   273 :   164 :  2121 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  802 :   274 :   165 :  2122 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  803 :   275 :   166 :  2123 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  804 :   276 :   167 :  2270 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  805 :   277 :   168 :  2271 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  806 :   278 :   169 :  2272 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  807 :   279 :   170 :  2420 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  808 :   280 :   171 :  2421 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  809 :   281 :   172 :  2422 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  810 :   282 :   173 :  2569 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  811 :   283 :   174 :  2570 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  812 :   284 :   175 :  2571 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  813 :   285 :   176 :  2718 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  814 :   286 :   177 :  2719 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  815 :   287 :   178 :  2720 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  816 :   288 :   179 :  2869 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  817 :   289 :   180 :  2870 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  818 :   290 :   181 :  2871 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  819 :   291 :   182 :  3018 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  820 :   292 :   183 :  3019 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  821 :   293 :   184 :  3020 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  822 :   294 :   185 :  3167 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  823 :   295 :   186 :  3168 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  824 :   296 :   187 :  3169 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  825 :   297 :   189 :    31 :   ret[0] = p->gpart->fof_data.group_id;
  826 :   298 :   190 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
  827 :   299 :   191 :    43 :   ret[0] = bp->gpart->fof_data.group_id;
  828 :   300 :   193 :   136 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  829 :   301 :   194 :   137 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  830 :   302 :   195 :   138 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  831 :   303 :   196 :   143 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  832 :   304 :   197 :   144 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  833 :   305 :   198 :   145 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  834 :   306 :   200 :    54 :     acc[0] += p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  835 :   307 :   201 :    55 :     acc[1] += p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  836 :   308 :   202 :    56 :     acc[2] += p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  837 :   309 :   204 :   127 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  838 :   310 :   205 :   128 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  839 :   311 :   206 :   129 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  840 :   312 :   207 :   134 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  841 :   313 :   208 :   135 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  842 :   314 :   209 :   136 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  843 :   315 :   211 :   138 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  844 :   316 :   212 :   139 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  845 :   317 :   213 :   140 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  846 :   318 :   214 :   145 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  847 :   319 :   215 :   146 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  848 :   320 :   216 :   147 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  849 :   321 :   218 :    98 :     p->gpart->v_full[0] = p->v_full[0];
  850 :   322 :   219 :    99 :     p->gpart->v_full[1] = p->v_full[1];
  851 :   323 :   220 :   100 :     p->gpart->v_full[2] = p->v_full[2];
  852 :   324 :   222 :   254 :     p->gpart->mass = p->conserved.mass;
  853 :   325 :   224 :   149 :     p->gpart->v_full[0] = p->v[0];
  854 :   326 :   225 :   150 :     p->gpart->v_full[1] = p->v[1];
  855 :   327 :   226 :   151 :     p->gpart->v_full[2] = p->v[2];
  856 :   328 :   228 :   696 :     a_grav[0] = p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  857 :   329 :   229 :   697 :     a_grav[1] = p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  858 :   330 :   230 :   698 :     a_grav[2] = p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  859 :   331 :   231 :   700 :     grav_kick_factor[0] = dt_grav * p->gpart->a_grav[0];
  860 :   332 :   232 :   701 :     grav_kick_factor[1] = dt_grav * p->gpart->a_grav[1];
  861 :   333 :   233 :   702 :     grav_kick_factor[2] = dt_grav * p->gpart->a_grav[2];
  862 :   334 :   234 :   704 :       grav_kick_factor[0] += dt_grav_mesh * p->gpart->a_grav_mesh[0];
  863 :   335 :   235 :   705 :       grav_kick_factor[1] += dt_grav_mesh * p->gpart->a_grav_mesh[1];
  864 :   336 :   236 :   706 :       grav_kick_factor[2] += dt_grav_mesh * p->gpart->a_grav_mesh[2];
  865 :   337 :   238 :   310 :     v[0] += p->gpart->a_grav[0] * dt_kick_grav;
  866 :   338 :   239 :   311 :     v[1] += p->gpart->a_grav[1] * dt_kick_grav;
  867 :   339 :   240 :   312 :     v[2] += p->gpart->a_grav[2] * dt_kick_grav;
  868 :   340 :   242 :   141 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  869 :   341 :   243 :   142 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  870 :   342 :   244 :   143 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  871 :   343 :   245 :   148 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  872 :   344 :   246 :   149 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  873 :   345 :   247 :   150 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  874 :   346 :   249 :   137 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  875 :   347 :   250 :   138 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  876 :   348 :   251 :   139 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  877 :   349 :   252 :   144 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  878 :   350 :   253 :   145 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  879 :   351 :   254 :   146 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  880 :   352 :   256 :   152 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  881 :   353 :   257 :   153 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  882 :   354 :   258 :   154 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  883 :   355 :   259 :   159 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  884 :   356 :   260 :   160 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  885 :   357 :   261 :   161 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  886 :   358 :   263 :   138 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  887 :   359 :   264 :   139 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  888 :   360 :   265 :   140 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  889 :   361 :   266 :   145 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  890 :   362 :   267 :   146 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  891 :   363 :   268 :   147 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  892 :   364 :   270 :   139 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  893 :   365 :   271 :   140 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  894 :   366 :   272 :   141 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  895 :   367 :   273 :   146 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  896 :   368 :   274 :   147 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  897 :   369 :   275 :   148 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  898 :   370 :   277 :   139 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  899 :   371 :   278 :   140 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  900 :   372 :   279 :   141 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  901 :   373 :   280 :   146 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  902 :   374 :   281 :   147 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  903 :   375 :   282 :   148 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  904 :   376 :   284 :    54 :     acc[0] += p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  905 :   377 :   285 :    55 :     acc[1] += p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  906 :   378 :   286 :    56 :     acc[2] += p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  907 :   379 :   288 :   134 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  908 :   380 :   289 :   135 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  909 :   381 :   290 :   136 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  910 :   382 :   291 :   141 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  911 :   383 :   292 :   142 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  912 :   384 :   293 :   143 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  913 :   385 :   295 :   551 :     p->gpart->v_full[0] = p->v[0];
  914 :   386 :   296 :   552 :     p->gpart->v_full[1] = p->v[1];
  915 :   387 :   297 :   553 :     p->gpart->v_full[2] = p->v[2];
  916 :   388 :   299 :   250 :     p->v_full[0] += p->gpart->a_grav[0] * dt_kick_grav;
  917 :   389 :   300 :   251 :     p->v_full[1] += p->gpart->a_grav[1] * dt_kick_grav;
  918 :   390 :   301 :   252 :     p->v_full[2] += p->gpart->a_grav[2] * dt_kick_grav;
  919 :   391 :   302 :   257 :     p->v_full[0] += p->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  920 :   392 :   303 :   258 :     p->v_full[1] += p->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  921 :   393 :   304 :   259 :     p->v_full[2] += p->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  922 :   394 :   305 :   264 :     p->gpart->v_full[0] = p->v_full[0];
  923 :   395 :   306 :   265 :     p->gpart->v_full[1] = p->v_full[1];
  924 :   396 :   307 :   266 :     p->gpart->v_full[2] = p->v_full[2];
  925 :   397 :   308 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
  926 :   398 :   309 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
  927 :   399 :   310 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
  928 :   400 :   311 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  929 :   401 :   312 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  930 :   402 :   313 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  931 :   403 :   314 :   331 :   sp->gpart->v_full[0] = sp->v[0];
  932 :   404 :   315 :   332 :   sp->gpart->v_full[1] = sp->v[1];
  933 :   405 :   316 :   333 :   sp->gpart->v_full[2] = sp->v[2];
  934 :   406 :   317 :   378 :   bp->v[0] += bp->gpart->a_grav[0] * dt_kick_grav;
  935 :   407 :   318 :   379 :   bp->v[1] += bp->gpart->a_grav[1] * dt_kick_grav;
  936 :   408 :   319 :   380 :   bp->v[2] += bp->gpart->a_grav[2] * dt_kick_grav;
  937 :   409 :   320 :   383 :   bp->v[0] += bp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  938 :   410 :   321 :   384 :   bp->v[1] += bp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  939 :   411 :   322 :   385 :   bp->v[2] += bp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  940 :   412 :   323 :   388 :   bp->gpart->v_full[0] = bp->v[0];
  941 :   413 :   324 :   389 :   bp->gpart->v_full[1] = bp->v[1];
  942 :   414 :   325 :   390 :   bp->gpart->v_full[2] = bp->v[2];
  943 :   415 :   326 :   437 :   sink->v[0] += sink->gpart->a_grav[0] * dt_kick_grav;
  944 :   416 :   327 :   438 :   sink->v[1] += sink->gpart->a_grav[1] * dt_kick_grav;
  945 :   417 :   328 :   439 :   sink->v[2] += sink->gpart->a_grav[2] * dt_kick_grav;
  946 :   418 :   329 :   442 :   sink->v[0] += sink->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  947 :   419 :   330 :   443 :   sink->v[1] += sink->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  948 :   420 :   331 :   444 :   sink->v[2] += sink->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  949 :   421 :   332 :   447 :   sink->gpart->v_full[0] = sink->v[0];
  950 :   422 :   333 :   448 :   sink->gpart->v_full[1] = sink->v[1];
  951 :   423 :   334 :   449 :   sink->gpart->v_full[2] = sink->v[2];
  952 :   424 :   336 :    47 :       parts[k].gpart->id_or_neg_offset = -(k + offset);
  953 :   425 :   337 :    63 :       sparts[k].gpart->id_or_neg_offset = -(k + offset);
  954 :   426 :   338 :    79 :       sinks[k].gpart->id_or_neg_offset = -(k + offset);
  955 :   427 :   339 :    95 :       bparts[k].gpart->id_or_neg_offset = -(k + offset);
  956 :   428 :   340 :   433 :       if (parts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  957 :   429 :   341 :   438 :       if (parts[k].x[0] != parts[k].gpart->x[0] ||
  958 :   430 :   342 :   439 :           parts[k].x[1] != parts[k].gpart->x[1] ||
  959 :   431 :   343 :   440 :           parts[k].x[2] != parts[k].gpart->x[2])
  960 :   432 :   344 :   444 :       if (hydro_get_mass(&parts[k]) != parts[k].gpart->mass)
  961 :   433 :   345 :   448 :       if (parts[k].time_bin != parts[k].gpart->time_bin)
  962 :   434 :   346 :   460 :       if (sparts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  963 :   435 :   347 :   465 :       if (sparts[k].x[0] != sparts[k].gpart->x[0] ||
  964 :   436 :   348 :   466 :           sparts[k].x[1] != sparts[k].gpart->x[1] ||
  965 :   437 :   349 :   467 :           sparts[k].x[2] != sparts[k].gpart->x[2])
  966 :   438 :   350 :   471 :       if (sparts[k].mass != sparts[k].gpart->mass)
  967 :   439 :   351 :   475 :       if (sparts[k].time_bin != sparts[k].gpart->time_bin)
  968 :   440 :   352 :   487 :       if (bparts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  969 :   441 :   353 :   492 :       if (bparts[k].x[0] != bparts[k].gpart->x[0] ||
  970 :   442 :   354 :   493 :           bparts[k].x[1] != bparts[k].gpart->x[1] ||
  971 :   443 :   355 :   494 :           bparts[k].x[2] != bparts[k].gpart->x[2])
  972 :   444 :   356 :   498 :       if (bparts[k].mass != bparts[k].gpart->mass)
  973 :   445 :   357 :   502 :       if (bparts[k].time_bin != bparts[k].gpart->time_bin)
  974 :   446 :   358 :   514 :       if (sinks[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  975 :   447 :   359 :   519 :       if (sinks[k].x[0] != sinks[k].gpart->x[0] ||
  976 :   448 :   360 :   520 :           sinks[k].x[1] != sinks[k].gpart->x[1] ||
  977 :   449 :   361 :   521 :           sinks[k].x[2] != sinks[k].gpart->x[2])
  978 :   450 :   362 :   525 :       if (sinks[k].mass != sinks[k].gpart->mass)
  979 :   451 :   363 :   529 :       if (sinks[k].time_bin != sinks[k].gpart->time_bin)
  980 :   452 :   365 :   108 :         p->gpart->mass = hydro_get_mass(p);
  981 :   453 :   366 :   339 :         cell_bp->gpart->mass = cell_bp->mass;
  982 :   454 :   367 :   340 :         cell_bp->gpart->v_full[0] = cell_bp->v[0];
  983 :   455 :   368 :   341 :         cell_bp->gpart->v_full[1] = cell_bp->v[1];
  984 :   456 :   369 :   342 :         cell_bp->gpart->v_full[2] = cell_bp->v[2];
  985 :   457 :   371 :   187 :           xp->a_grav[0] = p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  986 :   458 :   372 :   188 :           xp->a_grav[1] = p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  987 :   459 :   373 :   189 :           xp->a_grav[2] = p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  988 :   460 :   374 :   747 :         if (p->gpart != NULL) p->gpart->time_bin = p->time_bin;
  989 :   461 :   375 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
  990 :   462 :   376 :  1008 :         sink->gpart->time_bin = get_time_bin(ti_new_step);
  991 :   463 :   377 :  1078 :         bp->gpart->time_bin = get_time_bin(ti_new_step);
  992 :   464 :   378 :  1445 :           p->gpart->time_bin = p->time_bin;
  993 :   465 :   379 :  1597 :         if (p->gpart != NULL) p->gpart->time_bin = new_time_bin;
  994 :   466 :   380 :  1620 :           p->gpart->time_bin = p->time_bin;
  995 :   467 :   382 :   251 :   sp->gpart->mass += gas_mass;
  996 :   468 :   383 :   279 :   sp->gpart->v_full[0] = sp->v[0];
  997 :   469 :   384 :   280 :   sp->gpart->v_full[1] = sp->v[1];
  998 :   470 :   385 :   281 :   sp->gpart->v_full[2] = sp->v[2];
  999 :   471 :   386 :   321 :   spi->gpart->mass += spj->mass;
 1000 :   472 :   387 :   337 :   spi->gpart->v_full[0] = spi->v[0];
 1001 :   473 :   388 :   338 :   spi->gpart->v_full[1] = spi->v[1];
 1002 :   474 :   389 :   339 :   spi->gpart->v_full[2] = spi->v[2];
 1003 :   475 :   391 :    66 :     float potential_i = pi->gpart->potential;
 1004 :   476 :   392 :    67 :     float potential_j = pj->gpart->potential;
 1005 :   477 :   394 :  2239 :       if (parts[k].time_bin != parts[k].gpart->time_bin) {
 1006 :   478 :   395 :  2241 :               parts[k].gpart->time_bin);
 1007 :   479 :   397 :   150 :     /* Check part->gpart->part linkeage. */
 1008 :   480 :   398 :   151 :     if (p[k].gpart && p[k].gpart->id_or_neg_offset != -(k + delta))
 1009 :   481 :   399 :   328 :     if (sp[k].gpart && sp[k].gpart->id_or_neg_offset != -(k + delta))
 1010 :   482 :   400 :   419 :     if (bp[k].gpart && bp[k].gpart->id_or_neg_offset != -(k + delta))
 1011 :   483 :   401 :   485 :     if (sink[k].gpart && sink[k].gpart->id_or_neg_offset != -(k + delta))
 1012 :   484 :   403 :   223 :           s->parts[k].gpart->id_or_neg_offset = -k;
 1013 :   485 :   404 :   226 :           s->parts[nr_parts].gpart->id_or_neg_offset = -nr_parts;
 1014 :   486 :   405 :   275 :           s->sparts[k].gpart->id_or_neg_offset = -k;
 1015 :   487 :   406 :   278 :           s->sparts[nr_sparts].gpart->id_or_neg_offset = -nr_sparts;
 1016 :   488 :   407 :   325 :           s->bparts[k].gpart->id_or_neg_offset = -k;
 1017 :   489 :   408 :   328 :           s->bparts[nr_bparts].gpart->id_or_neg_offset = -nr_bparts;
 1018 :   490 :   409 :   376 :           s->sinks[k].gpart->id_or_neg_offset = -k;
 1019 :   491 :   410 :   379 :           s->sinks[nr_sinks].gpart->id_or_neg_offset = -nr_sinks;
 1020 :   492 :   412 :    76 :           parts[j].gpart->id_or_neg_offset = -(j + parts_offset);
 1021 :   493 :   413 :    82 :         parts[k].gpart->id_or_neg_offset = -(k + parts_offset);
 1022 :   494 :   414 :   138 :           sparts[j].gpart->id_or_neg_offset = -(j + sparts_offset);
 1023 :   495 :   415 :   143 :         sparts[k].gpart->id_or_neg_offset = -(k + sparts_offset);
 1024 :   496 :   416 :   199 :           bparts[j].gpart->id_or_neg_offset = -(j + bparts_offset);
 1025 :   497 :   417 :   204 :         bparts[k].gpart->id_or_neg_offset = -(k + bparts_offset);
 1026 :   498 :   418 :   259 :           sinks[j].gpart->id_or_neg_offset = -(j + sinks_offset);
 1027 :   499 :   419 :   264 :         sinks[k].gpart->id_or_neg_offset = -(k + sinks_offset);
 1028 :   500 :   421 :   274 :   sp->gpart->x[0] = sp->x[0];
 1029 :   501 :   422 :   275 :   sp->gpart->x[1] = sp->x[1];
 1030 :   502 :   423 :   276 :   sp->gpart->x[2] = sp->x[2];
 1031 :   503 :   424 :   297 :   p->gpart->x[0] = p->x[0];
 1032 :   504 :   425 :   298 :   p->gpart->x[1] = p->x[1];
 1033 :   505 :   426 :   299 :   p->gpart->x[2] = p->x[2];
 1034 :   506 :   427 :   339 :     sp->gpart->mass = mass_star;
 1035 :   507 :   428 :   343 :     p->gpart->mass = new_mass_gas;
 1036 :   508 :   430 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1037 :   509 :   431 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1038 :   510 :   432 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1039 :   511 :   434 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1040 :   512 :   435 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1041 :   513 :   436 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1042 :   514 :   438 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1043 :   515 :   439 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1044 :   516 :   440 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1045 :   517 :   441 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1046 :   518 :   442 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1047 :   519 :   443 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1048 :   520 :   444 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1049 :   521 :   445 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1050 :   522 :   446 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1051 :   523 :   447 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1052 :   524 :   448 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1053 :   525 :   449 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1054 :   526 :   450 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1055 :   527 :   451 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1056 :   528 :   452 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1057 :   529 :   453 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1058 :   530 :   454 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1059 :   531 :   455 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1060 :   532 :   457 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1061 :   533 :   458 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1062 :   534 :   459 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1063 :   535 :   460 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1064 :   536 :   461 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1065 :   537 :   462 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1066 :   538 :   463 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1067 :   539 :   464 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1068 :   540 :   465 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1070 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
 1071 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
 1072 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
 1073 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
 1074 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
 1075 :   536 :   355 :       sp->gpart->fof_data.group_mass;
 1076 :   670 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
 1077 :   707 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
 1078 :   708 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
 1079 :   709 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
 1080 :  1183 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
 1081 :  1184 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
 1082 :  1185 :   536 :   355 :       sp->gpart->fof_data.group_mass;
 1083 :  1261 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
 1084 :  1269 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
 1085 :  1270 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
 1086 :  1271 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
 1087 :  1272 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
 1088 :  1273 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
 1089 :  1274 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
 1090 :  1275 :   331 :   sp->gpart->v_full[0] = sp->v[0];
 1091 :  1276 :   332 :   sp->gpart->v_full[1] = sp->v[1];
 1092 :  1277 :   333 :   sp->gpart->v_full[2] = sp->v[2];
 1093 :  1447 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
 1094 :  1490 :   251 :   sp->gpart->mass += gas_mass;
 1095 :  1506 :   279 :   sp->gpart->v_full[0] = sp->v[0];
 1096 :  1507 :   280 :   sp->gpart->v_full[1] = sp->v[1];
 1097 :  1508 :   281 :   sp->gpart->v_full[2] = sp->v[2];
 1098 :  1586 :   274 :   sp->gpart->x[0] = sp->x[0];
 1099 :  1587 :   275 :   sp->gpart->x[1] = sp->x[1];
 1100 :  1588 :   276 :   sp->gpart->x[2] = sp->x[2];
 1101 :  1591 :   339 :     sp->gpart->mass = mass_star;
 1102 :  1664 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1103 :  1665 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1104 :  1666 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1105 :  1818 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1106 :  1819 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1107 :  1820 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1108 :  1972 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1109 :  1973 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1110 :  1974 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1111 :  2121 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1112 :  2122 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1113 :  2123 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1114 :  2270 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1115 :  2271 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1116 :  2272 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1117 :  2420 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1118 :  2421 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1119 :  2422 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1120 :  2569 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1121 :  2570 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1122 :  2571 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1123 :  2718 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1124 :  2719 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1125 :  2720 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1126 :  2869 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1127 :  2870 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1128 :  2871 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1129 :  3018 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1130 :  3019 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1131 :  3020 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1132 :  3167 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1133 :  3168 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1134 :  3169 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1136 :    31 :   ret[0] = p->gpart->fof_data.group_id;
 1137 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
 1138 :    43 :   ret[0] = bp->gpart->fof_data.group_id;
 1140 :   136 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
 1141 :   137 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
 1142 :   138 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
 1143 :   143 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
 1144 :   144 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
 1145 :   145 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
 1147 :    54 :     acc[0] += p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
 1148 :    55 :     acc[1] += p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
 1149 :    56 :     acc[2] += p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
 1151 :   127 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
 1152 :   128 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
 1153 :   129 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
 1154 :   134 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
 1155 :   135 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
 1156 :   136 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
 1158 :   138 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
 1159 :   139 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
 1160 :   140 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
 1161 :   145 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
 1162 :   146 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
 1163 :   147 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
 1165 :    98 :     p->gpart->v_full[0] = p->v_full[0];
 1166 :    99 :     p->gpart->v_full[1] = p->v_full[1];
 1167 :   100 :     p->gpart->v_full[2] = p->v_full[2];
 1169 :   254 :     p->gpart->mass = p->conserved.mass;
 1171 :   149 :     p->gpart->v_full[0] = p->v[0];
 1172 :   150 :     p->gpart->v_full[1] = p->v[1];
 1173 :   151 :     p->gpart->v_full[2] = p->v[2];
 1175 :   696 :     a_grav[0] = p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
 1176 :   697 :     a_grav[1] = p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
 1177 :   698 :     a_grav[2] = p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
 1178 :   700 :     grav_kick_factor[0] = dt_grav * p->gpart->a_grav[0];
 1179 :   701 :     grav_kick_factor[1] = dt_grav * p->gpart->a_grav[1];
 1180 :   702 :     grav_kick_factor[2] = dt_grav * p->gpart->a_grav[2];
 1181 :   704 :       grav_kick_factor[0] += dt_grav_mesh * p->gpart->a_grav_mesh[0];
 1182 :   705 :       grav_kick_factor[1] += dt_grav_mesh * p->gpart->a_grav_mesh[1];
 1183 :   706 :       grav_kick_factor[2] += dt_grav_mesh * p->gpart->a_grav_mesh[2];
 1185 :   310 :     v[0] += p->gpart->a_grav[0] * dt_kick_grav;
 1186 :   311 :     v[1] += p->gpart->a_grav[1] * dt_kick_grav;
 1187 :   312 :     v[2] += p->gpart->a_grav[2] * dt_kick_grav;
 1189 :   141 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
 1190 :   142 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
 1191 :   143 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
 1192 :   148 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
 1193 :   149 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
 1194 :   150 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
 1196 :   137 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
 1197 :   138 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
 1198 :   139 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
 1199 :   144 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
 1200 :   145 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
 1201 :   146 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
 1203 :   152 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
 1204 :   153 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
 1205 :   154 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
 1206 :   159 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
 1207 :   160 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
 1208 :   161 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
 1210 :   138 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
 1211 :   139 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
 1212 :   140 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
 1213 :   145 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
 1214 :   146 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
 1215 :   147 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
 1217 :   139 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
 1218 :   140 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
 1219 :   141 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
 1220 :   146 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
 1221 :   147 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
 1222 :   148 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
 1224 :   139 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
 1225 :   140 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
 1226 :   141 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
 1227 :   146 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
 1228 :   147 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
 1229 :   148 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
 1231 :    54 :     acc[0] += p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
 1232 :    55 :     acc[1] += p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
 1233 :    56 :     acc[2] += p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
 1235 :   134 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
 1236 :   135 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
 1237 :   136 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
 1238 :   141 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
 1239 :   142 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
 1240 :   143 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
 1242 :   551 :     p->gpart->v_full[0] = p->v[0];
 1243 :   552 :     p->gpart->v_full[1] = p->v[1];
 1244 :   553 :     p->gpart->v_full[2] = p->v[2];
 1246 :   250 :     p->v_full[0] += p->gpart->a_grav[0] * dt_kick_grav;
 1247 :   251 :     p->v_full[1] += p->gpart->a_grav[1] * dt_kick_grav;
 1248 :   252 :     p->v_full[2] += p->gpart->a_grav[2] * dt_kick_grav;
 1249 :   257 :     p->v_full[0] += p->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
 1250 :   258 :     p->v_full[1] += p->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
 1251 :   259 :     p->v_full[2] += p->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
 1252 :   264 :     p->gpart->v_full[0] = p->v_full[0];
 1253 :   265 :     p->gpart->v_full[1] = p->v_full[1];
 1254 :   266 :     p->gpart->v_full[2] = p->v_full[2];
 1255 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
 1256 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
 1257 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
 1258 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
 1259 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
 1260 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
 1261 :   331 :   sp->gpart->v_full[0] = sp->v[0];
 1262 :   332 :   sp->gpart->v_full[1] = sp->v[1];
 1263 :   333 :   sp->gpart->v_full[2] = sp->v[2];
 1264 :   378 :   bp->v[0] += bp->gpart->a_grav[0] * dt_kick_grav;
 1265 :   379 :   bp->v[1] += bp->gpart->a_grav[1] * dt_kick_grav;
 1266 :   380 :   bp->v[2] += bp->gpart->a_grav[2] * dt_kick_grav;
 1267 :   383 :   bp->v[0] += bp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
 1268 :   384 :   bp->v[1] += bp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
 1269 :   385 :   bp->v[2] += bp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
 1270 :   388 :   bp->gpart->v_full[0] = bp->v[0];
 1271 :   389 :   bp->gpart->v_full[1] = bp->v[1];
 1272 :   390 :   bp->gpart->v_full[2] = bp->v[2];
 1273 :   437 :   sink->v[0] += sink->gpart->a_grav[0] * dt_kick_grav;
 1274 :   438 :   sink->v[1] += sink->gpart->a_grav[1] * dt_kick_grav;
 1275 :   439 :   sink->v[2] += sink->gpart->a_grav[2] * dt_kick_grav;
 1276 :   442 :   sink->v[0] += sink->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
 1277 :   443 :   sink->v[1] += sink->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
 1278 :   444 :   sink->v[2] += sink->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
 1279 :   447 :   sink->gpart->v_full[0] = sink->v[0];
 1280 :   448 :   sink->gpart->v_full[1] = sink->v[1];
 1281 :   449 :   sink->gpart->v_full[2] = sink->v[2];
 1283 :    47 :       parts[k].gpart->id_or_neg_offset = -(k + offset);
 1284 :    63 :       sparts[k].gpart->id_or_neg_offset = -(k + offset);
 1285 :    79 :       sinks[k].gpart->id_or_neg_offset = -(k + offset);
 1286 :    95 :       bparts[k].gpart->id_or_neg_offset = -(k + offset);
 1287 :   433 :       if (parts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
 1288 :   438 :       if (parts[k].x[0] != parts[k].gpart->x[0] ||
 1289 :   439 :           parts[k].x[1] != parts[k].gpart->x[1] ||
 1290 :   440 :           parts[k].x[2] != parts[k].gpart->x[2])
 1291 :   444 :       if (hydro_get_mass(&parts[k]) != parts[k].gpart->mass)
 1292 :   448 :       if (parts[k].time_bin != parts[k].gpart->time_bin)
 1293 :   460 :       if (sparts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
 1294 :   465 :       if (sparts[k].x[0] != sparts[k].gpart->x[0] ||
 1295 :   466 :           sparts[k].x[1] != sparts[k].gpart->x[1] ||
 1296 :   467 :           sparts[k].x[2] != sparts[k].gpart->x[2])
 1297 :   471 :       if (sparts[k].mass != sparts[k].gpart->mass)
 1298 :   475 :       if (sparts[k].time_bin != sparts[k].gpart->time_bin)
 1299 :   487 :       if (bparts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
 1300 :   492 :       if (bparts[k].x[0] != bparts[k].gpart->x[0] ||
 1301 :   493 :           bparts[k].x[1] != bparts[k].gpart->x[1] ||
 1302 :   494 :           bparts[k].x[2] != bparts[k].gpart->x[2])
 1303 :   498 :       if (bparts[k].mass != bparts[k].gpart->mass)
 1304 :   502 :       if (bparts[k].time_bin != bparts[k].gpart->time_bin)
 1305 :   514 :       if (sinks[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
 1306 :   519 :       if (sinks[k].x[0] != sinks[k].gpart->x[0] ||
 1307 :   520 :           sinks[k].x[1] != sinks[k].gpart->x[1] ||
 1308 :   521 :           sinks[k].x[2] != sinks[k].gpart->x[2])
 1309 :   525 :       if (sinks[k].mass != sinks[k].gpart->mass)
 1310 :   529 :       if (sinks[k].time_bin != sinks[k].gpart->time_bin)
 1312 :   108 :         p->gpart->mass = hydro_get_mass(p);
 1313 :   339 :         cell_bp->gpart->mass = cell_bp->mass;
 1314 :   340 :         cell_bp->gpart->v_full[0] = cell_bp->v[0];
 1315 :   341 :         cell_bp->gpart->v_full[1] = cell_bp->v[1];
 1316 :   342 :         cell_bp->gpart->v_full[2] = cell_bp->v[2];
 1318 :   187 :           xp->a_grav[0] = p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
 1319 :   188 :           xp->a_grav[1] = p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
 1320 :   189 :           xp->a_grav[2] = p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
 1321 :   747 :         if (p->gpart != NULL) p->gpart->time_bin = p->time_bin;
 1322 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
 1323 :  1008 :         sink->gpart->time_bin = get_time_bin(ti_new_step);
 1324 :  1078 :         bp->gpart->time_bin = get_time_bin(ti_new_step);
 1325 :  1445 :           p->gpart->time_bin = p->time_bin;
 1326 :  1597 :         if (p->gpart != NULL) p->gpart->time_bin = new_time_bin;
 1327 :  1620 :           p->gpart->time_bin = p->time_bin;
 1329 :   251 :   sp->gpart->mass += gas_mass;
 1330 :   279 :   sp->gpart->v_full[0] = sp->v[0];
 1331 :   280 :   sp->gpart->v_full[1] = sp->v[1];
 1332 :   281 :   sp->gpart->v_full[2] = sp->v[2];
 1333 :   321 :   spi->gpart->mass += spj->mass;
 1334 :   337 :   spi->gpart->v_full[0] = spi->v[0];
 1335 :   338 :   spi->gpart->v_full[1] = spi->v[1];
 1336 :   339 :   spi->gpart->v_full[2] = spi->v[2];
 1338 :    66 :     float potential_i = pi->gpart->potential;
 1339 :    67 :     float potential_j = pj->gpart->potential;
 1341 :  2239 :       if (parts[k].time_bin != parts[k].gpart->time_bin) {
 1342 :  2241 :               parts[k].gpart->time_bin);
 1344 :   150 :     /* Check part->gpart->part linkeage. */
 1345 :   151 :     if (p[k].gpart && p[k].gpart->id_or_neg_offset != -(k + delta))
 1346 :   328 :     if (sp[k].gpart && sp[k].gpart->id_or_neg_offset != -(k + delta))
 1347 :   419 :     if (bp[k].gpart && bp[k].gpart->id_or_neg_offset != -(k + delta))
 1348 :   485 :     if (sink[k].gpart && sink[k].gpart->id_or_neg_offset != -(k + delta))
 1350 :   223 :           s->parts[k].gpart->id_or_neg_offset = -k;
 1351 :   226 :           s->parts[nr_parts].gpart->id_or_neg_offset = -nr_parts;
 1352 :   275 :           s->sparts[k].gpart->id_or_neg_offset = -k;
 1353 :   278 :           s->sparts[nr_sparts].gpart->id_or_neg_offset = -nr_sparts;
 1354 :   325 :           s->bparts[k].gpart->id_or_neg_offset = -k;
 1355 :   328 :           s->bparts[nr_bparts].gpart->id_or_neg_offset = -nr_bparts;
 1356 :   376 :           s->sinks[k].gpart->id_or_neg_offset = -k;
 1357 :   379 :           s->sinks[nr_sinks].gpart->id_or_neg_offset = -nr_sinks;
 1359 :    76 :           parts[j].gpart->id_or_neg_offset = -(j + parts_offset);
 1360 :    82 :         parts[k].gpart->id_or_neg_offset = -(k + parts_offset);
 1361 :   138 :           sparts[j].gpart->id_or_neg_offset = -(j + sparts_offset);
 1362 :   143 :         sparts[k].gpart->id_or_neg_offset = -(k + sparts_offset);
 1363 :   199 :           bparts[j].gpart->id_or_neg_offset = -(j + bparts_offset);
 1364 :   204 :         bparts[k].gpart->id_or_neg_offset = -(k + bparts_offset);
 1365 :   259 :           sinks[j].gpart->id_or_neg_offset = -(j + sinks_offset);
 1366 :   264 :         sinks[k].gpart->id_or_neg_offset = -(k + sinks_offset);
 1368 :   274 :   sp->gpart->x[0] = sp->x[0];
 1369 :   275 :   sp->gpart->x[1] = sp->x[1];
 1370 :   276 :   sp->gpart->x[2] = sp->x[2];
 1371 :   297 :   p->gpart->x[0] = p->x[0];
 1372 :   298 :   p->gpart->x[1] = p->x[1];
 1373 :   299 :   p->gpart->x[2] = p->x[2];
 1374 :   339 :     sp->gpart->mass = mass_star;
 1375 :   343 :     p->gpart->mass = new_mass_gas;
 1377 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1378 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1379 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1381 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1382 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1383 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1385 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1386 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1387 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1388 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1389 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1390 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1391 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1392 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1393 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1394 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1395 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1396 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1397 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1398 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1399 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1400 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1401 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1402 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1404 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1405 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1406 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1407 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1408 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1409 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1410 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1411 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1412 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
./src/fof_data.group_mass:
   34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
   35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
   36 :   649 :     sp->gpart->type = swift_type_dark_matter;
  534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  536 :   355 :       sp->gpart->fof_data.group_mass;
  670 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  677 :    44 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  678 :    45 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  679 :    46 :   649 :     sp->gpart->type = swift_type_dark_matter;
  680 :    89 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  681 :    90 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  682 :    91 :   355 :       sp->gpart->fof_data.group_mass;
  683 :   120 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  684 :   123 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  685 :   124 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  686 :   125 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
  687 :   126 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  688 :   127 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  689 :   128 :   536 :   355 :       sp->gpart->fof_data.group_mass;
  690 :   129 :   670 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  691 :   130 :   707 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  692 :   131 :   708 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  693 :   132 :   709 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
  694 :   133 :  1183 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  695 :   134 :  1184 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  696 :   135 :  1185 :   536 :   355 :       sp->gpart->fof_data.group_mass;
  697 :   136 :  1261 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
  698 :   137 :  1269 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
  699 :   138 :  1270 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
  700 :   139 :  1271 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
  701 :   140 :  1272 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  702 :   141 :  1273 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  703 :   142 :  1274 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  704 :   143 :  1275 :   331 :   sp->gpart->v_full[0] = sp->v[0];
  705 :   144 :  1276 :   332 :   sp->gpart->v_full[1] = sp->v[1];
  706 :   145 :  1277 :   333 :   sp->gpart->v_full[2] = sp->v[2];
  707 :   146 :  1447 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
  708 :   147 :  1490 :   251 :   sp->gpart->mass += gas_mass;
  709 :   148 :  1506 :   279 :   sp->gpart->v_full[0] = sp->v[0];
  710 :   149 :  1507 :   280 :   sp->gpart->v_full[1] = sp->v[1];
  711 :   150 :  1508 :   281 :   sp->gpart->v_full[2] = sp->v[2];
  712 :   151 :  1586 :   274 :   sp->gpart->x[0] = sp->x[0];
  713 :   152 :  1587 :   275 :   sp->gpart->x[1] = sp->x[1];
  714 :   153 :  1588 :   276 :   sp->gpart->x[2] = sp->x[2];
  715 :   154 :  1591 :   339 :     sp->gpart->mass = mass_star;
  716 :   155 :  1664 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  717 :   156 :  1665 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  718 :   157 :  1666 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  719 :   158 :  1818 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  720 :   159 :  1819 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  721 :   160 :  1820 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  722 :   161 :  1972 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  723 :   162 :  1973 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  724 :   163 :  1974 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  725 :   164 :  2121 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  726 :   165 :  2122 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  727 :   166 :  2123 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  728 :   167 :  2270 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  729 :   168 :  2271 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  730 :   169 :  2272 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  731 :   170 :  2420 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  732 :   171 :  2421 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  733 :   172 :  2422 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  734 :   173 :  2569 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  735 :   174 :  2570 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  736 :   175 :  2571 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  737 :   176 :  2718 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  738 :   177 :  2719 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  739 :   178 :  2720 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  740 :   179 :  2869 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  741 :   180 :  2870 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  742 :   181 :  2871 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  743 :   182 :  3018 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  744 :   183 :  3019 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  745 :   184 :  3020 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  746 :   185 :  3167 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  747 :   186 :  3168 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  748 :   187 :  3169 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  749 :   190 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
  750 :   308 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
  751 :   309 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
  752 :   310 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
  753 :   311 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  754 :   312 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  755 :   313 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  756 :   314 :   331 :   sp->gpart->v_full[0] = sp->v[0];
  757 :   315 :   332 :   sp->gpart->v_full[1] = sp->v[1];
  758 :   316 :   333 :   sp->gpart->v_full[2] = sp->v[2];
  759 :   375 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
  760 :   382 :   251 :   sp->gpart->mass += gas_mass;
  761 :   383 :   279 :   sp->gpart->v_full[0] = sp->v[0];
  762 :   384 :   280 :   sp->gpart->v_full[1] = sp->v[1];
  763 :   385 :   281 :   sp->gpart->v_full[2] = sp->v[2];
  764 :   421 :   274 :   sp->gpart->x[0] = sp->x[0];
  765 :   422 :   275 :   sp->gpart->x[1] = sp->x[1];
  766 :   423 :   276 :   sp->gpart->x[2] = sp->x[2];
  767 :   427 :   339 :     sp->gpart->mass = mass_star;
  768 :   430 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  769 :   431 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  770 :   432 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  771 :   434 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  772 :   435 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  773 :   436 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  774 :   438 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  775 :   439 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  776 :   440 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  777 :   441 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  778 :   442 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  779 :   443 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  780 :   444 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  781 :   445 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  782 :   446 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  783 :   447 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  784 :   448 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  785 :   449 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  786 :   450 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  787 :   451 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  788 :   452 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  789 :   453 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  790 :   454 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  791 :   455 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  792 :   457 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  793 :   458 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  794 :   459 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  795 :   460 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  796 :   461 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  797 :   462 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  798 :   463 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  799 :   464 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  800 :   465 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  802 :    44 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  803 :    45 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  804 :    46 :   649 :     sp->gpart->type = swift_type_dark_matter;
  805 :    89 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  806 :    90 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  807 :    91 :   355 :       sp->gpart->fof_data.group_mass;
  808 :   120 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  809 :   162 :    44 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  810 :   163 :    45 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  811 :   164 :    46 :   649 :     sp->gpart->type = swift_type_dark_matter;
  812 :   202 :    89 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  813 :   203 :    90 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  814 :   204 :    91 :   355 :       sp->gpart->fof_data.group_mass;
  815 :   230 :   120 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  816 :   232 :   123 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  817 :   233 :   124 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  818 :   234 :   125 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
  819 :   235 :   126 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  820 :   236 :   127 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  821 :   237 :   128 :   536 :   355 :       sp->gpart->fof_data.group_mass;
  822 :   238 :   129 :   670 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  823 :   239 :   130 :   707 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  824 :   240 :   131 :   708 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  825 :   241 :   132 :   709 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
  826 :   242 :   133 :  1183 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  827 :   243 :   134 :  1184 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  828 :   244 :   135 :  1185 :   536 :   355 :       sp->gpart->fof_data.group_mass;
  829 :   245 :   136 :  1261 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
  830 :   246 :   137 :  1269 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
  831 :   247 :   138 :  1270 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
  832 :   248 :   139 :  1271 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
  833 :   249 :   140 :  1272 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  834 :   250 :   141 :  1273 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  835 :   251 :   142 :  1274 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  836 :   252 :   143 :  1275 :   331 :   sp->gpart->v_full[0] = sp->v[0];
  837 :   253 :   144 :  1276 :   332 :   sp->gpart->v_full[1] = sp->v[1];
  838 :   254 :   145 :  1277 :   333 :   sp->gpart->v_full[2] = sp->v[2];
  839 :   255 :   146 :  1447 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
  840 :   256 :   147 :  1490 :   251 :   sp->gpart->mass += gas_mass;
  841 :   257 :   148 :  1506 :   279 :   sp->gpart->v_full[0] = sp->v[0];
  842 :   258 :   149 :  1507 :   280 :   sp->gpart->v_full[1] = sp->v[1];
  843 :   259 :   150 :  1508 :   281 :   sp->gpart->v_full[2] = sp->v[2];
  844 :   260 :   151 :  1586 :   274 :   sp->gpart->x[0] = sp->x[0];
  845 :   261 :   152 :  1587 :   275 :   sp->gpart->x[1] = sp->x[1];
  846 :   262 :   153 :  1588 :   276 :   sp->gpart->x[2] = sp->x[2];
  847 :   263 :   154 :  1591 :   339 :     sp->gpart->mass = mass_star;
  848 :   264 :   155 :  1664 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  849 :   265 :   156 :  1665 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  850 :   266 :   157 :  1666 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  851 :   267 :   158 :  1818 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  852 :   268 :   159 :  1819 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  853 :   269 :   160 :  1820 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  854 :   270 :   161 :  1972 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  855 :   271 :   162 :  1973 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  856 :   272 :   163 :  1974 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  857 :   273 :   164 :  2121 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  858 :   274 :   165 :  2122 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  859 :   275 :   166 :  2123 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  860 :   276 :   167 :  2270 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  861 :   277 :   168 :  2271 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  862 :   278 :   169 :  2272 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  863 :   279 :   170 :  2420 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  864 :   280 :   171 :  2421 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  865 :   281 :   172 :  2422 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  866 :   282 :   173 :  2569 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  867 :   283 :   174 :  2570 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  868 :   284 :   175 :  2571 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  869 :   285 :   176 :  2718 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  870 :   286 :   177 :  2719 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  871 :   287 :   178 :  2720 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  872 :   288 :   179 :  2869 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  873 :   289 :   180 :  2870 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  874 :   290 :   181 :  2871 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  875 :   291 :   182 :  3018 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  876 :   292 :   183 :  3019 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  877 :   293 :   184 :  3020 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  878 :   294 :   185 :  3167 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  879 :   295 :   186 :  3168 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  880 :   296 :   187 :  3169 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  881 :   298 :   190 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
  882 :   397 :   308 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
  883 :   398 :   309 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
  884 :   399 :   310 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
  885 :   400 :   311 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  886 :   401 :   312 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  887 :   402 :   313 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  888 :   403 :   314 :   331 :   sp->gpart->v_full[0] = sp->v[0];
  889 :   404 :   315 :   332 :   sp->gpart->v_full[1] = sp->v[1];
  890 :   405 :   316 :   333 :   sp->gpart->v_full[2] = sp->v[2];
  891 :   461 :   375 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
  892 :   467 :   382 :   251 :   sp->gpart->mass += gas_mass;
  893 :   468 :   383 :   279 :   sp->gpart->v_full[0] = sp->v[0];
  894 :   469 :   384 :   280 :   sp->gpart->v_full[1] = sp->v[1];
  895 :   470 :   385 :   281 :   sp->gpart->v_full[2] = sp->v[2];
  896 :   500 :   421 :   274 :   sp->gpart->x[0] = sp->x[0];
  897 :   501 :   422 :   275 :   sp->gpart->x[1] = sp->x[1];
  898 :   502 :   423 :   276 :   sp->gpart->x[2] = sp->x[2];
  899 :   506 :   427 :   339 :     sp->gpart->mass = mass_star;
  900 :   508 :   430 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  901 :   509 :   431 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  902 :   510 :   432 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  903 :   511 :   434 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  904 :   512 :   435 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  905 :   513 :   436 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  906 :   514 :   438 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  907 :   515 :   439 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  908 :   516 :   440 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  909 :   517 :   441 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  910 :   518 :   442 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  911 :   519 :   443 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  912 :   520 :   444 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  913 :   521 :   445 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  914 :   522 :   446 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  915 :   523 :   447 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  916 :   524 :   448 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  917 :   525 :   449 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  918 :   526 :   450 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  919 :   527 :   451 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  920 :   528 :   452 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  921 :   529 :   453 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  922 :   530 :   454 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  923 :   531 :   455 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  924 :   532 :   457 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  925 :   533 :   458 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  926 :   534 :   459 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  927 :   535 :   460 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  928 :   536 :   461 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  929 :   537 :   462 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  930 :   538 :   463 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  931 :   539 :   464 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  932 :   540 :   465 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  933 :   581 :    44 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  934 :   582 :    45 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  935 :   583 :    46 :   649 :     sp->gpart->type = swift_type_dark_matter;
  936 :   621 :    89 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  937 :   622 :    90 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  938 :   623 :    91 :   355 :       sp->gpart->fof_data.group_mass;
  939 :   649 :   120 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  940 :   690 :   162 :    44 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  941 :   691 :   163 :    45 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  942 :   692 :   164 :    46 :   649 :     sp->gpart->type = swift_type_dark_matter;
  943 :   730 :   202 :    89 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  944 :   731 :   203 :    90 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  945 :   732 :   204 :    91 :   355 :       sp->gpart->fof_data.group_mass;
  946 :   758 :   230 :   120 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  947 :   760 :   232 :   123 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  948 :   761 :   233 :   124 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  949 :   762 :   234 :   125 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
  950 :   763 :   235 :   126 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  951 :   764 :   236 :   127 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  952 :   765 :   237 :   128 :   536 :   355 :       sp->gpart->fof_data.group_mass;
  953 :   766 :   238 :   129 :   670 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  954 :   767 :   239 :   130 :   707 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  955 :   768 :   240 :   131 :   708 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  956 :   769 :   241 :   132 :   709 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
  957 :   770 :   242 :   133 :  1183 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  958 :   771 :   243 :   134 :  1184 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  959 :   772 :   244 :   135 :  1185 :   536 :   355 :       sp->gpart->fof_data.group_mass;
  960 :   773 :   245 :   136 :  1261 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
  961 :   774 :   246 :   137 :  1269 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
  962 :   775 :   247 :   138 :  1270 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
  963 :   776 :   248 :   139 :  1271 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
  964 :   777 :   249 :   140 :  1272 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  965 :   778 :   250 :   141 :  1273 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  966 :   779 :   251 :   142 :  1274 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  967 :   780 :   252 :   143 :  1275 :   331 :   sp->gpart->v_full[0] = sp->v[0];
  968 :   781 :   253 :   144 :  1276 :   332 :   sp->gpart->v_full[1] = sp->v[1];
  969 :   782 :   254 :   145 :  1277 :   333 :   sp->gpart->v_full[2] = sp->v[2];
  970 :   783 :   255 :   146 :  1447 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
  971 :   784 :   256 :   147 :  1490 :   251 :   sp->gpart->mass += gas_mass;
  972 :   785 :   257 :   148 :  1506 :   279 :   sp->gpart->v_full[0] = sp->v[0];
  973 :   786 :   258 :   149 :  1507 :   280 :   sp->gpart->v_full[1] = sp->v[1];
  974 :   787 :   259 :   150 :  1508 :   281 :   sp->gpart->v_full[2] = sp->v[2];
  975 :   788 :   260 :   151 :  1586 :   274 :   sp->gpart->x[0] = sp->x[0];
  976 :   789 :   261 :   152 :  1587 :   275 :   sp->gpart->x[1] = sp->x[1];
  977 :   790 :   262 :   153 :  1588 :   276 :   sp->gpart->x[2] = sp->x[2];
  978 :   791 :   263 :   154 :  1591 :   339 :     sp->gpart->mass = mass_star;
  979 :   792 :   264 :   155 :  1664 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  980 :   793 :   265 :   156 :  1665 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  981 :   794 :   266 :   157 :  1666 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  982 :   795 :   267 :   158 :  1818 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  983 :   796 :   268 :   159 :  1819 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  984 :   797 :   269 :   160 :  1820 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  985 :   798 :   270 :   161 :  1972 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  986 :   799 :   271 :   162 :  1973 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  987 :   800 :   272 :   163 :  1974 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  988 :   801 :   273 :   164 :  2121 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  989 :   802 :   274 :   165 :  2122 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  990 :   803 :   275 :   166 :  2123 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  991 :   804 :   276 :   167 :  2270 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  992 :   805 :   277 :   168 :  2271 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  993 :   806 :   278 :   169 :  2272 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  994 :   807 :   279 :   170 :  2420 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  995 :   808 :   280 :   171 :  2421 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  996 :   809 :   281 :   172 :  2422 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  997 :   810 :   282 :   173 :  2569 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  998 :   811 :   283 :   174 :  2570 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  999 :   812 :   284 :   175 :  2571 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1000 :   813 :   285 :   176 :  2718 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1001 :   814 :   286 :   177 :  2719 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1002 :   815 :   287 :   178 :  2720 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1003 :   816 :   288 :   179 :  2869 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1004 :   817 :   289 :   180 :  2870 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1005 :   818 :   290 :   181 :  2871 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1006 :   819 :   291 :   182 :  3018 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1007 :   820 :   292 :   183 :  3019 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1008 :   821 :   293 :   184 :  3020 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1009 :   822 :   294 :   185 :  3167 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1010 :   823 :   295 :   186 :  3168 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1011 :   824 :   296 :   187 :  3169 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1012 :   826 :   298 :   190 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
 1013 :   925 :   397 :   308 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
 1014 :   926 :   398 :   309 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
 1015 :   927 :   399 :   310 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
 1016 :   928 :   400 :   311 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
 1017 :   929 :   401 :   312 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
 1018 :   930 :   402 :   313 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
 1019 :   931 :   403 :   314 :   331 :   sp->gpart->v_full[0] = sp->v[0];
 1020 :   932 :   404 :   315 :   332 :   sp->gpart->v_full[1] = sp->v[1];
 1021 :   933 :   405 :   316 :   333 :   sp->gpart->v_full[2] = sp->v[2];
 1022 :   989 :   461 :   375 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
 1023 :   995 :   467 :   382 :   251 :   sp->gpart->mass += gas_mass;
 1024 :   996 :   468 :   383 :   279 :   sp->gpart->v_full[0] = sp->v[0];
 1025 :   997 :   469 :   384 :   280 :   sp->gpart->v_full[1] = sp->v[1];
 1026 :   998 :   470 :   385 :   281 :   sp->gpart->v_full[2] = sp->v[2];
 1027 :  1028 :   500 :   421 :   274 :   sp->gpart->x[0] = sp->x[0];
 1028 :  1029 :   501 :   422 :   275 :   sp->gpart->x[1] = sp->x[1];
 1029 :  1030 :   502 :   423 :   276 :   sp->gpart->x[2] = sp->x[2];
 1030 :  1034 :   506 :   427 :   339 :     sp->gpart->mass = mass_star;
 1031 :  1036 :   508 :   430 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1032 :  1037 :   509 :   431 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1033 :  1038 :   510 :   432 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1034 :  1039 :   511 :   434 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1035 :  1040 :   512 :   435 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1036 :  1041 :   513 :   436 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1037 :  1042 :   514 :   438 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1038 :  1043 :   515 :   439 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1039 :  1044 :   516 :   440 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1040 :  1045 :   517 :   441 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1041 :  1046 :   518 :   442 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1042 :  1047 :   519 :   443 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1043 :  1048 :   520 :   444 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1044 :  1049 :   521 :   445 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1045 :  1050 :   522 :   446 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1046 :  1051 :   523 :   447 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1047 :  1052 :   524 :   448 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1048 :  1053 :   525 :   449 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1049 :  1054 :   526 :   450 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1050 :  1055 :   527 :   451 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1051 :  1056 :   528 :   452 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1052 :  1057 :   529 :   453 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1053 :  1058 :   530 :   454 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1054 :  1059 :   531 :   455 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1055 :  1060 :   532 :   457 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1056 :  1061 :   533 :   458 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1057 :  1062 :   534 :   459 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1058 :  1063 :   535 :   460 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1059 :  1064 :   536 :   461 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1060 :  1065 :   537 :   462 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1061 :  1066 :   538 :   463 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1062 :  1067 :   539 :   464 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1063 :  1068 :   540 :   465 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1064 :  1070 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
 1065 :  1071 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
 1066 :  1072 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
 1067 :  1073 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
 1068 :  1074 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
 1069 :  1075 :   536 :   355 :       sp->gpart->fof_data.group_mass;
 1070 :  1076 :   670 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
 1071 :  1077 :   707 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
 1072 :  1078 :   708 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
 1073 :  1079 :   709 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
 1074 :  1080 :  1183 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
 1075 :  1081 :  1184 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
 1076 :  1082 :  1185 :   536 :   355 :       sp->gpart->fof_data.group_mass;
 1077 :  1083 :  1261 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
 1078 :  1084 :  1269 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
 1079 :  1085 :  1270 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
 1080 :  1086 :  1271 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
 1081 :  1087 :  1272 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
 1082 :  1088 :  1273 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
 1083 :  1089 :  1274 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
 1084 :  1090 :  1275 :   331 :   sp->gpart->v_full[0] = sp->v[0];
 1085 :  1091 :  1276 :   332 :   sp->gpart->v_full[1] = sp->v[1];
 1086 :  1092 :  1277 :   333 :   sp->gpart->v_full[2] = sp->v[2];
 1087 :  1093 :  1447 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
 1088 :  1094 :  1490 :   251 :   sp->gpart->mass += gas_mass;
 1089 :  1095 :  1506 :   279 :   sp->gpart->v_full[0] = sp->v[0];
 1090 :  1096 :  1507 :   280 :   sp->gpart->v_full[1] = sp->v[1];
 1091 :  1097 :  1508 :   281 :   sp->gpart->v_full[2] = sp->v[2];
 1092 :  1098 :  1586 :   274 :   sp->gpart->x[0] = sp->x[0];
 1093 :  1099 :  1587 :   275 :   sp->gpart->x[1] = sp->x[1];
 1094 :  1100 :  1588 :   276 :   sp->gpart->x[2] = sp->x[2];
 1095 :  1101 :  1591 :   339 :     sp->gpart->mass = mass_star;
 1096 :  1102 :  1664 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1097 :  1103 :  1665 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1098 :  1104 :  1666 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1099 :  1105 :  1818 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1100 :  1106 :  1819 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1101 :  1107 :  1820 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1102 :  1108 :  1972 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1103 :  1109 :  1973 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1104 :  1110 :  1974 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1105 :  1111 :  2121 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1106 :  1112 :  2122 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1107 :  1113 :  2123 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1108 :  1114 :  2270 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1109 :  1115 :  2271 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1110 :  1116 :  2272 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1111 :  1117 :  2420 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1112 :  1118 :  2421 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1113 :  1119 :  2422 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1114 :  1120 :  2569 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1115 :  1121 :  2570 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1116 :  1122 :  2571 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1117 :  1123 :  2718 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1118 :  1124 :  2719 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1119 :  1125 :  2720 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1120 :  1126 :  2869 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1121 :  1127 :  2870 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1122 :  1128 :  2871 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1123 :  1129 :  3018 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1124 :  1130 :  3019 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1125 :  1131 :  3020 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1126 :  1132 :  3167 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1127 :  1133 :  3168 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1128 :  1134 :  3169 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1129 :  1137 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
 1130 :  1255 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
 1131 :  1256 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
 1132 :  1257 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
 1133 :  1258 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
 1134 :  1259 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
 1135 :  1260 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
 1136 :  1261 :   331 :   sp->gpart->v_full[0] = sp->v[0];
 1137 :  1262 :   332 :   sp->gpart->v_full[1] = sp->v[1];
 1138 :  1263 :   333 :   sp->gpart->v_full[2] = sp->v[2];
 1139 :  1322 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
 1140 :  1329 :   251 :   sp->gpart->mass += gas_mass;
 1141 :  1330 :   279 :   sp->gpart->v_full[0] = sp->v[0];
 1142 :  1331 :   280 :   sp->gpart->v_full[1] = sp->v[1];
 1143 :  1332 :   281 :   sp->gpart->v_full[2] = sp->v[2];
 1144 :  1368 :   274 :   sp->gpart->x[0] = sp->x[0];
 1145 :  1369 :   275 :   sp->gpart->x[1] = sp->x[1];
 1146 :  1370 :   276 :   sp->gpart->x[2] = sp->x[2];
 1147 :  1374 :   339 :     sp->gpart->mass = mass_star;
 1148 :  1377 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1149 :  1378 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1150 :  1379 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1151 :  1381 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1152 :  1382 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1153 :  1383 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1154 :  1385 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1155 :  1386 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1156 :  1387 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1157 :  1388 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1158 :  1389 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1159 :  1390 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1160 :  1391 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1161 :  1392 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1162 :  1393 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1163 :  1394 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1164 :  1395 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1165 :  1396 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1166 :  1397 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1167 :  1398 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1168 :  1399 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1169 :  1400 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1170 :  1401 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1171 :  1402 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1172 :  1404 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1173 :  1405 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1174 :  1406 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1175 :  1407 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1176 :  1408 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1177 :  1409 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1178 :  1410 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1179 :  1411 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1180 :  1412 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1212 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
 1213 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
 1214 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
 1688 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
 1689 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
 1690 :   536 :   355 :       sp->gpart->fof_data.group_mass;
 1820 :   670 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
 1826 :   677 :    44 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
 1827 :   678 :    45 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
 1828 :   679 :    46 :   649 :     sp->gpart->type = swift_type_dark_matter;
 1829 :   680 :    89 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
 1830 :   681 :    90 :   349 :       sp->gpart->fof_data.group_stellar_mass;
 1831 :   682 :    91 :   355 :       sp->gpart->fof_data.group_mass;
 1832 :   683 :   120 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
 1833 :   684 :   123 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
 1834 :   685 :   124 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
 1835 :   686 :   125 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
 1836 :   687 :   126 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
 1837 :   688 :   127 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
 1838 :   689 :   128 :   536 :   355 :       sp->gpart->fof_data.group_mass;
 1839 :   690 :   129 :   670 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
 1840 :   691 :   130 :   707 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
 1841 :   692 :   131 :   708 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
 1842 :   693 :   132 :   709 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
 1843 :   694 :   133 :  1183 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
 1844 :   695 :   134 :  1184 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
 1845 :   696 :   135 :  1185 :   536 :   355 :       sp->gpart->fof_data.group_mass;
 1846 :   697 :   136 :  1261 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
 1847 :   698 :   137 :  1269 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
 1848 :   699 :   138 :  1270 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
 1849 :   700 :   139 :  1271 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
 1850 :   701 :   140 :  1272 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
 1851 :   702 :   141 :  1273 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
 1852 :   703 :   142 :  1274 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
 1853 :   704 :   143 :  1275 :   331 :   sp->gpart->v_full[0] = sp->v[0];
 1854 :   705 :   144 :  1276 :   332 :   sp->gpart->v_full[1] = sp->v[1];
 1855 :   706 :   145 :  1277 :   333 :   sp->gpart->v_full[2] = sp->v[2];
 1856 :   707 :   146 :  1447 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
 1857 :   708 :   147 :  1490 :   251 :   sp->gpart->mass += gas_mass;
 1858 :   709 :   148 :  1506 :   279 :   sp->gpart->v_full[0] = sp->v[0];
 1859 :   710 :   149 :  1507 :   280 :   sp->gpart->v_full[1] = sp->v[1];
 1860 :   711 :   150 :  1508 :   281 :   sp->gpart->v_full[2] = sp->v[2];
 1861 :   712 :   151 :  1586 :   274 :   sp->gpart->x[0] = sp->x[0];
 1862 :   713 :   152 :  1587 :   275 :   sp->gpart->x[1] = sp->x[1];
 1863 :   714 :   153 :  1588 :   276 :   sp->gpart->x[2] = sp->x[2];
 1864 :   715 :   154 :  1591 :   339 :     sp->gpart->mass = mass_star;
 1865 :   716 :   155 :  1664 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1866 :   717 :   156 :  1665 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1867 :   718 :   157 :  1666 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1868 :   719 :   158 :  1818 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1869 :   720 :   159 :  1819 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1870 :   721 :   160 :  1820 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1871 :   722 :   161 :  1972 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1872 :   723 :   162 :  1973 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1873 :   724 :   163 :  1974 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1874 :   725 :   164 :  2121 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1875 :   726 :   165 :  2122 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1876 :   727 :   166 :  2123 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1877 :   728 :   167 :  2270 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1878 :   729 :   168 :  2271 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1879 :   730 :   169 :  2272 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1880 :   731 :   170 :  2420 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1881 :   732 :   171 :  2421 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1882 :   733 :   172 :  2422 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1883 :   734 :   173 :  2569 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1884 :   735 :   174 :  2570 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1885 :   736 :   175 :  2571 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1886 :   737 :   176 :  2718 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1887 :   738 :   177 :  2719 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1888 :   739 :   178 :  2720 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1889 :   740 :   179 :  2869 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1890 :   741 :   180 :  2870 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1891 :   742 :   181 :  2871 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1892 :   743 :   182 :  3018 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1893 :   744 :   183 :  3019 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1894 :   745 :   184 :  3020 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1895 :   746 :   185 :  3167 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1896 :   747 :   186 :  3168 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1897 :   748 :   187 :  3169 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1898 :   749 :   190 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
 1899 :   750 :   308 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
 1900 :   751 :   309 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
 1901 :   752 :   310 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
 1902 :   753 :   311 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
 1903 :   754 :   312 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
 1904 :   755 :   313 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
 1905 :   756 :   314 :   331 :   sp->gpart->v_full[0] = sp->v[0];
 1906 :   757 :   315 :   332 :   sp->gpart->v_full[1] = sp->v[1];
 1907 :   758 :   316 :   333 :   sp->gpart->v_full[2] = sp->v[2];
 1908 :   759 :   375 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
 1909 :   760 :   382 :   251 :   sp->gpart->mass += gas_mass;
 1910 :   761 :   383 :   279 :   sp->gpart->v_full[0] = sp->v[0];
 1911 :   762 :   384 :   280 :   sp->gpart->v_full[1] = sp->v[1];
 1912 :   763 :   385 :   281 :   sp->gpart->v_full[2] = sp->v[2];
 1913 :   764 :   421 :   274 :   sp->gpart->x[0] = sp->x[0];
 1914 :   765 :   422 :   275 :   sp->gpart->x[1] = sp->x[1];
 1915 :   766 :   423 :   276 :   sp->gpart->x[2] = sp->x[2];
 1916 :   767 :   427 :   339 :     sp->gpart->mass = mass_star;
 1917 :   768 :   430 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1918 :   769 :   431 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1919 :   770 :   432 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1920 :   771 :   434 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1921 :   772 :   435 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1922 :   773 :   436 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1923 :   774 :   438 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1924 :   775 :   439 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1925 :   776 :   440 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1926 :   777 :   441 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1927 :   778 :   442 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1928 :   779 :   443 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1929 :   780 :   444 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1930 :   781 :   445 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1931 :   782 :   446 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1932 :   783 :   447 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1933 :   784 :   448 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1934 :   785 :   449 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1935 :   786 :   450 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1936 :   787 :   451 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1937 :   788 :   452 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1938 :   789 :   453 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1939 :   790 :   454 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1940 :   791 :   455 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1941 :   792 :   457 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1942 :   793 :   458 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1943 :   794 :   459 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1944 :   795 :   460 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1945 :   796 :   461 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1946 :   797 :   462 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1947 :   798 :   463 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1948 :   799 :   464 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1949 :   800 :   465 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1950 :   802 :    44 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
 1951 :   803 :    45 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
 1952 :   804 :    46 :   649 :     sp->gpart->type = swift_type_dark_matter;
 1953 :   805 :    89 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
 1954 :   806 :    90 :   349 :       sp->gpart->fof_data.group_stellar_mass;
 1955 :   807 :    91 :   355 :       sp->gpart->fof_data.group_mass;
 1956 :   808 :   120 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
 1957 :   809 :   162 :    44 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
 1958 :   810 :   163 :    45 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
 1959 :   811 :   164 :    46 :   649 :     sp->gpart->type = swift_type_dark_matter;
 1960 :   812 :   202 :    89 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
 1961 :   813 :   203 :    90 :   349 :       sp->gpart->fof_data.group_stellar_mass;
 1962 :   814 :   204 :    91 :   355 :       sp->gpart->fof_data.group_mass;
 1963 :   815 :   230 :   120 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
 1964 :   816 :   232 :   123 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
 1965 :   817 :   233 :   124 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
 1966 :   818 :   234 :   125 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
 1967 :   819 :   235 :   126 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
 1968 :   820 :   236 :   127 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
 1969 :   821 :   237 :   128 :   536 :   355 :       sp->gpart->fof_data.group_mass;
 1970 :   822 :   238 :   129 :   670 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
 1971 :   823 :   239 :   130 :   707 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
 1972 :   824 :   240 :   131 :   708 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
 1973 :   825 :   241 :   132 :   709 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
 1974 :   826 :   242 :   133 :  1183 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
 1975 :   827 :   243 :   134 :  1184 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
 1976 :   828 :   244 :   135 :  1185 :   536 :   355 :       sp->gpart->fof_data.group_mass;
 1977 :   829 :   245 :   136 :  1261 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
 1978 :   830 :   246 :   137 :  1269 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
 1979 :   831 :   247 :   138 :  1270 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
 1980 :   832 :   248 :   139 :  1271 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
 1981 :   833 :   249 :   140 :  1272 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
 1982 :   834 :   250 :   141 :  1273 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
 1983 :   835 :   251 :   142 :  1274 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
 1984 :   836 :   252 :   143 :  1275 :   331 :   sp->gpart->v_full[0] = sp->v[0];
 1985 :   837 :   253 :   144 :  1276 :   332 :   sp->gpart->v_full[1] = sp->v[1];
 1986 :   838 :   254 :   145 :  1277 :   333 :   sp->gpart->v_full[2] = sp->v[2];
 1987 :   839 :   255 :   146 :  1447 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
 1988 :   840 :   256 :   147 :  1490 :   251 :   sp->gpart->mass += gas_mass;
 1989 :   841 :   257 :   148 :  1506 :   279 :   sp->gpart->v_full[0] = sp->v[0];
 1990 :   842 :   258 :   149 :  1507 :   280 :   sp->gpart->v_full[1] = sp->v[1];
 1991 :   843 :   259 :   150 :  1508 :   281 :   sp->gpart->v_full[2] = sp->v[2];
 1992 :   844 :   260 :   151 :  1586 :   274 :   sp->gpart->x[0] = sp->x[0];
 1993 :   845 :   261 :   152 :  1587 :   275 :   sp->gpart->x[1] = sp->x[1];
 1994 :   846 :   262 :   153 :  1588 :   276 :   sp->gpart->x[2] = sp->x[2];
 1995 :   847 :   263 :   154 :  1591 :   339 :     sp->gpart->mass = mass_star;
 1996 :   848 :   264 :   155 :  1664 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1997 :   849 :   265 :   156 :  1665 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1998 :   850 :   266 :   157 :  1666 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1999 :   851 :   267 :   158 :  1818 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2000 :   852 :   268 :   159 :  1819 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2001 :   853 :   269 :   160 :  1820 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2002 :   854 :   270 :   161 :  1972 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2003 :   855 :   271 :   162 :  1973 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2004 :   856 :   272 :   163 :  1974 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2005 :   857 :   273 :   164 :  2121 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2006 :   858 :   274 :   165 :  2122 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2007 :   859 :   275 :   166 :  2123 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2008 :   860 :   276 :   167 :  2270 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2009 :   861 :   277 :   168 :  2271 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2010 :   862 :   278 :   169 :  2272 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2011 :   863 :   279 :   170 :  2420 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2012 :   864 :   280 :   171 :  2421 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2013 :   865 :   281 :   172 :  2422 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2014 :   866 :   282 :   173 :  2569 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2015 :   867 :   283 :   174 :  2570 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2016 :   868 :   284 :   175 :  2571 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2017 :   869 :   285 :   176 :  2718 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2018 :   870 :   286 :   177 :  2719 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2019 :   871 :   287 :   178 :  2720 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2020 :   872 :   288 :   179 :  2869 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2021 :   873 :   289 :   180 :  2870 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2022 :   874 :   290 :   181 :  2871 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2023 :   875 :   291 :   182 :  3018 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2024 :   876 :   292 :   183 :  3019 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2025 :   877 :   293 :   184 :  3020 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2026 :   878 :   294 :   185 :  3167 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2027 :   879 :   295 :   186 :  3168 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2028 :   880 :   296 :   187 :  3169 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2029 :   881 :   298 :   190 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
 2030 :   882 :   397 :   308 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
 2031 :   883 :   398 :   309 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
 2032 :   884 :   399 :   310 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
 2033 :   885 :   400 :   311 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
 2034 :   886 :   401 :   312 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
 2035 :   887 :   402 :   313 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
 2036 :   888 :   403 :   314 :   331 :   sp->gpart->v_full[0] = sp->v[0];
 2037 :   889 :   404 :   315 :   332 :   sp->gpart->v_full[1] = sp->v[1];
 2038 :   890 :   405 :   316 :   333 :   sp->gpart->v_full[2] = sp->v[2];
 2039 :   891 :   461 :   375 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
 2040 :   892 :   467 :   382 :   251 :   sp->gpart->mass += gas_mass;
 2041 :   893 :   468 :   383 :   279 :   sp->gpart->v_full[0] = sp->v[0];
 2042 :   894 :   469 :   384 :   280 :   sp->gpart->v_full[1] = sp->v[1];
 2043 :   895 :   470 :   385 :   281 :   sp->gpart->v_full[2] = sp->v[2];
 2044 :   896 :   500 :   421 :   274 :   sp->gpart->x[0] = sp->x[0];
 2045 :   897 :   501 :   422 :   275 :   sp->gpart->x[1] = sp->x[1];
 2046 :   898 :   502 :   423 :   276 :   sp->gpart->x[2] = sp->x[2];
 2047 :   899 :   506 :   427 :   339 :     sp->gpart->mass = mass_star;
 2048 :   900 :   508 :   430 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2049 :   901 :   509 :   431 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2050 :   902 :   510 :   432 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2051 :   903 :   511 :   434 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2052 :   904 :   512 :   435 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2053 :   905 :   513 :   436 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2054 :   906 :   514 :   438 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2055 :   907 :   515 :   439 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2056 :   908 :   516 :   440 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2057 :   909 :   517 :   441 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2058 :   910 :   518 :   442 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2059 :   911 :   519 :   443 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2060 :   912 :   520 :   444 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2061 :   913 :   521 :   445 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2062 :   914 :   522 :   446 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2063 :   915 :   523 :   447 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2064 :   916 :   524 :   448 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2065 :   917 :   525 :   449 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2066 :   918 :   526 :   450 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2067 :   919 :   527 :   451 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2068 :   920 :   528 :   452 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2069 :   921 :   529 :   453 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2070 :   922 :   530 :   454 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2071 :   923 :   531 :   455 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2072 :   924 :   532 :   457 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2073 :   925 :   533 :   458 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2074 :   926 :   534 :   459 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2075 :   927 :   535 :   460 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2076 :   928 :   536 :   461 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2077 :   929 :   537 :   462 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2078 :   930 :   538 :   463 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2079 :   931 :   539 :   464 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2080 :   932 :   540 :   465 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2081 :   933 :   581 :    44 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
 2082 :   934 :   582 :    45 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
 2083 :   935 :   583 :    46 :   649 :     sp->gpart->type = swift_type_dark_matter;
 2084 :   936 :   621 :    89 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
 2085 :   937 :   622 :    90 :   349 :       sp->gpart->fof_data.group_stellar_mass;
 2086 :   938 :   623 :    91 :   355 :       sp->gpart->fof_data.group_mass;
 2087 :   939 :   649 :   120 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
 2088 :   940 :   690 :   162 :    44 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
 2089 :   941 :   691 :   163 :    45 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
 2090 :   942 :   692 :   164 :    46 :   649 :     sp->gpart->type = swift_type_dark_matter;
 2091 :   943 :   730 :   202 :    89 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
 2092 :   944 :   731 :   203 :    90 :   349 :       sp->gpart->fof_data.group_stellar_mass;
 2093 :   945 :   732 :   204 :    91 :   355 :       sp->gpart->fof_data.group_mass;
 2094 :   946 :   758 :   230 :   120 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
 2095 :   947 :   760 :   232 :   123 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
 2096 :   948 :   761 :   233 :   124 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
 2097 :   949 :   762 :   234 :   125 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
 2098 :   950 :   763 :   235 :   126 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
 2099 :   951 :   764 :   236 :   127 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
 2100 :   952 :   765 :   237 :   128 :   536 :   355 :       sp->gpart->fof_data.group_mass;
 2101 :   953 :   766 :   238 :   129 :   670 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
 2102 :   954 :   767 :   239 :   130 :   707 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
 2103 :   955 :   768 :   240 :   131 :   708 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
 2104 :   956 :   769 :   241 :   132 :   709 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
 2105 :   957 :   770 :   242 :   133 :  1183 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
 2106 :   958 :   771 :   243 :   134 :  1184 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
 2107 :   959 :   772 :   244 :   135 :  1185 :   536 :   355 :       sp->gpart->fof_data.group_mass;
 2108 :   960 :   773 :   245 :   136 :  1261 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
 2109 :   961 :   774 :   246 :   137 :  1269 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
 2110 :   962 :   775 :   247 :   138 :  1270 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
 2111 :   963 :   776 :   248 :   139 :  1271 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
 2112 :   964 :   777 :   249 :   140 :  1272 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
 2113 :   965 :   778 :   250 :   141 :  1273 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
 2114 :   966 :   779 :   251 :   142 :  1274 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
 2115 :   967 :   780 :   252 :   143 :  1275 :   331 :   sp->gpart->v_full[0] = sp->v[0];
 2116 :   968 :   781 :   253 :   144 :  1276 :   332 :   sp->gpart->v_full[1] = sp->v[1];
 2117 :   969 :   782 :   254 :   145 :  1277 :   333 :   sp->gpart->v_full[2] = sp->v[2];
 2118 :   970 :   783 :   255 :   146 :  1447 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
 2119 :   971 :   784 :   256 :   147 :  1490 :   251 :   sp->gpart->mass += gas_mass;
 2120 :   972 :   785 :   257 :   148 :  1506 :   279 :   sp->gpart->v_full[0] = sp->v[0];
 2121 :   973 :   786 :   258 :   149 :  1507 :   280 :   sp->gpart->v_full[1] = sp->v[1];
 2122 :   974 :   787 :   259 :   150 :  1508 :   281 :   sp->gpart->v_full[2] = sp->v[2];
 2123 :   975 :   788 :   260 :   151 :  1586 :   274 :   sp->gpart->x[0] = sp->x[0];
 2124 :   976 :   789 :   261 :   152 :  1587 :   275 :   sp->gpart->x[1] = sp->x[1];
 2125 :   977 :   790 :   262 :   153 :  1588 :   276 :   sp->gpart->x[2] = sp->x[2];
 2126 :   978 :   791 :   263 :   154 :  1591 :   339 :     sp->gpart->mass = mass_star;
 2127 :   979 :   792 :   264 :   155 :  1664 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2128 :   980 :   793 :   265 :   156 :  1665 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2129 :   981 :   794 :   266 :   157 :  1666 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2130 :   982 :   795 :   267 :   158 :  1818 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2131 :   983 :   796 :   268 :   159 :  1819 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2132 :   984 :   797 :   269 :   160 :  1820 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2133 :   985 :   798 :   270 :   161 :  1972 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2134 :   986 :   799 :   271 :   162 :  1973 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2135 :   987 :   800 :   272 :   163 :  1974 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2136 :   988 :   801 :   273 :   164 :  2121 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2137 :   989 :   802 :   274 :   165 :  2122 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2138 :   990 :   803 :   275 :   166 :  2123 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2139 :   991 :   804 :   276 :   167 :  2270 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2140 :   992 :   805 :   277 :   168 :  2271 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2141 :   993 :   806 :   278 :   169 :  2272 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2142 :   994 :   807 :   279 :   170 :  2420 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2143 :   995 :   808 :   280 :   171 :  2421 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2144 :   996 :   809 :   281 :   172 :  2422 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2145 :   997 :   810 :   282 :   173 :  2569 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2146 :   998 :   811 :   283 :   174 :  2570 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2147 :   999 :   812 :   284 :   175 :  2571 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2148 :  1000 :   813 :   285 :   176 :  2718 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2149 :  1001 :   814 :   286 :   177 :  2719 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2150 :  1002 :   815 :   287 :   178 :  2720 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2151 :  1003 :   816 :   288 :   179 :  2869 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2152 :  1004 :   817 :   289 :   180 :  2870 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2153 :  1005 :   818 :   290 :   181 :  2871 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2154 :  1006 :   819 :   291 :   182 :  3018 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2155 :  1007 :   820 :   292 :   183 :  3019 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2156 :  1008 :   821 :   293 :   184 :  3020 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2157 :  1009 :   822 :   294 :   185 :  3167 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2158 :  1010 :   823 :   295 :   186 :  3168 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2159 :  1011 :   824 :   296 :   187 :  3169 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2160 :  1012 :   826 :   298 :   190 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
 2161 :  1013 :   925 :   397 :   308 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
 2162 :  1014 :   926 :   398 :   309 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
 2163 :  1015 :   927 :   399 :   310 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
 2164 :  1016 :   928 :   400 :   311 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
 2165 :  1017 :   929 :   401 :   312 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
 2166 :  1018 :   930 :   402 :   313 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
 2167 :  1019 :   931 :   403 :   314 :   331 :   sp->gpart->v_full[0] = sp->v[0];
 2168 :  1020 :   932 :   404 :   315 :   332 :   sp->gpart->v_full[1] = sp->v[1];
 2169 :  1021 :   933 :   405 :   316 :   333 :   sp->gpart->v_full[2] = sp->v[2];
 2170 :  1022 :   989 :   461 :   375 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
 2171 :  1023 :   995 :   467 :   382 :   251 :   sp->gpart->mass += gas_mass;
 2172 :  1024 :   996 :   468 :   383 :   279 :   sp->gpart->v_full[0] = sp->v[0];
 2173 :  1025 :   997 :   469 :   384 :   280 :   sp->gpart->v_full[1] = sp->v[1];
 2174 :  1026 :   998 :   470 :   385 :   281 :   sp->gpart->v_full[2] = sp->v[2];
 2175 :  1027 :  1028 :   500 :   421 :   274 :   sp->gpart->x[0] = sp->x[0];
 2176 :  1028 :  1029 :   501 :   422 :   275 :   sp->gpart->x[1] = sp->x[1];
 2177 :  1029 :  1030 :   502 :   423 :   276 :   sp->gpart->x[2] = sp->x[2];
 2178 :  1030 :  1034 :   506 :   427 :   339 :     sp->gpart->mass = mass_star;
 2179 :  1031 :  1036 :   508 :   430 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2180 :  1032 :  1037 :   509 :   431 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2181 :  1033 :  1038 :   510 :   432 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2182 :  1034 :  1039 :   511 :   434 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2183 :  1035 :  1040 :   512 :   435 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2184 :  1036 :  1041 :   513 :   436 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2185 :  1037 :  1042 :   514 :   438 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2186 :  1038 :  1043 :   515 :   439 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2187 :  1039 :  1044 :   516 :   440 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2188 :  1040 :  1045 :   517 :   441 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2189 :  1041 :  1046 :   518 :   442 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2190 :  1042 :  1047 :   519 :   443 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2191 :  1043 :  1048 :   520 :   444 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2192 :  1044 :  1049 :   521 :   445 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2193 :  1045 :  1050 :   522 :   446 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2194 :  1046 :  1051 :   523 :   447 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2195 :  1047 :  1052 :   524 :   448 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2196 :  1048 :  1053 :   525 :   449 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2197 :  1049 :  1054 :   526 :   450 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2198 :  1050 :  1055 :   527 :   451 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2199 :  1051 :  1056 :   528 :   452 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2200 :  1052 :  1057 :   529 :   453 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2201 :  1053 :  1058 :   530 :   454 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2202 :  1054 :  1059 :   531 :   455 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2203 :  1055 :  1060 :   532 :   457 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2204 :  1056 :  1061 :   533 :   458 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2205 :  1057 :  1062 :   534 :   459 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2206 :  1058 :  1063 :   535 :   460 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2207 :  1059 :  1064 :   536 :   461 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2208 :  1060 :  1065 :   537 :   462 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2209 :  1061 :  1066 :   538 :   463 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2210 :  1062 :  1067 :   539 :   464 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2211 :  1063 :  1068 :   540 :   465 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2212 :  1064 :  1070 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
 2213 :  1065 :  1071 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
 2214 :  1066 :  1072 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
 2215 :  1067 :  1073 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
 2216 :  1068 :  1074 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
 2217 :  1069 :  1075 :   536 :   355 :       sp->gpart->fof_data.group_mass;
 2218 :  1070 :  1076 :   670 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
 2219 :  1071 :  1077 :   707 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
 2220 :  1072 :  1078 :   708 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
 2221 :  1073 :  1079 :   709 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
 2222 :  1074 :  1080 :  1183 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
 2223 :  1075 :  1081 :  1184 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
 2224 :  1076 :  1082 :  1185 :   536 :   355 :       sp->gpart->fof_data.group_mass;
 2225 :  1077 :  1083 :  1261 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
 2226 :  1078 :  1084 :  1269 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
 2227 :  1079 :  1085 :  1270 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
 2228 :  1080 :  1086 :  1271 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
 2229 :  1081 :  1087 :  1272 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
 2230 :  1082 :  1088 :  1273 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
 2231 :  1083 :  1089 :  1274 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
 2232 :  1084 :  1090 :  1275 :   331 :   sp->gpart->v_full[0] = sp->v[0];
 2233 :  1085 :  1091 :  1276 :   332 :   sp->gpart->v_full[1] = sp->v[1];
 2234 :  1086 :  1092 :  1277 :   333 :   sp->gpart->v_full[2] = sp->v[2];
 2235 :  1087 :  1093 :  1447 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
 2236 :  1088 :  1094 :  1490 :   251 :   sp->gpart->mass += gas_mass;
 2237 :  1089 :  1095 :  1506 :   279 :   sp->gpart->v_full[0] = sp->v[0];
 2238 :  1090 :  1096 :  1507 :   280 :   sp->gpart->v_full[1] = sp->v[1];
 2239 :  1091 :  1097 :  1508 :   281 :   sp->gpart->v_full[2] = sp->v[2];
 2240 :  1092 :  1098 :  1586 :   274 :   sp->gpart->x[0] = sp->x[0];
 2241 :  1093 :  1099 :  1587 :   275 :   sp->gpart->x[1] = sp->x[1];
 2242 :  1094 :  1100 :  1588 :   276 :   sp->gpart->x[2] = sp->x[2];
 2243 :  1095 :  1101 :  1591 :   339 :     sp->gpart->mass = mass_star;
 2244 :  1096 :  1102 :  1664 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2245 :  1097 :  1103 :  1665 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2246 :  1098 :  1104 :  1666 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2247 :  1099 :  1105 :  1818 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2248 :  1100 :  1106 :  1819 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2249 :  1101 :  1107 :  1820 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2250 :  1102 :  1108 :  1972 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2251 :  1103 :  1109 :  1973 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2252 :  1104 :  1110 :  1974 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2253 :  1105 :  1111 :  2121 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2254 :  1106 :  1112 :  2122 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2255 :  1107 :  1113 :  2123 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2256 :  1108 :  1114 :  2270 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2257 :  1109 :  1115 :  2271 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2258 :  1110 :  1116 :  2272 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2259 :  1111 :  1117 :  2420 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2260 :  1112 :  1118 :  2421 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2261 :  1113 :  1119 :  2422 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2262 :  1114 :  1120 :  2569 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2263 :  1115 :  1121 :  2570 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2264 :  1116 :  1122 :  2571 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2265 :  1117 :  1123 :  2718 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2266 :  1118 :  1124 :  2719 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2267 :  1119 :  1125 :  2720 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2268 :  1120 :  1126 :  2869 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2269 :  1121 :  1127 :  2870 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2270 :  1122 :  1128 :  2871 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2271 :  1123 :  1129 :  3018 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2272 :  1124 :  1130 :  3019 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2273 :  1125 :  1131 :  3020 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2274 :  1126 :  1132 :  3167 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2275 :  1127 :  1133 :  3168 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2276 :  1128 :  1134 :  3169 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2277 :  1129 :  1137 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
 2278 :  1130 :  1255 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
 2279 :  1131 :  1256 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
 2280 :  1132 :  1257 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
 2281 :  1133 :  1258 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
 2282 :  1134 :  1259 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
 2283 :  1135 :  1260 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
 2284 :  1136 :  1261 :   331 :   sp->gpart->v_full[0] = sp->v[0];
 2285 :  1137 :  1262 :   332 :   sp->gpart->v_full[1] = sp->v[1];
 2286 :  1138 :  1263 :   333 :   sp->gpart->v_full[2] = sp->v[2];
 2287 :  1139 :  1322 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
 2288 :  1140 :  1329 :   251 :   sp->gpart->mass += gas_mass;
 2289 :  1141 :  1330 :   279 :   sp->gpart->v_full[0] = sp->v[0];
 2290 :  1142 :  1331 :   280 :   sp->gpart->v_full[1] = sp->v[1];
 2291 :  1143 :  1332 :   281 :   sp->gpart->v_full[2] = sp->v[2];
 2292 :  1144 :  1368 :   274 :   sp->gpart->x[0] = sp->x[0];
 2293 :  1145 :  1369 :   275 :   sp->gpart->x[1] = sp->x[1];
 2294 :  1146 :  1370 :   276 :   sp->gpart->x[2] = sp->x[2];
 2295 :  1147 :  1374 :   339 :     sp->gpart->mass = mass_star;
 2296 :  1148 :  1377 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2297 :  1149 :  1378 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2298 :  1150 :  1379 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2299 :  1151 :  1381 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2300 :  1152 :  1382 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2301 :  1153 :  1383 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2302 :  1154 :  1385 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2303 :  1155 :  1386 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2304 :  1156 :  1387 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2305 :  1157 :  1388 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2306 :  1158 :  1389 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2307 :  1159 :  1390 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2308 :  1160 :  1391 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2309 :  1161 :  1392 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2310 :  1162 :  1393 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2311 :  1163 :  1394 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2312 :  1164 :  1395 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2313 :  1165 :  1396 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2314 :  1166 :  1397 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2315 :  1167 :  1398 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2316 :  1168 :  1399 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2317 :  1169 :  1400 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2318 :  1170 :  1401 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2319 :  1171 :  1402 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2320 :  1172 :  1404 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2321 :  1173 :  1405 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2322 :  1174 :  1406 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2323 :  1175 :  1407 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2324 :  1176 :  1408 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2325 :  1177 :  1409 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2326 :  1178 :  1410 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2327 :  1179 :  1411 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2328 :  1180 :  1412 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2360 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
 2361 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
 2362 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
 2836 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
 2837 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
 2838 :   536 :   355 :       sp->gpart->fof_data.group_mass;
 2968 :   670 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
 3004 :   707 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
 3005 :   708 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
 3006 :   709 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
 3480 :  1183 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
 3481 :  1184 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
 3482 :  1185 :   536 :   355 :       sp->gpart->fof_data.group_mass;
 3557 :  1261 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
 3563 :  1269 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
 3564 :  1270 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
 3565 :  1271 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
 3566 :  1272 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
 3567 :  1273 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
 3568 :  1274 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
 3569 :  1275 :   331 :   sp->gpart->v_full[0] = sp->v[0];
 3570 :  1276 :   332 :   sp->gpart->v_full[1] = sp->v[1];
 3571 :  1277 :   333 :   sp->gpart->v_full[2] = sp->v[2];
 3724 :  1447 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
 3763 :  1490 :   251 :   sp->gpart->mass += gas_mass;
 3779 :  1506 :   279 :   sp->gpart->v_full[0] = sp->v[0];
 3780 :  1507 :   280 :   sp->gpart->v_full[1] = sp->v[1];
 3781 :  1508 :   281 :   sp->gpart->v_full[2] = sp->v[2];
 3851 :  1586 :   274 :   sp->gpart->x[0] = sp->x[0];
 3852 :  1587 :   275 :   sp->gpart->x[1] = sp->x[1];
 3853 :  1588 :   276 :   sp->gpart->x[2] = sp->x[2];
 3856 :  1591 :   339 :     sp->gpart->mass = mass_star;
 3920 :  1664 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 3921 :  1665 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 3922 :  1666 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 4069 :  1818 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 4070 :  1819 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 4071 :  1820 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 4218 :  1972 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 4219 :  1973 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 4220 :  1974 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 4367 :  2121 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 4368 :  2122 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 4369 :  2123 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 4516 :  2270 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 4517 :  2271 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 4518 :  2272 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 4666 :  2420 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 4667 :  2421 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 4668 :  2422 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 4815 :  2569 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 4816 :  2570 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 4817 :  2571 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 4964 :  2718 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 4965 :  2719 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 4966 :  2720 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 5114 :  2869 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 5115 :  2870 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 5116 :  2871 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 5263 :  3018 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 5264 :  3019 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 5265 :  3020 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 5412 :  3167 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 5413 :  3168 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 5414 :  3169 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 5563 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
 5571 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
 5572 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
 5573 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
 5574 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
 5575 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
 5576 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
 5577 :   331 :   sp->gpart->v_full[0] = sp->v[0];
 5578 :   332 :   sp->gpart->v_full[1] = sp->v[1];
 5579 :   333 :   sp->gpart->v_full[2] = sp->v[2];
 5749 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
 5792 :   251 :   sp->gpart->mass += gas_mass;
 5808 :   279 :   sp->gpart->v_full[0] = sp->v[0];
 5809 :   280 :   sp->gpart->v_full[1] = sp->v[1];
 5810 :   281 :   sp->gpart->v_full[2] = sp->v[2];
 5888 :   274 :   sp->gpart->x[0] = sp->x[0];
 5889 :   275 :   sp->gpart->x[1] = sp->x[1];
 5890 :   276 :   sp->gpart->x[2] = sp->x[2];
 5893 :   339 :     sp->gpart->mass = mass_star;
 5966 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 5967 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 5968 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 6120 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 6121 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 6122 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 6274 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 6275 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 6276 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 6423 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 6424 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 6425 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 6572 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 6573 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 6574 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 6722 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 6723 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 6724 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 6871 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 6872 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 6873 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 7020 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 7021 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 7022 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 7171 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 7172 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 7173 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 7320 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 7321 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 7322 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 7469 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 7470 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 7471 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
./src/fof_data.group_stellar_mass:
   34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
   35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
   36 :   649 :     sp->gpart->type = swift_type_dark_matter;
  534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  536 :   355 :       sp->gpart->fof_data.group_mass;
  670 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  707 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  708 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  709 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
 1183 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
 1184 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
 1185 :   536 :   355 :       sp->gpart->fof_data.group_mass;
 1261 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
 1269 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
 1270 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
 1271 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
 1272 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
 1273 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
 1274 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
 1275 :   331 :   sp->gpart->v_full[0] = sp->v[0];
 1276 :   332 :   sp->gpart->v_full[1] = sp->v[1];
 1277 :   333 :   sp->gpart->v_full[2] = sp->v[2];
 1447 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
 1490 :   251 :   sp->gpart->mass += gas_mass;
 1506 :   279 :   sp->gpart->v_full[0] = sp->v[0];
 1507 :   280 :   sp->gpart->v_full[1] = sp->v[1];
 1508 :   281 :   sp->gpart->v_full[2] = sp->v[2];
 1586 :   274 :   sp->gpart->x[0] = sp->x[0];
 1587 :   275 :   sp->gpart->x[1] = sp->x[1];
 1588 :   276 :   sp->gpart->x[2] = sp->x[2];
 1591 :   339 :     sp->gpart->mass = mass_star;
 1664 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1665 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1666 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1818 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1819 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1820 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1972 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1973 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1974 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2121 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2122 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2123 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2270 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2271 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2272 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2420 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2421 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2422 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2569 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2570 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2571 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2718 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2719 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2720 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2869 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2870 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2871 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 3018 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 3019 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 3020 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 3167 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 3168 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 3169 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
./src/fof_io.h:
   31 :   ret[0] = p->gpart->fof_data.group_id;
   37 :   ret[0] = sp->gpart->fof_data.group_id;
   43 :   ret[0] = bp->gpart->fof_data.group_id;
./src/hydro/AnarchyPU/hydro_io.h:
  136 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  137 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  138 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  143 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  144 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  145 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./src/hydro/Gadget2/hydro_csds.h:
   54 :     acc[0] += p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
   55 :     acc[1] += p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
   56 :     acc[2] += p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
./src/hydro/Gadget2/hydro_io.h:
  127 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  128 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  129 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  134 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  135 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  136 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./src/hydro/Gasoline/hydro_io.h:
  138 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  139 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  140 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  145 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  146 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  147 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./src/hydro/Gizmo/MFM/hydro_velocities.h:
   98 :     p->gpart->v_full[0] = p->v_full[0];
   99 :     p->gpart->v_full[1] = p->v_full[1];
  100 :     p->gpart->v_full[2] = p->v_full[2];
./src/hydro/Gizmo/MFV/hydro_flux.h:
  254 :     p->gpart->mass = p->conserved.mass;
./src/hydro/Gizmo/MFV/hydro_velocities.h:
  149 :     p->gpart->v_full[0] = p->v[0];
  150 :     p->gpart->v_full[1] = p->v[1];
  151 :     p->gpart->v_full[2] = p->v[2];
./src/hydro/Gizmo/hydro.h:
  696 :     a_grav[0] = p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  697 :     a_grav[1] = p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  698 :     a_grav[2] = p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  700 :     grav_kick_factor[0] = dt_grav * p->gpart->a_grav[0];
  701 :     grav_kick_factor[1] = dt_grav * p->gpart->a_grav[1];
  702 :     grav_kick_factor[2] = dt_grav * p->gpart->a_grav[2];
  704 :       grav_kick_factor[0] += dt_grav_mesh * p->gpart->a_grav_mesh[0];
  705 :       grav_kick_factor[1] += dt_grav_mesh * p->gpart->a_grav_mesh[1];
  706 :       grav_kick_factor[2] += dt_grav_mesh * p->gpart->a_grav_mesh[2];
./src/hydro/Gizmo/hydro_getters.h:
  310 :     v[0] += p->gpart->a_grav[0] * dt_kick_grav;
  311 :     v[1] += p->gpart->a_grav[1] * dt_kick_grav;
  312 :     v[2] += p->gpart->a_grav[2] * dt_kick_grav;
./src/hydro/Minimal/hydro_io.h:
  141 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  142 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  143 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  148 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  149 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  150 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./src/hydro/Phantom/hydro_io.h:
  137 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  138 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  139 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  144 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  145 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  146 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./src/hydro/Planetary/hydro_io.h:
  152 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  153 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  154 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  159 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  160 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  161 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./src/hydro/PressureEnergy/hydro_io.h:
  138 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  139 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  140 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  145 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  146 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  147 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./src/hydro/PressureEnergyMorrisMonaghanAV/hydro_io.h:
  139 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  140 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  141 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  146 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  147 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  148 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./src/hydro/PressureEntropy/hydro_io.h:
  139 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  140 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  141 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  146 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  147 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  148 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./src/hydro/SPHENIX/hydro_csds.h:
   54 :     acc[0] += p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
   55 :     acc[1] += p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
   56 :     acc[2] += p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
./src/hydro/SPHENIX/hydro_io.h:
  134 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  135 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  136 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  141 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  142 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  143 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./src/hydro/Shadowswift/hydro.h:
  551 :     p->gpart->v_full[0] = p->v[0];
  552 :     p->gpart->v_full[1] = p->v[1];
  553 :     p->gpart->v_full[2] = p->v[2];
./src/kick.h:
  251 :     p->v_full[0] += p->gpart->a_grav[0] * dt_kick_grav;
  252 :     p->v_full[1] += p->gpart->a_grav[1] * dt_kick_grav;
  253 :     p->v_full[2] += p->gpart->a_grav[2] * dt_kick_grav;
  258 :     p->v_full[0] += p->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  259 :     p->v_full[1] += p->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  260 :     p->v_full[2] += p->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  265 :     p->gpart->v_full[0] = p->v_full[0];
  266 :     p->gpart->v_full[1] = p->v_full[1];
  267 :     p->gpart->v_full[2] = p->v_full[2];
  326 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
  327 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
  328 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
  331 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  332 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  333 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  336 :   sp->gpart->v_full[0] = sp->v[0];
  337 :   sp->gpart->v_full[1] = sp->v[1];
  338 :   sp->gpart->v_full[2] = sp->v[2];
  383 :   bp->v[0] += bp->gpart->a_grav[0] * dt_kick_grav;
  384 :   bp->v[1] += bp->gpart->a_grav[1] * dt_kick_grav;
  385 :   bp->v[2] += bp->gpart->a_grav[2] * dt_kick_grav;
  388 :   bp->v[0] += bp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  389 :   bp->v[1] += bp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  390 :   bp->v[2] += bp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  393 :   bp->gpart->v_full[0] = bp->v[0];
  394 :   bp->gpart->v_full[1] = bp->v[1];
  395 :   bp->gpart->v_full[2] = bp->v[2];
  442 :   sink->v[0] += sink->gpart->a_grav[0] * dt_kick_grav;
  443 :   sink->v[1] += sink->gpart->a_grav[1] * dt_kick_grav;
  444 :   sink->v[2] += sink->gpart->a_grav[2] * dt_kick_grav;
  447 :   sink->v[0] += sink->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  448 :   sink->v[1] += sink->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  449 :   sink->v[2] += sink->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  452 :   sink->gpart->v_full[0] = sink->v[0];
  453 :   sink->gpart->v_full[1] = sink->v[1];
  454 :   sink->gpart->v_full[2] = sink->v[2];
./src/part.c:
   47 :       parts[k].gpart->id_or_neg_offset = -(k + offset);
   63 :       sparts[k].gpart->id_or_neg_offset = -(k + offset);
   79 :       sinks[k].gpart->id_or_neg_offset = -(k + offset);
   95 :       bparts[k].gpart->id_or_neg_offset = -(k + offset);
  433 :       if (parts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  438 :       if (parts[k].x[0] != parts[k].gpart->x[0] ||
  439 :           parts[k].x[1] != parts[k].gpart->x[1] ||
  440 :           parts[k].x[2] != parts[k].gpart->x[2])
  444 :       if (hydro_get_mass(&parts[k]) != parts[k].gpart->mass)
  448 :       if (parts[k].time_bin != parts[k].gpart->time_bin)
  460 :       if (sparts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  465 :       if (sparts[k].x[0] != sparts[k].gpart->x[0] ||
  466 :           sparts[k].x[1] != sparts[k].gpart->x[1] ||
  467 :           sparts[k].x[2] != sparts[k].gpart->x[2])
  471 :       if (sparts[k].mass != sparts[k].gpart->mass)
  475 :       if (sparts[k].time_bin != sparts[k].gpart->time_bin)
  487 :       if (bparts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  492 :       if (bparts[k].x[0] != bparts[k].gpart->x[0] ||
  493 :           bparts[k].x[1] != bparts[k].gpart->x[1] ||
  494 :           bparts[k].x[2] != bparts[k].gpart->x[2])
  498 :       if (bparts[k].mass != bparts[k].gpart->mass)
  502 :       if (bparts[k].time_bin != bparts[k].gpart->time_bin)
  514 :       if (sinks[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  519 :       if (sinks[k].x[0] != sinks[k].gpart->x[0] ||
  520 :           sinks[k].x[1] != sinks[k].gpart->x[1] ||
  521 :           sinks[k].x[2] != sinks[k].gpart->x[2])
  525 :       if (sinks[k].mass != sinks[k].gpart->mass)
  529 :       if (sinks[k].time_bin != sinks[k].gpart->time_bin)
./src/runner_black_holes.c:
  108 :         p->gpart->mass = hydro_get_mass(p);
  339 :         cell_bp->gpart->mass = cell_bp->mass;
  340 :         cell_bp->gpart->v_full[0] = cell_bp->v[0];
  341 :         cell_bp->gpart->v_full[1] = cell_bp->v[1];
  342 :         cell_bp->gpart->v_full[2] = cell_bp->v[2];
./src/runner_time_integration.c:
  187 :           xp->a_grav[0] = p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  188 :           xp->a_grav[1] = p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  189 :           xp->a_grav[2] = p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  751 :         if (p->gpart != NULL) p->gpart->time_bin = p->time_bin;
  938 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
 1012 :         sink->gpart->time_bin = get_time_bin(ti_new_step);
 1082 :         bp->gpart->time_bin = get_time_bin(ti_new_step);
 1449 :           p->gpart->time_bin = p->time_bin;
 1601 :         if (p->gpart != NULL) p->gpart->time_bin = new_time_bin;
 1624 :           p->gpart->time_bin = p->time_bin;
./src/sink/GEAR/sink.h:
  251 :   sp->gpart->mass += gas_mass;
  279 :   sp->gpart->v_full[0] = sp->v[0];
  280 :   sp->gpart->v_full[1] = sp->v[1];
  281 :   sp->gpart->v_full[2] = sp->v[2];
  321 :   spi->gpart->mass += spj->mass;
  337 :   spi->gpart->v_full[0] = spi->v[0];
  338 :   spi->gpart->v_full[1] = spi->v[1];
  339 :   spi->gpart->v_full[2] = spi->v[2];
./src/sink/GEAR/sink_iact.h:
   66 :     float potential_i = pi->gpart->potential;
   67 :     float potential_j = pj->gpart->potential;
./src/space.c:
 2239 :       if (parts[k].time_bin != parts[k].gpart->time_bin) {
 2241 :               parts[k].gpart->time_bin);
./src/space_first_init.c:
  151 :     /* Check part->gpart->part linkeage. */
  152 :     if (p[k].gpart && p[k].gpart->id_or_neg_offset != -(k + delta))
  329 :     if (sp[k].gpart && sp[k].gpart->id_or_neg_offset != -(k + delta))
  420 :     if (bp[k].gpart && bp[k].gpart->id_or_neg_offset != -(k + delta))
  486 :     if (sink[k].gpart && sink[k].gpart->id_or_neg_offset != -(k + delta))
./src/space_rebuild.c:
  223 :           s->parts[k].gpart->id_or_neg_offset = -k;
  226 :           s->parts[nr_parts].gpart->id_or_neg_offset = -nr_parts;
  275 :           s->sparts[k].gpart->id_or_neg_offset = -k;
  278 :           s->sparts[nr_sparts].gpart->id_or_neg_offset = -nr_sparts;
  325 :           s->bparts[k].gpart->id_or_neg_offset = -k;
  328 :           s->bparts[nr_bparts].gpart->id_or_neg_offset = -nr_bparts;
  376 :           s->sinks[k].gpart->id_or_neg_offset = -k;
  379 :           s->sinks[nr_sinks].gpart->id_or_neg_offset = -nr_sinks;
./src/space_sort.c:
   76 :           parts[j].gpart->id_or_neg_offset = -(j + parts_offset);
   82 :         parts[k].gpart->id_or_neg_offset = -(k + parts_offset);
  138 :           sparts[j].gpart->id_or_neg_offset = -(j + sparts_offset);
  143 :         sparts[k].gpart->id_or_neg_offset = -(k + sparts_offset);
  199 :           bparts[j].gpart->id_or_neg_offset = -(j + bparts_offset);
  204 :         bparts[k].gpart->id_or_neg_offset = -(k + bparts_offset);
  259 :           sinks[j].gpart->id_or_neg_offset = -(j + sinks_offset);
  264 :         sinks[k].gpart->id_or_neg_offset = -(k + sinks_offset);
./src/star_formation/GEAR/star_formation.h:
  274 :   sp->gpart->x[0] = sp->x[0];
  275 :   sp->gpart->x[1] = sp->x[1];
  276 :   sp->gpart->x[2] = sp->x[2];
  297 :   p->gpart->x[0] = p->x[0];
  298 :   p->gpart->x[1] = p->x[1];
  299 :   p->gpart->x[2] = p->x[2];
  339 :     sp->gpart->mass = mass_star;
  343 :     p->gpart->mass = new_mass_gas;
./src/stars/Basic/stars_csds.h:
   40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
   41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
   42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
./src/stars/GEAR/stars_csds.h:
   42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
   43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
   44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
./src/stars/fof_data:
   19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
   20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
   21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
./src/stars/fof_data.:
   19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
   20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
   21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
./swift-1.0.0/src/black_holes/EAGLE/black_holes.h:
  230 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
  231 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
  232 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
  409 :   bp->gpart->mass += gas_mass;
  437 :   bp->gpart->v_full[0] = bp->v[0];
  438 :   bp->gpart->v_full[1] = bp->v[1];
  439 :   bp->gpart->v_full[2] = bp->v[2];
  506 :   bpi->gpart->mass += bpj->mass;
  522 :   bpi->gpart->v_full[0] = bpi->v[0];
  523 :   bpi->gpart->v_full[1] = bpi->v[1];
  524 :   bpi->gpart->v_full[2] = bpi->v[2];
./swift-1.0.0/src/black_holes/SPIN_JET/black_holes.h:
  268 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
  269 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
  270 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
  465 :   bp->gpart->mass += gas_mass;
  493 :   bp->gpart->v_full[0] = bp->v[0];
  494 :   bp->gpart->v_full[1] = bp->v[1];
  495 :   bp->gpart->v_full[2] = bp->v[2];
  566 :   bpi->gpart->mass += bpj->mass;
  616 :   bpi->gpart->v_full[0] = bpi->v[0];
  617 :   bpi->gpart->v_full[1] = bpi->v[1];
  618 :   bpi->gpart->v_full[2] = bpi->v[2];
./swift-1.0.0/src/cell_convert_part.c:
  228 :       c->stars.parts[i + 1].gpart->id_or_neg_offset--;
  361 :       c->sinks.parts[i + 1].gpart->id_or_neg_offset--;
  489 :     /* Update the gpart->spart links (shift by 1) */
  574 :     p->gpart->time_bin = time_bin_inhibited;
  575 :     p->gpart->id_or_neg_offset = p->id;
  576 :     p->gpart->type = swift_type_dark_matter;
  647 :     sp->gpart->time_bin = time_bin_inhibited;
  648 :     sp->gpart->id_or_neg_offset = sp->id;
  649 :     sp->gpart->type = swift_type_dark_matter;
  686 :     bp->gpart->time_bin = time_bin_inhibited;
  687 :     bp->gpart->id_or_neg_offset = bp->id;
  688 :     bp->gpart->type = swift_type_dark_matter;
  724 :     sink->gpart->time_bin = time_bin_inhibited;
  725 :     sink->gpart->id_or_neg_offset = sink->id;
  726 :     sink->gpart->type = swift_type_dark_matter;
./swift-1.0.0/src/cell_split.c:
  141 :             parts[j].gpart->id_or_neg_offset = -(j + parts_offset);
  148 :           parts[k].gpart->id_or_neg_offset = -(k + parts_offset);
  260 :             sparts[j].gpart->id_or_neg_offset = -(j + sparts_offset);
  266 :           sparts[k].gpart->id_or_neg_offset = -(k + sparts_offset);
  315 :             bparts[j].gpart->id_or_neg_offset = -(j + bparts_offset);
  321 :           bparts[k].gpart->id_or_neg_offset = -(k + bparts_offset);
  370 :             sinks[j].gpart->id_or_neg_offset = -(j + sinks_offset);
  376 :           sinks[k].gpart->id_or_neg_offset = -(k + sinks_offset);
  501 :         parts[i].gpart->id_or_neg_offset = -(i + parts_offset);
  552 :         sparts[i].gpart->id_or_neg_offset = -(i + sparts_offset);
  608 :         sinks[i].gpart->id_or_neg_offset = -(i + sinks_offset);
./swift-1.0.0/src/common_io.c:
 1434 :  * @param vr_data The array of gpart-related VELOCIraptor output.
 1437 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
 1493 :  * @param vr_data The array of gpart-related VELOCIraptor output.
 1496 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
 1552 :  * @param vr_data The array of gpart-related VELOCIraptor output.
 1555 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
./swift-1.0.0/src/engine_redistribute.c:
  363 :             if (parts[k + offset].gpart->id_or_neg_offset > 0)                 \
  365 :           parts[k + offset].gpart->id_or_neg_offset = -count;                  \
  560 :         parts[k].gpart->id_or_neg_offset = -k;
  563 :         parts[nr_parts].gpart->id_or_neg_offset = -nr_parts;
  581 :         s->sparts[k].gpart->id_or_neg_offset = -k;
  584 :         s->sparts[nr_sparts].gpart->id_or_neg_offset = -nr_sparts;
  602 :         s->bparts[k].gpart->id_or_neg_offset = -k;
  605 :         s->bparts[nr_bparts].gpart->id_or_neg_offset = -nr_bparts;
./swift-1.0.0/src/engine_strays.c:
  107 :       s->parts[offset_parts + k].gpart->id_or_neg_offset =
  152 :       s->sparts[offset_sparts + k].gpart->id_or_neg_offset =
  195 :       s->bparts[offset_bparts + k].gpart->id_or_neg_offset =
  318 :         s->parts[k].gpart->id_or_neg_offset = -k;
  336 :         s->sparts[k].gpart->id_or_neg_offset = -k;
  354 :         s->bparts[k].gpart->id_or_neg_offset = -k;
./swift-1.0.0/src/feedback/KIARA/feedback.h:
  321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  349 :       sp->gpart->fof_data.group_stellar_mass;
  355 :       sp->gpart->fof_data.group_mass;
./swift-1.0.0/src/feedback/KIARA/feedback_iact.h:
  198 :     pj->gpart->a_grav[1] * pj->gpart->v_full[2] -
  199 :         pj->gpart->a_grav[2] * pj->gpart->v_full[1],
  200 :     pj->gpart->a_grav[2] * pj->gpart->v_full[0] -
  201 :         pj->gpart->a_grav[0] * pj->gpart->v_full[2],
  202 :     pj->gpart->a_grav[0] * pj->gpart->v_full[1] -
  203 :         pj->gpart->a_grav[1] * pj->gpart->v_full[0]
  232 :       pj->gpart->fof_data.group_stellar_mass;
./swift-1.0.0/src/fof_io.h:
   31 :   ret[0] = p->gpart->fof_data.group_id;
   37 :   ret[0] = sp->gpart->fof_data.group_id;
   43 :   ret[0] = bp->gpart->fof_data.group_id;
./swift-1.0.0/src/hydro/AnarchyPU/hydro_io.h:
  136 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  137 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  138 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  143 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  144 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  145 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./swift-1.0.0/src/hydro/Gadget2/hydro_csds.h:
   54 :     acc[0] += p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
   55 :     acc[1] += p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
   56 :     acc[2] += p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
./swift-1.0.0/src/hydro/Gadget2/hydro_io.h:
  127 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  128 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  129 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  134 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  135 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  136 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./swift-1.0.0/src/hydro/Gasoline/hydro_io.h:
  138 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  139 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  140 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  145 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  146 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  147 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./swift-1.0.0/src/hydro/Gizmo/MFM/hydro_velocities.h:
   98 :     p->gpart->v_full[0] = p->v_full[0];
   99 :     p->gpart->v_full[1] = p->v_full[1];
  100 :     p->gpart->v_full[2] = p->v_full[2];
./swift-1.0.0/src/hydro/Gizmo/MFV/hydro_flux.h:
  254 :     p->gpart->mass = p->conserved.mass;
./swift-1.0.0/src/hydro/Gizmo/MFV/hydro_velocities.h:
  149 :     p->gpart->v_full[0] = p->v[0];
  150 :     p->gpart->v_full[1] = p->v[1];
  151 :     p->gpart->v_full[2] = p->v[2];
./swift-1.0.0/src/hydro/Gizmo/hydro.h:
  696 :     a_grav[0] = p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  697 :     a_grav[1] = p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  698 :     a_grav[2] = p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  700 :     grav_kick_factor[0] = dt_grav * p->gpart->a_grav[0];
  701 :     grav_kick_factor[1] = dt_grav * p->gpart->a_grav[1];
  702 :     grav_kick_factor[2] = dt_grav * p->gpart->a_grav[2];
  704 :       grav_kick_factor[0] += dt_grav_mesh * p->gpart->a_grav_mesh[0];
  705 :       grav_kick_factor[1] += dt_grav_mesh * p->gpart->a_grav_mesh[1];
  706 :       grav_kick_factor[2] += dt_grav_mesh * p->gpart->a_grav_mesh[2];
./swift-1.0.0/src/hydro/Gizmo/hydro_getters.h:
  310 :     v[0] += p->gpart->a_grav[0] * dt_kick_grav;
  311 :     v[1] += p->gpart->a_grav[1] * dt_kick_grav;
  312 :     v[2] += p->gpart->a_grav[2] * dt_kick_grav;
./swift-1.0.0/src/hydro/Minimal/hydro_io.h:
  141 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  142 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  143 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  148 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  149 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  150 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./swift-1.0.0/src/hydro/Phantom/hydro_io.h:
  137 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  138 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  139 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  144 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  145 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  146 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./swift-1.0.0/src/hydro/PressureEnergy/hydro_io.h:
  138 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  139 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  140 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  145 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  146 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  147 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./swift-1.0.0/src/hydro/PressureEnergyMorrisMonaghanAV/hydro_io.h:
  139 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  140 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  141 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  146 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  147 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  148 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./swift-1.0.0/src/hydro/PressureEntropy/hydro_io.h:
  139 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  140 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  141 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  146 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  147 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  148 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./swift-1.0.0/src/hydro/SPHENIX/hydro_csds.h:
   54 :     acc[0] += p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
   55 :     acc[1] += p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
   56 :     acc[2] += p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
./swift-1.0.0/src/hydro/SPHENIX/hydro_io.h:
  134 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  135 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  136 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  141 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  142 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  143 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./swift-1.0.0/src/hydro/Shadowswift/hydro.h:
  551 :     p->gpart->v_full[0] = p->v[0];
  552 :     p->gpart->v_full[1] = p->v[1];
  553 :     p->gpart->v_full[2] = p->v[2];
./swift-1.0.0/src/kick.h:
  250 :     p->v_full[0] += p->gpart->a_grav[0] * dt_kick_grav;
  251 :     p->v_full[1] += p->gpart->a_grav[1] * dt_kick_grav;
  252 :     p->v_full[2] += p->gpart->a_grav[2] * dt_kick_grav;
  257 :     p->v_full[0] += p->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  258 :     p->v_full[1] += p->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  259 :     p->v_full[2] += p->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  264 :     p->gpart->v_full[0] = p->v_full[0];
  265 :     p->gpart->v_full[1] = p->v_full[1];
  266 :     p->gpart->v_full[2] = p->v_full[2];
  321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
  322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
  323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
  326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  331 :   sp->gpart->v_full[0] = sp->v[0];
  332 :   sp->gpart->v_full[1] = sp->v[1];
  333 :   sp->gpart->v_full[2] = sp->v[2];
  378 :   bp->v[0] += bp->gpart->a_grav[0] * dt_kick_grav;
  379 :   bp->v[1] += bp->gpart->a_grav[1] * dt_kick_grav;
  380 :   bp->v[2] += bp->gpart->a_grav[2] * dt_kick_grav;
  383 :   bp->v[0] += bp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  384 :   bp->v[1] += bp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  385 :   bp->v[2] += bp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  388 :   bp->gpart->v_full[0] = bp->v[0];
  389 :   bp->gpart->v_full[1] = bp->v[1];
  390 :   bp->gpart->v_full[2] = bp->v[2];
  437 :   sink->v[0] += sink->gpart->a_grav[0] * dt_kick_grav;
  438 :   sink->v[1] += sink->gpart->a_grav[1] * dt_kick_grav;
  439 :   sink->v[2] += sink->gpart->a_grav[2] * dt_kick_grav;
  442 :   sink->v[0] += sink->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  443 :   sink->v[1] += sink->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  444 :   sink->v[2] += sink->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  447 :   sink->gpart->v_full[0] = sink->v[0];
  448 :   sink->gpart->v_full[1] = sink->v[1];
  449 :   sink->gpart->v_full[2] = sink->v[2];
./swift-1.0.0/src/part.c:
   47 :       parts[k].gpart->id_or_neg_offset = -(k + offset);
   63 :       sparts[k].gpart->id_or_neg_offset = -(k + offset);
   79 :       sinks[k].gpart->id_or_neg_offset = -(k + offset);
   95 :       bparts[k].gpart->id_or_neg_offset = -(k + offset);
  433 :       if (parts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  438 :       if (parts[k].x[0] != parts[k].gpart->x[0] ||
  439 :           parts[k].x[1] != parts[k].gpart->x[1] ||
  440 :           parts[k].x[2] != parts[k].gpart->x[2])
  444 :       if (hydro_get_mass(&parts[k]) != parts[k].gpart->mass)
  448 :       if (parts[k].time_bin != parts[k].gpart->time_bin)
  460 :       if (sparts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  465 :       if (sparts[k].x[0] != sparts[k].gpart->x[0] ||
  466 :           sparts[k].x[1] != sparts[k].gpart->x[1] ||
  467 :           sparts[k].x[2] != sparts[k].gpart->x[2])
  471 :       if (sparts[k].mass != sparts[k].gpart->mass)
  475 :       if (sparts[k].time_bin != sparts[k].gpart->time_bin)
  487 :       if (bparts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  492 :       if (bparts[k].x[0] != bparts[k].gpart->x[0] ||
  493 :           bparts[k].x[1] != bparts[k].gpart->x[1] ||
  494 :           bparts[k].x[2] != bparts[k].gpart->x[2])
  498 :       if (bparts[k].mass != bparts[k].gpart->mass)
  502 :       if (bparts[k].time_bin != bparts[k].gpart->time_bin)
  514 :       if (sinks[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  519 :       if (sinks[k].x[0] != sinks[k].gpart->x[0] ||
  520 :           sinks[k].x[1] != sinks[k].gpart->x[1] ||
  521 :           sinks[k].x[2] != sinks[k].gpart->x[2])
  525 :       if (sinks[k].mass != sinks[k].gpart->mass)
  529 :       if (sinks[k].time_bin != sinks[k].gpart->time_bin)
./swift-1.0.0/src/runner_black_holes.c:
  108 :         p->gpart->mass = hydro_get_mass(p);
  339 :         cell_bp->gpart->mass = cell_bp->mass;
  340 :         cell_bp->gpart->v_full[0] = cell_bp->v[0];
  341 :         cell_bp->gpart->v_full[1] = cell_bp->v[1];
  342 :         cell_bp->gpart->v_full[2] = cell_bp->v[2];
./swift-1.0.0/src/runner_time_integration.c:
  187 :           xp->a_grav[0] = p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  188 :           xp->a_grav[1] = p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  189 :           xp->a_grav[2] = p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  747 :         if (p->gpart != NULL) p->gpart->time_bin = p->time_bin;
  934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
 1008 :         sink->gpart->time_bin = get_time_bin(ti_new_step);
 1078 :         bp->gpart->time_bin = get_time_bin(ti_new_step);
 1445 :           p->gpart->time_bin = p->time_bin;
 1597 :         if (p->gpart != NULL) p->gpart->time_bin = new_time_bin;
 1620 :           p->gpart->time_bin = p->time_bin;
./swift-1.0.0/src/sink/GEAR/sink.h:
  251 :   sp->gpart->mass += gas_mass;
  279 :   sp->gpart->v_full[0] = sp->v[0];
  280 :   sp->gpart->v_full[1] = sp->v[1];
  281 :   sp->gpart->v_full[2] = sp->v[2];
  321 :   spi->gpart->mass += spj->mass;
  337 :   spi->gpart->v_full[0] = spi->v[0];
  338 :   spi->gpart->v_full[1] = spi->v[1];
  339 :   spi->gpart->v_full[2] = spi->v[2];
./swift-1.0.0/src/sink/GEAR/sink_iact.h:
   66 :     float potential_i = pi->gpart->potential;
   67 :     float potential_j = pj->gpart->potential;
./swift-1.0.0/src/space.c:
 2239 :       if (parts[k].time_bin != parts[k].gpart->time_bin) {
 2241 :               parts[k].gpart->time_bin);
./swift-1.0.0/src/space_first_init.c:
  150 :     /* Check part->gpart->part linkeage. */
  151 :     if (p[k].gpart && p[k].gpart->id_or_neg_offset != -(k + delta))
  328 :     if (sp[k].gpart && sp[k].gpart->id_or_neg_offset != -(k + delta))
  419 :     if (bp[k].gpart && bp[k].gpart->id_or_neg_offset != -(k + delta))
  485 :     if (sink[k].gpart && sink[k].gpart->id_or_neg_offset != -(k + delta))
./swift-1.0.0/src/space_rebuild.c:
  223 :           s->parts[k].gpart->id_or_neg_offset = -k;
  226 :           s->parts[nr_parts].gpart->id_or_neg_offset = -nr_parts;
  275 :           s->sparts[k].gpart->id_or_neg_offset = -k;
  278 :           s->sparts[nr_sparts].gpart->id_or_neg_offset = -nr_sparts;
  325 :           s->bparts[k].gpart->id_or_neg_offset = -k;
  328 :           s->bparts[nr_bparts].gpart->id_or_neg_offset = -nr_bparts;
  376 :           s->sinks[k].gpart->id_or_neg_offset = -k;
  379 :           s->sinks[nr_sinks].gpart->id_or_neg_offset = -nr_sinks;
./swift-1.0.0/src/space_sort.c:
   76 :           parts[j].gpart->id_or_neg_offset = -(j + parts_offset);
   82 :         parts[k].gpart->id_or_neg_offset = -(k + parts_offset);
  138 :           sparts[j].gpart->id_or_neg_offset = -(j + sparts_offset);
  143 :         sparts[k].gpart->id_or_neg_offset = -(k + sparts_offset);
  199 :           bparts[j].gpart->id_or_neg_offset = -(j + bparts_offset);
  204 :         bparts[k].gpart->id_or_neg_offset = -(k + bparts_offset);
  259 :           sinks[j].gpart->id_or_neg_offset = -(j + sinks_offset);
  264 :         sinks[k].gpart->id_or_neg_offset = -(k + sinks_offset);
./swift-1.0.0/src/star_formation/GEAR/star_formation.h:
  274 :   sp->gpart->x[0] = sp->x[0];
  275 :   sp->gpart->x[1] = sp->x[1];
  276 :   sp->gpart->x[2] = sp->x[2];
  297 :   p->gpart->x[0] = p->x[0];
  298 :   p->gpart->x[1] = p->x[1];
  299 :   p->gpart->x[2] = p->x[2];
  339 :     sp->gpart->mass = mass_star;
  343 :     p->gpart->mass = new_mass_gas;
./swift-1.0.0/src/stars/Basic/stars_csds.h:
   40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
   41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
   42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
./swift-1.0.0/src/stars/GEAR/stars_csds.h:
   42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
   43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
   44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
