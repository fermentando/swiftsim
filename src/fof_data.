./black_holes/EAGLE/black_holes.h:
  230 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
  231 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
  232 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
  409 :   bp->gpart->mass += gas_mass;
  437 :   bp->gpart->v_full[0] = bp->v[0];
  438 :   bp->gpart->v_full[1] = bp->v[1];
  439 :   bp->gpart->v_full[2] = bp->v[2];
  506 :   bpi->gpart->mass += bpj->mass;
  522 :   bpi->gpart->v_full[0] = bpi->v[0];
  523 :   bpi->gpart->v_full[1] = bpi->v[1];
  524 :   bpi->gpart->v_full[2] = bpi->v[2];
./black_holes/SIMBA/black_holes.h:
  229 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
  230 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
  231 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
  410 :   bp->gpart->mass += gas_mass;
  438 :   bp->gpart->v_full[0] = bp->v[0];
  439 :   bp->gpart->v_full[1] = bp->v[1];
  440 :   bp->gpart->v_full[2] = bp->v[2];
  503 :   bpi->gpart->mass += bpj->mass;
  519 :   bpi->gpart->v_full[0] = bpi->v[0];
  520 :   bpi->gpart->v_full[1] = bpi->v[1];
  521 :   bpi->gpart->v_full[2] = bpi->v[2];
./black_holes/SPIN_JET/black_holes.h:
  268 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
  269 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
  270 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
  465 :   bp->gpart->mass += gas_mass;
  493 :   bp->gpart->v_full[0] = bp->v[0];
  494 :   bp->gpart->v_full[1] = bp->v[1];
  495 :   bp->gpart->v_full[2] = bp->v[2];
  566 :   bpi->gpart->mass += bpj->mass;
  616 :   bpi->gpart->v_full[0] = bpi->v[0];
  617 :   bpi->gpart->v_full[1] = bpi->v[1];
  618 :   bpi->gpart->v_full[2] = bpi->v[2];
./cell_convert_part.c:
  228 :       c->stars.parts[i + 1].gpart->id_or_neg_offset--;
  361 :       c->sinks.parts[i + 1].gpart->id_or_neg_offset--;
  489 :     /* Update the gpart->spart links (shift by 1) */
  574 :     p->gpart->time_bin = time_bin_inhibited;
  575 :     p->gpart->id_or_neg_offset = p->id;
  576 :     p->gpart->type = swift_type_dark_matter;
  647 :     sp->gpart->time_bin = time_bin_inhibited;
  648 :     sp->gpart->id_or_neg_offset = sp->id;
  649 :     sp->gpart->type = swift_type_dark_matter;
  686 :     bp->gpart->time_bin = time_bin_inhibited;
  687 :     bp->gpart->id_or_neg_offset = bp->id;
  688 :     bp->gpart->type = swift_type_dark_matter;
  724 :     sink->gpart->time_bin = time_bin_inhibited;
  725 :     sink->gpart->id_or_neg_offset = sink->id;
  726 :     sink->gpart->type = swift_type_dark_matter;
./cell_split.c:
  141 :             parts[j].gpart->id_or_neg_offset = -(j + parts_offset);
  148 :           parts[k].gpart->id_or_neg_offset = -(k + parts_offset);
  260 :             sparts[j].gpart->id_or_neg_offset = -(j + sparts_offset);
  266 :           sparts[k].gpart->id_or_neg_offset = -(k + sparts_offset);
  315 :             bparts[j].gpart->id_or_neg_offset = -(j + bparts_offset);
  321 :           bparts[k].gpart->id_or_neg_offset = -(k + bparts_offset);
  370 :             sinks[j].gpart->id_or_neg_offset = -(j + sinks_offset);
  376 :           sinks[k].gpart->id_or_neg_offset = -(k + sinks_offset);
  501 :         parts[i].gpart->id_or_neg_offset = -(i + parts_offset);
  552 :         sparts[i].gpart->id_or_neg_offset = -(i + sparts_offset);
  608 :         sinks[i].gpart->id_or_neg_offset = -(i + sinks_offset);
./common_io.c:
 1434 :  * @param vr_data The array of gpart-related VELOCIraptor output.
 1437 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
 1493 :  * @param vr_data The array of gpart-related VELOCIraptor output.
 1496 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
 1552 :  * @param vr_data The array of gpart-related VELOCIraptor output.
 1555 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
./engine_redistribute.c:
  363 :             if (parts[k + offset].gpart->id_or_neg_offset > 0)                 \
  365 :           parts[k + offset].gpart->id_or_neg_offset = -count;                  \
  560 :         parts[k].gpart->id_or_neg_offset = -k;
  563 :         parts[nr_parts].gpart->id_or_neg_offset = -nr_parts;
  581 :         s->sparts[k].gpart->id_or_neg_offset = -k;
  584 :         s->sparts[nr_sparts].gpart->id_or_neg_offset = -nr_sparts;
  602 :         s->bparts[k].gpart->id_or_neg_offset = -k;
  605 :         s->bparts[nr_bparts].gpart->id_or_neg_offset = -nr_bparts;
./engine_strays.c:
  107 :       s->parts[offset_parts + k].gpart->id_or_neg_offset =
  152 :       s->sparts[offset_sparts + k].gpart->id_or_neg_offset =
  195 :       s->bparts[offset_bparts + k].gpart->id_or_neg_offset =
  318 :         s->parts[k].gpart->id_or_neg_offset = -k;
  336 :         s->sparts[k].gpart->id_or_neg_offset = -k;
  354 :         s->bparts[k].gpart->id_or_neg_offset = -k;
./feedback/KIARA/feedback.h:
  321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  349 :       sp->gpart->fof_data.group_stellar_mass;
  355 :       sp->gpart->fof_data.group_mass;
./feedback/KIARA/feedback_iact.h:
  198 :     pj->gpart->a_grav[1] * pj->gpart->v_full[2] -
  199 :         pj->gpart->a_grav[2] * pj->gpart->v_full[1],
  200 :     pj->gpart->a_grav[2] * pj->gpart->v_full[0] -
  201 :         pj->gpart->a_grav[0] * pj->gpart->v_full[2],
  202 :     pj->gpart->a_grav[0] * pj->gpart->v_full[1] -
  203 :         pj->gpart->a_grav[1] * pj->gpart->v_full[0]
  232 :       pj->gpart->fof_data.group_stellar_mass;
  658 :       pow(pi->gpart->fof_data.group_stellar_mass / 102.329, 0.26178) *
  662 :   if (pi->gpart->fof_data.group_stellar_mass==0.f) warning("Wind particle is not linked to any galaxy");
  678 :       phys_const->const_newton_G*pi->gpart->fof_data.group_mass *
./feedback/SIMBA/feedback.c:
   63 :   double galaxy_stellar_mass = p->gpart->fof_data.group_stellar_mass;
  145 :       p->gpart->fof_data.group_stellar_mass;
  151 :       p->gpart->fof_data.group_mass * fb_props->mass_to_solar_mass;
  235 :     p->gpart->a_grav[1] * p->gpart->v_full[2] - 
  236 :         p->gpart->a_grav[2] * p->gpart->v_full[1],
  237 :     p->gpart->a_grav[2] * p->gpart->v_full[0] - 
  238 :         p->gpart->a_grav[0] * p->gpart->v_full[2],
  239 :     p->gpart->a_grav[0] * p->gpart->v_full[1] - 
  240 :         p->gpart->a_grav[1] * p->gpart->v_full[0]
  272 :   p->gpart->fof_data.is_grouppable = 0;
./fof.c:
 2435 :       bp->gpart->fof_data.is_grouppable = 1;
 3603 :     p->gpart->fof_data.is_grouppable = 0;
 3619 :     p->gpart->fof_data.is_grouppable = 1;
 3621 :     p->gpart->fof_data.is_grouppable = 0;
 3625 :   p->gpart->fof_data.part_sfr = max(p->sf_data.SFR, 0.f);
 3629 :   sp->gpart->fof_data.is_grouppable = 1;
 3636 :   return gpart->fof_data.is_grouppable;
./fof_data:
    2 :   230 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
    3 :   231 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
    4 :   232 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
    5 :   409 :   bp->gpart->mass += gas_mass;
    6 :   437 :   bp->gpart->v_full[0] = bp->v[0];
    7 :   438 :   bp->gpart->v_full[1] = bp->v[1];
    8 :   439 :   bp->gpart->v_full[2] = bp->v[2];
    9 :   506 :   bpi->gpart->mass += bpj->mass;
   10 :   522 :   bpi->gpart->v_full[0] = bpi->v[0];
   11 :   523 :   bpi->gpart->v_full[1] = bpi->v[1];
   12 :   524 :   bpi->gpart->v_full[2] = bpi->v[2];
   14 :   229 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
   15 :   230 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
   16 :   231 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
   17 :   410 :   bp->gpart->mass += gas_mass;
   18 :   438 :   bp->gpart->v_full[0] = bp->v[0];
   19 :   439 :   bp->gpart->v_full[1] = bp->v[1];
   20 :   440 :   bp->gpart->v_full[2] = bp->v[2];
   21 :   503 :   bpi->gpart->mass += bpj->mass;
   22 :   519 :   bpi->gpart->v_full[0] = bpi->v[0];
   23 :   520 :   bpi->gpart->v_full[1] = bpi->v[1];
   24 :   521 :   bpi->gpart->v_full[2] = bpi->v[2];
   26 :   268 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
   27 :   269 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
   28 :   270 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
   29 :   465 :   bp->gpart->mass += gas_mass;
   30 :   493 :   bp->gpart->v_full[0] = bp->v[0];
   31 :   494 :   bp->gpart->v_full[1] = bp->v[1];
   32 :   495 :   bp->gpart->v_full[2] = bp->v[2];
   33 :   566 :   bpi->gpart->mass += bpj->mass;
   34 :   616 :   bpi->gpart->v_full[0] = bpi->v[0];
   35 :   617 :   bpi->gpart->v_full[1] = bpi->v[1];
   36 :   618 :   bpi->gpart->v_full[2] = bpi->v[2];
   38 :   228 :       c->stars.parts[i + 1].gpart->id_or_neg_offset--;
   39 :   361 :       c->sinks.parts[i + 1].gpart->id_or_neg_offset--;
   40 :   489 :     /* Update the gpart->spart links (shift by 1) */
   41 :   574 :     p->gpart->time_bin = time_bin_inhibited;
   42 :   575 :     p->gpart->id_or_neg_offset = p->id;
   43 :   576 :     p->gpart->type = swift_type_dark_matter;
   44 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
   45 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
   46 :   649 :     sp->gpart->type = swift_type_dark_matter;
   47 :   686 :     bp->gpart->time_bin = time_bin_inhibited;
   48 :   687 :     bp->gpart->id_or_neg_offset = bp->id;
   49 :   688 :     bp->gpart->type = swift_type_dark_matter;
   50 :   724 :     sink->gpart->time_bin = time_bin_inhibited;
   51 :   725 :     sink->gpart->id_or_neg_offset = sink->id;
   52 :   726 :     sink->gpart->type = swift_type_dark_matter;
   54 :   141 :             parts[j].gpart->id_or_neg_offset = -(j + parts_offset);
   55 :   148 :           parts[k].gpart->id_or_neg_offset = -(k + parts_offset);
   56 :   260 :             sparts[j].gpart->id_or_neg_offset = -(j + sparts_offset);
   57 :   266 :           sparts[k].gpart->id_or_neg_offset = -(k + sparts_offset);
   58 :   315 :             bparts[j].gpart->id_or_neg_offset = -(j + bparts_offset);
   59 :   321 :           bparts[k].gpart->id_or_neg_offset = -(k + bparts_offset);
   60 :   370 :             sinks[j].gpart->id_or_neg_offset = -(j + sinks_offset);
   61 :   376 :           sinks[k].gpart->id_or_neg_offset = -(k + sinks_offset);
   62 :   501 :         parts[i].gpart->id_or_neg_offset = -(i + parts_offset);
   63 :   552 :         sparts[i].gpart->id_or_neg_offset = -(i + sparts_offset);
   64 :   608 :         sinks[i].gpart->id_or_neg_offset = -(i + sinks_offset);
   66 :  1434 :  * @param vr_data The array of gpart-related VELOCIraptor output.
   67 :  1437 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
   68 :  1493 :  * @param vr_data The array of gpart-related VELOCIraptor output.
   69 :  1496 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
   70 :  1552 :  * @param vr_data The array of gpart-related VELOCIraptor output.
   71 :  1555 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
   73 :   363 :             if (parts[k + offset].gpart->id_or_neg_offset > 0)                 \
   74 :   365 :           parts[k + offset].gpart->id_or_neg_offset = -count;                  \
   75 :   560 :         parts[k].gpart->id_or_neg_offset = -k;
   76 :   563 :         parts[nr_parts].gpart->id_or_neg_offset = -nr_parts;
   77 :   581 :         s->sparts[k].gpart->id_or_neg_offset = -k;
   78 :   584 :         s->sparts[nr_sparts].gpart->id_or_neg_offset = -nr_sparts;
   79 :   602 :         s->bparts[k].gpart->id_or_neg_offset = -k;
   80 :   605 :         s->bparts[nr_bparts].gpart->id_or_neg_offset = -nr_bparts;
   82 :   107 :       s->parts[offset_parts + k].gpart->id_or_neg_offset =
   83 :   152 :       s->sparts[offset_sparts + k].gpart->id_or_neg_offset =
   84 :   195 :       s->bparts[offset_bparts + k].gpart->id_or_neg_offset =
   85 :   318 :         s->parts[k].gpart->id_or_neg_offset = -k;
   86 :   336 :         s->sparts[k].gpart->id_or_neg_offset = -k;
   87 :   354 :         s->bparts[k].gpart->id_or_neg_offset = -k;
   89 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
   90 :   349 :       sp->gpart->fof_data.group_stellar_mass;
   91 :   355 :       sp->gpart->fof_data.group_mass;
   93 :   198 :     pj->gpart->a_grav[1] * pj->gpart->v_full[2] -
   94 :   199 :         pj->gpart->a_grav[2] * pj->gpart->v_full[1],
   95 :   200 :     pj->gpart->a_grav[2] * pj->gpart->v_full[0] -
   96 :   201 :         pj->gpart->a_grav[0] * pj->gpart->v_full[2],
   97 :   202 :     pj->gpart->a_grav[0] * pj->gpart->v_full[1] -
   98 :   203 :         pj->gpart->a_grav[1] * pj->gpart->v_full[0]
   99 :   232 :       pj->gpart->fof_data.group_stellar_mass;
  100 :   658 :       pow(pi->gpart->fof_data.group_stellar_mass / 102.329, 0.26178) *
  101 :   662 :   if (pi->gpart->fof_data.group_stellar_mass==0.f) warning("Wind particle is not linked to any galaxy");
  102 :   678 :       phys_const->const_newton_G*pi->gpart->fof_data.group_mass *
  104 :    63 :   double galaxy_stellar_mass = p->gpart->fof_data.group_stellar_mass;
  105 :   145 :       p->gpart->fof_data.group_stellar_mass;
  106 :   151 :       p->gpart->fof_data.group_mass * fb_props->mass_to_solar_mass;
  107 :   235 :     p->gpart->a_grav[1] * p->gpart->v_full[2] - 
  108 :   236 :         p->gpart->a_grav[2] * p->gpart->v_full[1],
  109 :   237 :     p->gpart->a_grav[2] * p->gpart->v_full[0] - 
  110 :   238 :         p->gpart->a_grav[0] * p->gpart->v_full[2],
  111 :   239 :     p->gpart->a_grav[0] * p->gpart->v_full[1] - 
  112 :   240 :         p->gpart->a_grav[1] * p->gpart->v_full[0]
  113 :   272 :   p->gpart->fof_data.is_grouppable = 0;
  115 :  2435 :       bp->gpart->fof_data.is_grouppable = 1;
  116 :  3603 :     p->gpart->fof_data.is_grouppable = 0;
  117 :  3619 :     p->gpart->fof_data.is_grouppable = 1;
  118 :  3621 :     p->gpart->fof_data.is_grouppable = 0;
  119 :  3625 :   p->gpart->fof_data.part_sfr = max(p->sf_data.SFR, 0.f);
  120 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  121 :  3636 :   return gpart->fof_data.is_grouppable;
  123 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  124 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  125 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
  126 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  127 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  128 :   536 :   355 :       sp->gpart->fof_data.group_mass;
  129 :   670 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  130 :   707 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  131 :   708 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  132 :   709 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
  133 :  1183 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  134 :  1184 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  135 :  1185 :   536 :   355 :       sp->gpart->fof_data.group_mass;
  136 :  1261 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
  137 :  1269 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
  138 :  1270 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
  139 :  1271 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
  140 :  1272 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  141 :  1273 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  142 :  1274 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  143 :  1275 :   331 :   sp->gpart->v_full[0] = sp->v[0];
  144 :  1276 :   332 :   sp->gpart->v_full[1] = sp->v[1];
  145 :  1277 :   333 :   sp->gpart->v_full[2] = sp->v[2];
  146 :  1447 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
  147 :  1490 :   251 :   sp->gpart->mass += gas_mass;
  148 :  1506 :   279 :   sp->gpart->v_full[0] = sp->v[0];
  149 :  1507 :   280 :   sp->gpart->v_full[1] = sp->v[1];
  150 :  1508 :   281 :   sp->gpart->v_full[2] = sp->v[2];
  151 :  1586 :   274 :   sp->gpart->x[0] = sp->x[0];
  152 :  1587 :   275 :   sp->gpart->x[1] = sp->x[1];
  153 :  1588 :   276 :   sp->gpart->x[2] = sp->x[2];
  154 :  1591 :   339 :     sp->gpart->mass = mass_star;
  155 :  1664 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  156 :  1665 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  157 :  1666 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  158 :  1818 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  159 :  1819 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  160 :  1820 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  161 :  1972 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  162 :  1973 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  163 :  1974 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  164 :  2121 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  165 :  2122 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  166 :  2123 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  167 :  2270 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  168 :  2271 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  169 :  2272 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  170 :  2420 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  171 :  2421 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  172 :  2422 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  173 :  2569 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  174 :  2570 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  175 :  2571 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  176 :  2718 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  177 :  2719 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  178 :  2720 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  179 :  2869 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  180 :  2870 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  181 :  2871 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  182 :  3018 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  183 :  3019 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  184 :  3020 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  185 :  3167 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  186 :  3168 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  187 :  3169 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  189 :    31 :   ret[0] = p->gpart->fof_data.group_id;
  190 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
  191 :    43 :   ret[0] = bp->gpart->fof_data.group_id;
  193 :   136 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  194 :   137 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  195 :   138 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  196 :   143 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  197 :   144 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  198 :   145 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  200 :    54 :     acc[0] += p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  201 :    55 :     acc[1] += p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  202 :    56 :     acc[2] += p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  204 :   127 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  205 :   128 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  206 :   129 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  207 :   134 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  208 :   135 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  209 :   136 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  211 :   138 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  212 :   139 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  213 :   140 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  214 :   145 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  215 :   146 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  216 :   147 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  218 :    98 :     p->gpart->v_full[0] = p->v_full[0];
  219 :    99 :     p->gpart->v_full[1] = p->v_full[1];
  220 :   100 :     p->gpart->v_full[2] = p->v_full[2];
  222 :   254 :     p->gpart->mass = p->conserved.mass;
  224 :   149 :     p->gpart->v_full[0] = p->v[0];
  225 :   150 :     p->gpart->v_full[1] = p->v[1];
  226 :   151 :     p->gpart->v_full[2] = p->v[2];
  228 :   696 :     a_grav[0] = p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  229 :   697 :     a_grav[1] = p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  230 :   698 :     a_grav[2] = p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  231 :   700 :     grav_kick_factor[0] = dt_grav * p->gpart->a_grav[0];
  232 :   701 :     grav_kick_factor[1] = dt_grav * p->gpart->a_grav[1];
  233 :   702 :     grav_kick_factor[2] = dt_grav * p->gpart->a_grav[2];
  234 :   704 :       grav_kick_factor[0] += dt_grav_mesh * p->gpart->a_grav_mesh[0];
  235 :   705 :       grav_kick_factor[1] += dt_grav_mesh * p->gpart->a_grav_mesh[1];
  236 :   706 :       grav_kick_factor[2] += dt_grav_mesh * p->gpart->a_grav_mesh[2];
  238 :   310 :     v[0] += p->gpart->a_grav[0] * dt_kick_grav;
  239 :   311 :     v[1] += p->gpart->a_grav[1] * dt_kick_grav;
  240 :   312 :     v[2] += p->gpart->a_grav[2] * dt_kick_grav;
  242 :   141 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  243 :   142 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  244 :   143 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  245 :   148 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  246 :   149 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  247 :   150 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  249 :   137 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  250 :   138 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  251 :   139 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  252 :   144 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  253 :   145 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  254 :   146 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  256 :   152 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  257 :   153 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  258 :   154 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  259 :   159 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  260 :   160 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  261 :   161 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  263 :   138 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  264 :   139 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  265 :   140 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  266 :   145 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  267 :   146 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  268 :   147 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  270 :   139 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  271 :   140 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  272 :   141 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  273 :   146 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  274 :   147 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  275 :   148 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  277 :   139 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  278 :   140 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  279 :   141 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  280 :   146 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  281 :   147 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  282 :   148 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  284 :    54 :     acc[0] += p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  285 :    55 :     acc[1] += p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  286 :    56 :     acc[2] += p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  288 :   134 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  289 :   135 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  290 :   136 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  291 :   141 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  292 :   142 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  293 :   143 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  295 :   551 :     p->gpart->v_full[0] = p->v[0];
  296 :   552 :     p->gpart->v_full[1] = p->v[1];
  297 :   553 :     p->gpart->v_full[2] = p->v[2];
  299 :   250 :     p->v_full[0] += p->gpart->a_grav[0] * dt_kick_grav;
  300 :   251 :     p->v_full[1] += p->gpart->a_grav[1] * dt_kick_grav;
  301 :   252 :     p->v_full[2] += p->gpart->a_grav[2] * dt_kick_grav;
  302 :   257 :     p->v_full[0] += p->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  303 :   258 :     p->v_full[1] += p->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  304 :   259 :     p->v_full[2] += p->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  305 :   264 :     p->gpart->v_full[0] = p->v_full[0];
  306 :   265 :     p->gpart->v_full[1] = p->v_full[1];
  307 :   266 :     p->gpart->v_full[2] = p->v_full[2];
  308 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
  309 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
  310 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
  311 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  312 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  313 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  314 :   331 :   sp->gpart->v_full[0] = sp->v[0];
  315 :   332 :   sp->gpart->v_full[1] = sp->v[1];
  316 :   333 :   sp->gpart->v_full[2] = sp->v[2];
  317 :   378 :   bp->v[0] += bp->gpart->a_grav[0] * dt_kick_grav;
  318 :   379 :   bp->v[1] += bp->gpart->a_grav[1] * dt_kick_grav;
  319 :   380 :   bp->v[2] += bp->gpart->a_grav[2] * dt_kick_grav;
  320 :   383 :   bp->v[0] += bp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  321 :   384 :   bp->v[1] += bp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  322 :   385 :   bp->v[2] += bp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  323 :   388 :   bp->gpart->v_full[0] = bp->v[0];
  324 :   389 :   bp->gpart->v_full[1] = bp->v[1];
  325 :   390 :   bp->gpart->v_full[2] = bp->v[2];
  326 :   437 :   sink->v[0] += sink->gpart->a_grav[0] * dt_kick_grav;
  327 :   438 :   sink->v[1] += sink->gpart->a_grav[1] * dt_kick_grav;
  328 :   439 :   sink->v[2] += sink->gpart->a_grav[2] * dt_kick_grav;
  329 :   442 :   sink->v[0] += sink->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  330 :   443 :   sink->v[1] += sink->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  331 :   444 :   sink->v[2] += sink->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  332 :   447 :   sink->gpart->v_full[0] = sink->v[0];
  333 :   448 :   sink->gpart->v_full[1] = sink->v[1];
  334 :   449 :   sink->gpart->v_full[2] = sink->v[2];
  336 :    47 :       parts[k].gpart->id_or_neg_offset = -(k + offset);
  337 :    63 :       sparts[k].gpart->id_or_neg_offset = -(k + offset);
  338 :    79 :       sinks[k].gpart->id_or_neg_offset = -(k + offset);
  339 :    95 :       bparts[k].gpart->id_or_neg_offset = -(k + offset);
  340 :   433 :       if (parts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  341 :   438 :       if (parts[k].x[0] != parts[k].gpart->x[0] ||
  342 :   439 :           parts[k].x[1] != parts[k].gpart->x[1] ||
  343 :   440 :           parts[k].x[2] != parts[k].gpart->x[2])
  344 :   444 :       if (hydro_get_mass(&parts[k]) != parts[k].gpart->mass)
  345 :   448 :       if (parts[k].time_bin != parts[k].gpart->time_bin)
  346 :   460 :       if (sparts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  347 :   465 :       if (sparts[k].x[0] != sparts[k].gpart->x[0] ||
  348 :   466 :           sparts[k].x[1] != sparts[k].gpart->x[1] ||
  349 :   467 :           sparts[k].x[2] != sparts[k].gpart->x[2])
  350 :   471 :       if (sparts[k].mass != sparts[k].gpart->mass)
  351 :   475 :       if (sparts[k].time_bin != sparts[k].gpart->time_bin)
  352 :   487 :       if (bparts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  353 :   492 :       if (bparts[k].x[0] != bparts[k].gpart->x[0] ||
  354 :   493 :           bparts[k].x[1] != bparts[k].gpart->x[1] ||
  355 :   494 :           bparts[k].x[2] != bparts[k].gpart->x[2])
  356 :   498 :       if (bparts[k].mass != bparts[k].gpart->mass)
  357 :   502 :       if (bparts[k].time_bin != bparts[k].gpart->time_bin)
  358 :   514 :       if (sinks[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  359 :   519 :       if (sinks[k].x[0] != sinks[k].gpart->x[0] ||
  360 :   520 :           sinks[k].x[1] != sinks[k].gpart->x[1] ||
  361 :   521 :           sinks[k].x[2] != sinks[k].gpart->x[2])
  362 :   525 :       if (sinks[k].mass != sinks[k].gpart->mass)
  363 :   529 :       if (sinks[k].time_bin != sinks[k].gpart->time_bin)
  365 :   108 :         p->gpart->mass = hydro_get_mass(p);
  366 :   339 :         cell_bp->gpart->mass = cell_bp->mass;
  367 :   340 :         cell_bp->gpart->v_full[0] = cell_bp->v[0];
  368 :   341 :         cell_bp->gpart->v_full[1] = cell_bp->v[1];
  369 :   342 :         cell_bp->gpart->v_full[2] = cell_bp->v[2];
  371 :   187 :           xp->a_grav[0] = p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  372 :   188 :           xp->a_grav[1] = p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  373 :   189 :           xp->a_grav[2] = p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  374 :   747 :         if (p->gpart != NULL) p->gpart->time_bin = p->time_bin;
  375 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
  376 :  1008 :         sink->gpart->time_bin = get_time_bin(ti_new_step);
  377 :  1078 :         bp->gpart->time_bin = get_time_bin(ti_new_step);
  378 :  1445 :           p->gpart->time_bin = p->time_bin;
  379 :  1597 :         if (p->gpart != NULL) p->gpart->time_bin = new_time_bin;
  380 :  1620 :           p->gpart->time_bin = p->time_bin;
  382 :   251 :   sp->gpart->mass += gas_mass;
  383 :   279 :   sp->gpart->v_full[0] = sp->v[0];
  384 :   280 :   sp->gpart->v_full[1] = sp->v[1];
  385 :   281 :   sp->gpart->v_full[2] = sp->v[2];
  386 :   321 :   spi->gpart->mass += spj->mass;
  387 :   337 :   spi->gpart->v_full[0] = spi->v[0];
  388 :   338 :   spi->gpart->v_full[1] = spi->v[1];
  389 :   339 :   spi->gpart->v_full[2] = spi->v[2];
  391 :    66 :     float potential_i = pi->gpart->potential;
  392 :    67 :     float potential_j = pj->gpart->potential;
  394 :  2239 :       if (parts[k].time_bin != parts[k].gpart->time_bin) {
  395 :  2241 :               parts[k].gpart->time_bin);
  397 :   150 :     /* Check part->gpart->part linkeage. */
  398 :   151 :     if (p[k].gpart && p[k].gpart->id_or_neg_offset != -(k + delta))
  399 :   328 :     if (sp[k].gpart && sp[k].gpart->id_or_neg_offset != -(k + delta))
  400 :   419 :     if (bp[k].gpart && bp[k].gpart->id_or_neg_offset != -(k + delta))
  401 :   485 :     if (sink[k].gpart && sink[k].gpart->id_or_neg_offset != -(k + delta))
  403 :   223 :           s->parts[k].gpart->id_or_neg_offset = -k;
  404 :   226 :           s->parts[nr_parts].gpart->id_or_neg_offset = -nr_parts;
  405 :   275 :           s->sparts[k].gpart->id_or_neg_offset = -k;
  406 :   278 :           s->sparts[nr_sparts].gpart->id_or_neg_offset = -nr_sparts;
  407 :   325 :           s->bparts[k].gpart->id_or_neg_offset = -k;
  408 :   328 :           s->bparts[nr_bparts].gpart->id_or_neg_offset = -nr_bparts;
  409 :   376 :           s->sinks[k].gpart->id_or_neg_offset = -k;
  410 :   379 :           s->sinks[nr_sinks].gpart->id_or_neg_offset = -nr_sinks;
  412 :    76 :           parts[j].gpart->id_or_neg_offset = -(j + parts_offset);
  413 :    82 :         parts[k].gpart->id_or_neg_offset = -(k + parts_offset);
  414 :   138 :           sparts[j].gpart->id_or_neg_offset = -(j + sparts_offset);
  415 :   143 :         sparts[k].gpart->id_or_neg_offset = -(k + sparts_offset);
  416 :   199 :           bparts[j].gpart->id_or_neg_offset = -(j + bparts_offset);
  417 :   204 :         bparts[k].gpart->id_or_neg_offset = -(k + bparts_offset);
  418 :   259 :           sinks[j].gpart->id_or_neg_offset = -(j + sinks_offset);
  419 :   264 :         sinks[k].gpart->id_or_neg_offset = -(k + sinks_offset);
  421 :   274 :   sp->gpart->x[0] = sp->x[0];
  422 :   275 :   sp->gpart->x[1] = sp->x[1];
  423 :   276 :   sp->gpart->x[2] = sp->x[2];
  424 :   297 :   p->gpart->x[0] = p->x[0];
  425 :   298 :   p->gpart->x[1] = p->x[1];
  426 :   299 :   p->gpart->x[2] = p->x[2];
  427 :   339 :     sp->gpart->mass = mass_star;
  428 :   343 :     p->gpart->mass = new_mass_gas;
  430 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  431 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  432 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  434 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  435 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  436 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  438 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  439 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  440 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  441 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  442 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  443 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  444 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  445 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  446 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  447 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  448 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  449 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  450 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  451 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  452 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  453 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  454 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  455 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  457 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  458 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  459 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  460 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  461 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  462 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  463 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  464 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  465 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
./fof_data.:
    2 :   230 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
    3 :   231 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
    4 :   232 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
    5 :   409 :   bp->gpart->mass += gas_mass;
    6 :   437 :   bp->gpart->v_full[0] = bp->v[0];
    7 :   438 :   bp->gpart->v_full[1] = bp->v[1];
    8 :   439 :   bp->gpart->v_full[2] = bp->v[2];
    9 :   506 :   bpi->gpart->mass += bpj->mass;
   10 :   522 :   bpi->gpart->v_full[0] = bpi->v[0];
   11 :   523 :   bpi->gpart->v_full[1] = bpi->v[1];
   12 :   524 :   bpi->gpart->v_full[2] = bpi->v[2];
   14 :   229 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
   15 :   230 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
   16 :   231 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
   17 :   410 :   bp->gpart->mass += gas_mass;
   18 :   438 :   bp->gpart->v_full[0] = bp->v[0];
   19 :   439 :   bp->gpart->v_full[1] = bp->v[1];
   20 :   440 :   bp->gpart->v_full[2] = bp->v[2];
   21 :   503 :   bpi->gpart->mass += bpj->mass;
   22 :   519 :   bpi->gpart->v_full[0] = bpi->v[0];
   23 :   520 :   bpi->gpart->v_full[1] = bpi->v[1];
   24 :   521 :   bpi->gpart->v_full[2] = bpi->v[2];
   26 :   268 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
   27 :   269 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
   28 :   270 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
   29 :   465 :   bp->gpart->mass += gas_mass;
   30 :   493 :   bp->gpart->v_full[0] = bp->v[0];
   31 :   494 :   bp->gpart->v_full[1] = bp->v[1];
   32 :   495 :   bp->gpart->v_full[2] = bp->v[2];
   33 :   566 :   bpi->gpart->mass += bpj->mass;
   34 :   616 :   bpi->gpart->v_full[0] = bpi->v[0];
   35 :   617 :   bpi->gpart->v_full[1] = bpi->v[1];
   36 :   618 :   bpi->gpart->v_full[2] = bpi->v[2];
   38 :   228 :       c->stars.parts[i + 1].gpart->id_or_neg_offset--;
   39 :   361 :       c->sinks.parts[i + 1].gpart->id_or_neg_offset--;
   40 :   489 :     /* Update the gpart->spart links (shift by 1) */
   41 :   574 :     p->gpart->time_bin = time_bin_inhibited;
   42 :   575 :     p->gpart->id_or_neg_offset = p->id;
   43 :   576 :     p->gpart->type = swift_type_dark_matter;
   44 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
   45 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
   46 :   649 :     sp->gpart->type = swift_type_dark_matter;
   47 :   686 :     bp->gpart->time_bin = time_bin_inhibited;
   48 :   687 :     bp->gpart->id_or_neg_offset = bp->id;
   49 :   688 :     bp->gpart->type = swift_type_dark_matter;
   50 :   724 :     sink->gpart->time_bin = time_bin_inhibited;
   51 :   725 :     sink->gpart->id_or_neg_offset = sink->id;
   52 :   726 :     sink->gpart->type = swift_type_dark_matter;
   54 :   141 :             parts[j].gpart->id_or_neg_offset = -(j + parts_offset);
   55 :   148 :           parts[k].gpart->id_or_neg_offset = -(k + parts_offset);
   56 :   260 :             sparts[j].gpart->id_or_neg_offset = -(j + sparts_offset);
   57 :   266 :           sparts[k].gpart->id_or_neg_offset = -(k + sparts_offset);
   58 :   315 :             bparts[j].gpart->id_or_neg_offset = -(j + bparts_offset);
   59 :   321 :           bparts[k].gpart->id_or_neg_offset = -(k + bparts_offset);
   60 :   370 :             sinks[j].gpart->id_or_neg_offset = -(j + sinks_offset);
   61 :   376 :           sinks[k].gpart->id_or_neg_offset = -(k + sinks_offset);
   62 :   501 :         parts[i].gpart->id_or_neg_offset = -(i + parts_offset);
   63 :   552 :         sparts[i].gpart->id_or_neg_offset = -(i + sparts_offset);
   64 :   608 :         sinks[i].gpart->id_or_neg_offset = -(i + sinks_offset);
   66 :  1434 :  * @param vr_data The array of gpart-related VELOCIraptor output.
   67 :  1437 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
   68 :  1493 :  * @param vr_data The array of gpart-related VELOCIraptor output.
   69 :  1496 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
   70 :  1552 :  * @param vr_data The array of gpart-related VELOCIraptor output.
   71 :  1555 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
   73 :   363 :             if (parts[k + offset].gpart->id_or_neg_offset > 0)                 \
   74 :   365 :           parts[k + offset].gpart->id_or_neg_offset = -count;                  \
   75 :   560 :         parts[k].gpart->id_or_neg_offset = -k;
   76 :   563 :         parts[nr_parts].gpart->id_or_neg_offset = -nr_parts;
   77 :   581 :         s->sparts[k].gpart->id_or_neg_offset = -k;
   78 :   584 :         s->sparts[nr_sparts].gpart->id_or_neg_offset = -nr_sparts;
   79 :   602 :         s->bparts[k].gpart->id_or_neg_offset = -k;
   80 :   605 :         s->bparts[nr_bparts].gpart->id_or_neg_offset = -nr_bparts;
   82 :   107 :       s->parts[offset_parts + k].gpart->id_or_neg_offset =
   83 :   152 :       s->sparts[offset_sparts + k].gpart->id_or_neg_offset =
   84 :   195 :       s->bparts[offset_bparts + k].gpart->id_or_neg_offset =
   85 :   318 :         s->parts[k].gpart->id_or_neg_offset = -k;
   86 :   336 :         s->sparts[k].gpart->id_or_neg_offset = -k;
   87 :   354 :         s->bparts[k].gpart->id_or_neg_offset = -k;
   89 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
   90 :   349 :       sp->gpart->fof_data.group_stellar_mass;
   91 :   355 :       sp->gpart->fof_data.group_mass;
   93 :   198 :     pj->gpart->a_grav[1] * pj->gpart->v_full[2] -
   94 :   199 :         pj->gpart->a_grav[2] * pj->gpart->v_full[1],
   95 :   200 :     pj->gpart->a_grav[2] * pj->gpart->v_full[0] -
   96 :   201 :         pj->gpart->a_grav[0] * pj->gpart->v_full[2],
   97 :   202 :     pj->gpart->a_grav[0] * pj->gpart->v_full[1] -
   98 :   203 :         pj->gpart->a_grav[1] * pj->gpart->v_full[0]
   99 :   232 :       pj->gpart->fof_data.group_stellar_mass;
  100 :   658 :       pow(pi->gpart->fof_data.group_stellar_mass / 102.329, 0.26178) *
  101 :   662 :   if (pi->gpart->fof_data.group_stellar_mass==0.f) warning("Wind particle is not linked to any galaxy");
  102 :   678 :       phys_const->const_newton_G*pi->gpart->fof_data.group_mass *
  104 :    63 :   double galaxy_stellar_mass = p->gpart->fof_data.group_stellar_mass;
  105 :   145 :       p->gpart->fof_data.group_stellar_mass;
  106 :   151 :       p->gpart->fof_data.group_mass * fb_props->mass_to_solar_mass;
  107 :   235 :     p->gpart->a_grav[1] * p->gpart->v_full[2] - 
  108 :   236 :         p->gpart->a_grav[2] * p->gpart->v_full[1],
  109 :   237 :     p->gpart->a_grav[2] * p->gpart->v_full[0] - 
  110 :   238 :         p->gpart->a_grav[0] * p->gpart->v_full[2],
  111 :   239 :     p->gpart->a_grav[0] * p->gpart->v_full[1] - 
  112 :   240 :         p->gpart->a_grav[1] * p->gpart->v_full[0]
  113 :   272 :   p->gpart->fof_data.is_grouppable = 0;
  115 :  2435 :       bp->gpart->fof_data.is_grouppable = 1;
  116 :  3603 :     p->gpart->fof_data.is_grouppable = 0;
  117 :  3619 :     p->gpart->fof_data.is_grouppable = 1;
  118 :  3621 :     p->gpart->fof_data.is_grouppable = 0;
  119 :  3625 :   p->gpart->fof_data.part_sfr = max(p->sf_data.SFR, 0.f);
  120 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  121 :  3636 :   return gpart->fof_data.is_grouppable;
  123 :     2 :   230 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
  124 :     3 :   231 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
  125 :     4 :   232 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
  126 :     5 :   409 :   bp->gpart->mass += gas_mass;
  127 :     6 :   437 :   bp->gpart->v_full[0] = bp->v[0];
  128 :     7 :   438 :   bp->gpart->v_full[1] = bp->v[1];
  129 :     8 :   439 :   bp->gpart->v_full[2] = bp->v[2];
  130 :     9 :   506 :   bpi->gpart->mass += bpj->mass;
  131 :    10 :   522 :   bpi->gpart->v_full[0] = bpi->v[0];
  132 :    11 :   523 :   bpi->gpart->v_full[1] = bpi->v[1];
  133 :    12 :   524 :   bpi->gpart->v_full[2] = bpi->v[2];
  134 :    14 :   229 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
  135 :    15 :   230 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
  136 :    16 :   231 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
  137 :    17 :   410 :   bp->gpart->mass += gas_mass;
  138 :    18 :   438 :   bp->gpart->v_full[0] = bp->v[0];
  139 :    19 :   439 :   bp->gpart->v_full[1] = bp->v[1];
  140 :    20 :   440 :   bp->gpart->v_full[2] = bp->v[2];
  141 :    21 :   503 :   bpi->gpart->mass += bpj->mass;
  142 :    22 :   519 :   bpi->gpart->v_full[0] = bpi->v[0];
  143 :    23 :   520 :   bpi->gpart->v_full[1] = bpi->v[1];
  144 :    24 :   521 :   bpi->gpart->v_full[2] = bpi->v[2];
  145 :    26 :   268 :     bp->gpart->x[0] += bp->reposition.delta_x[0];
  146 :    27 :   269 :     bp->gpart->x[1] += bp->reposition.delta_x[1];
  147 :    28 :   270 :     bp->gpart->x[2] += bp->reposition.delta_x[2];
  148 :    29 :   465 :   bp->gpart->mass += gas_mass;
  149 :    30 :   493 :   bp->gpart->v_full[0] = bp->v[0];
  150 :    31 :   494 :   bp->gpart->v_full[1] = bp->v[1];
  151 :    32 :   495 :   bp->gpart->v_full[2] = bp->v[2];
  152 :    33 :   566 :   bpi->gpart->mass += bpj->mass;
  153 :    34 :   616 :   bpi->gpart->v_full[0] = bpi->v[0];
  154 :    35 :   617 :   bpi->gpart->v_full[1] = bpi->v[1];
  155 :    36 :   618 :   bpi->gpart->v_full[2] = bpi->v[2];
  156 :    38 :   228 :       c->stars.parts[i + 1].gpart->id_or_neg_offset--;
  157 :    39 :   361 :       c->sinks.parts[i + 1].gpart->id_or_neg_offset--;
  158 :    40 :   489 :     /* Update the gpart->spart links (shift by 1) */
  159 :    41 :   574 :     p->gpart->time_bin = time_bin_inhibited;
  160 :    42 :   575 :     p->gpart->id_or_neg_offset = p->id;
  161 :    43 :   576 :     p->gpart->type = swift_type_dark_matter;
  162 :    44 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  163 :    45 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  164 :    46 :   649 :     sp->gpart->type = swift_type_dark_matter;
  165 :    47 :   686 :     bp->gpart->time_bin = time_bin_inhibited;
  166 :    48 :   687 :     bp->gpart->id_or_neg_offset = bp->id;
  167 :    49 :   688 :     bp->gpart->type = swift_type_dark_matter;
  168 :    50 :   724 :     sink->gpart->time_bin = time_bin_inhibited;
  169 :    51 :   725 :     sink->gpart->id_or_neg_offset = sink->id;
  170 :    52 :   726 :     sink->gpart->type = swift_type_dark_matter;
  171 :    54 :   141 :             parts[j].gpart->id_or_neg_offset = -(j + parts_offset);
  172 :    55 :   148 :           parts[k].gpart->id_or_neg_offset = -(k + parts_offset);
  173 :    56 :   260 :             sparts[j].gpart->id_or_neg_offset = -(j + sparts_offset);
  174 :    57 :   266 :           sparts[k].gpart->id_or_neg_offset = -(k + sparts_offset);
  175 :    58 :   315 :             bparts[j].gpart->id_or_neg_offset = -(j + bparts_offset);
  176 :    59 :   321 :           bparts[k].gpart->id_or_neg_offset = -(k + bparts_offset);
  177 :    60 :   370 :             sinks[j].gpart->id_or_neg_offset = -(j + sinks_offset);
  178 :    61 :   376 :           sinks[k].gpart->id_or_neg_offset = -(k + sinks_offset);
  179 :    62 :   501 :         parts[i].gpart->id_or_neg_offset = -(i + parts_offset);
  180 :    63 :   552 :         sparts[i].gpart->id_or_neg_offset = -(i + sparts_offset);
  181 :    64 :   608 :         sinks[i].gpart->id_or_neg_offset = -(i + sinks_offset);
  182 :    66 :  1434 :  * @param vr_data The array of gpart-related VELOCIraptor output.
  183 :    67 :  1437 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
  184 :    68 :  1493 :  * @param vr_data The array of gpart-related VELOCIraptor output.
  185 :    69 :  1496 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
  186 :    70 :  1552 :  * @param vr_data The array of gpart-related VELOCIraptor output.
  187 :    71 :  1555 :  * @param vr_data_written The array of gpart-related VELOCIraptor with particles
  188 :    73 :   363 :             if (parts[k + offset].gpart->id_or_neg_offset > 0)                 \
  189 :    74 :   365 :           parts[k + offset].gpart->id_or_neg_offset = -count;                  \
  190 :    75 :   560 :         parts[k].gpart->id_or_neg_offset = -k;
  191 :    76 :   563 :         parts[nr_parts].gpart->id_or_neg_offset = -nr_parts;
  192 :    77 :   581 :         s->sparts[k].gpart->id_or_neg_offset = -k;
  193 :    78 :   584 :         s->sparts[nr_sparts].gpart->id_or_neg_offset = -nr_sparts;
  194 :    79 :   602 :         s->bparts[k].gpart->id_or_neg_offset = -k;
  195 :    80 :   605 :         s->bparts[nr_bparts].gpart->id_or_neg_offset = -nr_bparts;
  196 :    82 :   107 :       s->parts[offset_parts + k].gpart->id_or_neg_offset =
  197 :    83 :   152 :       s->sparts[offset_sparts + k].gpart->id_or_neg_offset =
  198 :    84 :   195 :       s->bparts[offset_bparts + k].gpart->id_or_neg_offset =
  199 :    85 :   318 :         s->parts[k].gpart->id_or_neg_offset = -k;
  200 :    86 :   336 :         s->sparts[k].gpart->id_or_neg_offset = -k;
  201 :    87 :   354 :         s->bparts[k].gpart->id_or_neg_offset = -k;
  202 :    89 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  203 :    90 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  204 :    91 :   355 :       sp->gpart->fof_data.group_mass;
  205 :    93 :   198 :     pj->gpart->a_grav[1] * pj->gpart->v_full[2] -
  206 :    94 :   199 :         pj->gpart->a_grav[2] * pj->gpart->v_full[1],
  207 :    95 :   200 :     pj->gpart->a_grav[2] * pj->gpart->v_full[0] -
  208 :    96 :   201 :         pj->gpart->a_grav[0] * pj->gpart->v_full[2],
  209 :    97 :   202 :     pj->gpart->a_grav[0] * pj->gpart->v_full[1] -
  210 :    98 :   203 :         pj->gpart->a_grav[1] * pj->gpart->v_full[0]
  211 :    99 :   232 :       pj->gpart->fof_data.group_stellar_mass;
  212 :   100 :   658 :       pow(pi->gpart->fof_data.group_stellar_mass / 102.329, 0.26178) *
  213 :   101 :   662 :   if (pi->gpart->fof_data.group_stellar_mass==0.f) warning("Wind particle is not linked to any galaxy");
  214 :   102 :   678 :       phys_const->const_newton_G*pi->gpart->fof_data.group_mass *
  215 :   104 :    63 :   double galaxy_stellar_mass = p->gpart->fof_data.group_stellar_mass;
  216 :   105 :   145 :       p->gpart->fof_data.group_stellar_mass;
  217 :   106 :   151 :       p->gpart->fof_data.group_mass * fb_props->mass_to_solar_mass;
  218 :   107 :   235 :     p->gpart->a_grav[1] * p->gpart->v_full[2] - 
  219 :   108 :   236 :         p->gpart->a_grav[2] * p->gpart->v_full[1],
  220 :   109 :   237 :     p->gpart->a_grav[2] * p->gpart->v_full[0] - 
  221 :   110 :   238 :         p->gpart->a_grav[0] * p->gpart->v_full[2],
  222 :   111 :   239 :     p->gpart->a_grav[0] * p->gpart->v_full[1] - 
  223 :   112 :   240 :         p->gpart->a_grav[1] * p->gpart->v_full[0]
  224 :   113 :   272 :   p->gpart->fof_data.is_grouppable = 0;
  225 :   115 :  2435 :       bp->gpart->fof_data.is_grouppable = 1;
  226 :   116 :  3603 :     p->gpart->fof_data.is_grouppable = 0;
  227 :   117 :  3619 :     p->gpart->fof_data.is_grouppable = 1;
  228 :   118 :  3621 :     p->gpart->fof_data.is_grouppable = 0;
  229 :   119 :  3625 :   p->gpart->fof_data.part_sfr = max(p->sf_data.SFR, 0.f);
  230 :   120 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  231 :   121 :  3636 :   return gpart->fof_data.is_grouppable;
  232 :   123 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  233 :   124 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  234 :   125 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
  235 :   126 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  236 :   127 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  237 :   128 :   536 :   355 :       sp->gpart->fof_data.group_mass;
  238 :   129 :   670 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  239 :   130 :   707 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  240 :   131 :   708 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  241 :   132 :   709 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
  242 :   133 :  1183 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  243 :   134 :  1184 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  244 :   135 :  1185 :   536 :   355 :       sp->gpart->fof_data.group_mass;
  245 :   136 :  1261 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
  246 :   137 :  1269 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
  247 :   138 :  1270 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
  248 :   139 :  1271 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
  249 :   140 :  1272 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  250 :   141 :  1273 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  251 :   142 :  1274 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  252 :   143 :  1275 :   331 :   sp->gpart->v_full[0] = sp->v[0];
  253 :   144 :  1276 :   332 :   sp->gpart->v_full[1] = sp->v[1];
  254 :   145 :  1277 :   333 :   sp->gpart->v_full[2] = sp->v[2];
  255 :   146 :  1447 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
  256 :   147 :  1490 :   251 :   sp->gpart->mass += gas_mass;
  257 :   148 :  1506 :   279 :   sp->gpart->v_full[0] = sp->v[0];
  258 :   149 :  1507 :   280 :   sp->gpart->v_full[1] = sp->v[1];
  259 :   150 :  1508 :   281 :   sp->gpart->v_full[2] = sp->v[2];
  260 :   151 :  1586 :   274 :   sp->gpart->x[0] = sp->x[0];
  261 :   152 :  1587 :   275 :   sp->gpart->x[1] = sp->x[1];
  262 :   153 :  1588 :   276 :   sp->gpart->x[2] = sp->x[2];
  263 :   154 :  1591 :   339 :     sp->gpart->mass = mass_star;
  264 :   155 :  1664 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  265 :   156 :  1665 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  266 :   157 :  1666 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  267 :   158 :  1818 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  268 :   159 :  1819 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  269 :   160 :  1820 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  270 :   161 :  1972 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  271 :   162 :  1973 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  272 :   163 :  1974 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  273 :   164 :  2121 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  274 :   165 :  2122 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  275 :   166 :  2123 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  276 :   167 :  2270 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  277 :   168 :  2271 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  278 :   169 :  2272 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  279 :   170 :  2420 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  280 :   171 :  2421 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  281 :   172 :  2422 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  282 :   173 :  2569 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  283 :   174 :  2570 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  284 :   175 :  2571 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  285 :   176 :  2718 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  286 :   177 :  2719 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  287 :   178 :  2720 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  288 :   179 :  2869 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  289 :   180 :  2870 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  290 :   181 :  2871 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  291 :   182 :  3018 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  292 :   183 :  3019 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  293 :   184 :  3020 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  294 :   185 :  3167 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  295 :   186 :  3168 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  296 :   187 :  3169 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  297 :   189 :    31 :   ret[0] = p->gpart->fof_data.group_id;
  298 :   190 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
  299 :   191 :    43 :   ret[0] = bp->gpart->fof_data.group_id;
  300 :   193 :   136 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  301 :   194 :   137 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  302 :   195 :   138 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  303 :   196 :   143 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  304 :   197 :   144 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  305 :   198 :   145 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  306 :   200 :    54 :     acc[0] += p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  307 :   201 :    55 :     acc[1] += p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  308 :   202 :    56 :     acc[2] += p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  309 :   204 :   127 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  310 :   205 :   128 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  311 :   206 :   129 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  312 :   207 :   134 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  313 :   208 :   135 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  314 :   209 :   136 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  315 :   211 :   138 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  316 :   212 :   139 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  317 :   213 :   140 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  318 :   214 :   145 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  319 :   215 :   146 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  320 :   216 :   147 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  321 :   218 :    98 :     p->gpart->v_full[0] = p->v_full[0];
  322 :   219 :    99 :     p->gpart->v_full[1] = p->v_full[1];
  323 :   220 :   100 :     p->gpart->v_full[2] = p->v_full[2];
  324 :   222 :   254 :     p->gpart->mass = p->conserved.mass;
  325 :   224 :   149 :     p->gpart->v_full[0] = p->v[0];
  326 :   225 :   150 :     p->gpart->v_full[1] = p->v[1];
  327 :   226 :   151 :     p->gpart->v_full[2] = p->v[2];
  328 :   228 :   696 :     a_grav[0] = p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  329 :   229 :   697 :     a_grav[1] = p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  330 :   230 :   698 :     a_grav[2] = p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  331 :   231 :   700 :     grav_kick_factor[0] = dt_grav * p->gpart->a_grav[0];
  332 :   232 :   701 :     grav_kick_factor[1] = dt_grav * p->gpart->a_grav[1];
  333 :   233 :   702 :     grav_kick_factor[2] = dt_grav * p->gpart->a_grav[2];
  334 :   234 :   704 :       grav_kick_factor[0] += dt_grav_mesh * p->gpart->a_grav_mesh[0];
  335 :   235 :   705 :       grav_kick_factor[1] += dt_grav_mesh * p->gpart->a_grav_mesh[1];
  336 :   236 :   706 :       grav_kick_factor[2] += dt_grav_mesh * p->gpart->a_grav_mesh[2];
  337 :   238 :   310 :     v[0] += p->gpart->a_grav[0] * dt_kick_grav;
  338 :   239 :   311 :     v[1] += p->gpart->a_grav[1] * dt_kick_grav;
  339 :   240 :   312 :     v[2] += p->gpart->a_grav[2] * dt_kick_grav;
  340 :   242 :   141 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  341 :   243 :   142 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  342 :   244 :   143 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  343 :   245 :   148 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  344 :   246 :   149 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  345 :   247 :   150 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  346 :   249 :   137 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  347 :   250 :   138 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  348 :   251 :   139 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  349 :   252 :   144 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  350 :   253 :   145 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  351 :   254 :   146 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  352 :   256 :   152 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  353 :   257 :   153 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  354 :   258 :   154 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  355 :   259 :   159 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  356 :   260 :   160 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  357 :   261 :   161 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  358 :   263 :   138 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  359 :   264 :   139 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  360 :   265 :   140 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  361 :   266 :   145 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  362 :   267 :   146 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  363 :   268 :   147 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  364 :   270 :   139 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  365 :   271 :   140 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  366 :   272 :   141 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  367 :   273 :   146 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  368 :   274 :   147 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  369 :   275 :   148 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  370 :   277 :   139 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  371 :   278 :   140 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  372 :   279 :   141 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  373 :   280 :   146 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  374 :   281 :   147 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  375 :   282 :   148 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  376 :   284 :    54 :     acc[0] += p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  377 :   285 :    55 :     acc[1] += p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  378 :   286 :    56 :     acc[2] += p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  379 :   288 :   134 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  380 :   289 :   135 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  381 :   290 :   136 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  382 :   291 :   141 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  383 :   292 :   142 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  384 :   293 :   143 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
  385 :   295 :   551 :     p->gpart->v_full[0] = p->v[0];
  386 :   296 :   552 :     p->gpart->v_full[1] = p->v[1];
  387 :   297 :   553 :     p->gpart->v_full[2] = p->v[2];
  388 :   299 :   250 :     p->v_full[0] += p->gpart->a_grav[0] * dt_kick_grav;
  389 :   300 :   251 :     p->v_full[1] += p->gpart->a_grav[1] * dt_kick_grav;
  390 :   301 :   252 :     p->v_full[2] += p->gpart->a_grav[2] * dt_kick_grav;
  391 :   302 :   257 :     p->v_full[0] += p->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  392 :   303 :   258 :     p->v_full[1] += p->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  393 :   304 :   259 :     p->v_full[2] += p->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  394 :   305 :   264 :     p->gpart->v_full[0] = p->v_full[0];
  395 :   306 :   265 :     p->gpart->v_full[1] = p->v_full[1];
  396 :   307 :   266 :     p->gpart->v_full[2] = p->v_full[2];
  397 :   308 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
  398 :   309 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
  399 :   310 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
  400 :   311 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  401 :   312 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  402 :   313 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  403 :   314 :   331 :   sp->gpart->v_full[0] = sp->v[0];
  404 :   315 :   332 :   sp->gpart->v_full[1] = sp->v[1];
  405 :   316 :   333 :   sp->gpart->v_full[2] = sp->v[2];
  406 :   317 :   378 :   bp->v[0] += bp->gpart->a_grav[0] * dt_kick_grav;
  407 :   318 :   379 :   bp->v[1] += bp->gpart->a_grav[1] * dt_kick_grav;
  408 :   319 :   380 :   bp->v[2] += bp->gpart->a_grav[2] * dt_kick_grav;
  409 :   320 :   383 :   bp->v[0] += bp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  410 :   321 :   384 :   bp->v[1] += bp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  411 :   322 :   385 :   bp->v[2] += bp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  412 :   323 :   388 :   bp->gpart->v_full[0] = bp->v[0];
  413 :   324 :   389 :   bp->gpart->v_full[1] = bp->v[1];
  414 :   325 :   390 :   bp->gpart->v_full[2] = bp->v[2];
  415 :   326 :   437 :   sink->v[0] += sink->gpart->a_grav[0] * dt_kick_grav;
  416 :   327 :   438 :   sink->v[1] += sink->gpart->a_grav[1] * dt_kick_grav;
  417 :   328 :   439 :   sink->v[2] += sink->gpart->a_grav[2] * dt_kick_grav;
  418 :   329 :   442 :   sink->v[0] += sink->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  419 :   330 :   443 :   sink->v[1] += sink->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  420 :   331 :   444 :   sink->v[2] += sink->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  421 :   332 :   447 :   sink->gpart->v_full[0] = sink->v[0];
  422 :   333 :   448 :   sink->gpart->v_full[1] = sink->v[1];
  423 :   334 :   449 :   sink->gpart->v_full[2] = sink->v[2];
  424 :   336 :    47 :       parts[k].gpart->id_or_neg_offset = -(k + offset);
  425 :   337 :    63 :       sparts[k].gpart->id_or_neg_offset = -(k + offset);
  426 :   338 :    79 :       sinks[k].gpart->id_or_neg_offset = -(k + offset);
  427 :   339 :    95 :       bparts[k].gpart->id_or_neg_offset = -(k + offset);
  428 :   340 :   433 :       if (parts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  429 :   341 :   438 :       if (parts[k].x[0] != parts[k].gpart->x[0] ||
  430 :   342 :   439 :           parts[k].x[1] != parts[k].gpart->x[1] ||
  431 :   343 :   440 :           parts[k].x[2] != parts[k].gpart->x[2])
  432 :   344 :   444 :       if (hydro_get_mass(&parts[k]) != parts[k].gpart->mass)
  433 :   345 :   448 :       if (parts[k].time_bin != parts[k].gpart->time_bin)
  434 :   346 :   460 :       if (sparts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  435 :   347 :   465 :       if (sparts[k].x[0] != sparts[k].gpart->x[0] ||
  436 :   348 :   466 :           sparts[k].x[1] != sparts[k].gpart->x[1] ||
  437 :   349 :   467 :           sparts[k].x[2] != sparts[k].gpart->x[2])
  438 :   350 :   471 :       if (sparts[k].mass != sparts[k].gpart->mass)
  439 :   351 :   475 :       if (sparts[k].time_bin != sparts[k].gpart->time_bin)
  440 :   352 :   487 :       if (bparts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  441 :   353 :   492 :       if (bparts[k].x[0] != bparts[k].gpart->x[0] ||
  442 :   354 :   493 :           bparts[k].x[1] != bparts[k].gpart->x[1] ||
  443 :   355 :   494 :           bparts[k].x[2] != bparts[k].gpart->x[2])
  444 :   356 :   498 :       if (bparts[k].mass != bparts[k].gpart->mass)
  445 :   357 :   502 :       if (bparts[k].time_bin != bparts[k].gpart->time_bin)
  446 :   358 :   514 :       if (sinks[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  447 :   359 :   519 :       if (sinks[k].x[0] != sinks[k].gpart->x[0] ||
  448 :   360 :   520 :           sinks[k].x[1] != sinks[k].gpart->x[1] ||
  449 :   361 :   521 :           sinks[k].x[2] != sinks[k].gpart->x[2])
  450 :   362 :   525 :       if (sinks[k].mass != sinks[k].gpart->mass)
  451 :   363 :   529 :       if (sinks[k].time_bin != sinks[k].gpart->time_bin)
  452 :   365 :   108 :         p->gpart->mass = hydro_get_mass(p);
  453 :   366 :   339 :         cell_bp->gpart->mass = cell_bp->mass;
  454 :   367 :   340 :         cell_bp->gpart->v_full[0] = cell_bp->v[0];
  455 :   368 :   341 :         cell_bp->gpart->v_full[1] = cell_bp->v[1];
  456 :   369 :   342 :         cell_bp->gpart->v_full[2] = cell_bp->v[2];
  457 :   371 :   187 :           xp->a_grav[0] = p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  458 :   372 :   188 :           xp->a_grav[1] = p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  459 :   373 :   189 :           xp->a_grav[2] = p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  460 :   374 :   747 :         if (p->gpart != NULL) p->gpart->time_bin = p->time_bin;
  461 :   375 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
  462 :   376 :  1008 :         sink->gpart->time_bin = get_time_bin(ti_new_step);
  463 :   377 :  1078 :         bp->gpart->time_bin = get_time_bin(ti_new_step);
  464 :   378 :  1445 :           p->gpart->time_bin = p->time_bin;
  465 :   379 :  1597 :         if (p->gpart != NULL) p->gpart->time_bin = new_time_bin;
  466 :   380 :  1620 :           p->gpart->time_bin = p->time_bin;
  467 :   382 :   251 :   sp->gpart->mass += gas_mass;
  468 :   383 :   279 :   sp->gpart->v_full[0] = sp->v[0];
  469 :   384 :   280 :   sp->gpart->v_full[1] = sp->v[1];
  470 :   385 :   281 :   sp->gpart->v_full[2] = sp->v[2];
  471 :   386 :   321 :   spi->gpart->mass += spj->mass;
  472 :   387 :   337 :   spi->gpart->v_full[0] = spi->v[0];
  473 :   388 :   338 :   spi->gpart->v_full[1] = spi->v[1];
  474 :   389 :   339 :   spi->gpart->v_full[2] = spi->v[2];
  475 :   391 :    66 :     float potential_i = pi->gpart->potential;
  476 :   392 :    67 :     float potential_j = pj->gpart->potential;
  477 :   394 :  2239 :       if (parts[k].time_bin != parts[k].gpart->time_bin) {
  478 :   395 :  2241 :               parts[k].gpart->time_bin);
  479 :   397 :   150 :     /* Check part->gpart->part linkeage. */
  480 :   398 :   151 :     if (p[k].gpart && p[k].gpart->id_or_neg_offset != -(k + delta))
  481 :   399 :   328 :     if (sp[k].gpart && sp[k].gpart->id_or_neg_offset != -(k + delta))
  482 :   400 :   419 :     if (bp[k].gpart && bp[k].gpart->id_or_neg_offset != -(k + delta))
  483 :   401 :   485 :     if (sink[k].gpart && sink[k].gpart->id_or_neg_offset != -(k + delta))
  484 :   403 :   223 :           s->parts[k].gpart->id_or_neg_offset = -k;
  485 :   404 :   226 :           s->parts[nr_parts].gpart->id_or_neg_offset = -nr_parts;
  486 :   405 :   275 :           s->sparts[k].gpart->id_or_neg_offset = -k;
  487 :   406 :   278 :           s->sparts[nr_sparts].gpart->id_or_neg_offset = -nr_sparts;
  488 :   407 :   325 :           s->bparts[k].gpart->id_or_neg_offset = -k;
  489 :   408 :   328 :           s->bparts[nr_bparts].gpart->id_or_neg_offset = -nr_bparts;
  490 :   409 :   376 :           s->sinks[k].gpart->id_or_neg_offset = -k;
  491 :   410 :   379 :           s->sinks[nr_sinks].gpart->id_or_neg_offset = -nr_sinks;
  492 :   412 :    76 :           parts[j].gpart->id_or_neg_offset = -(j + parts_offset);
  493 :   413 :    82 :         parts[k].gpart->id_or_neg_offset = -(k + parts_offset);
  494 :   414 :   138 :           sparts[j].gpart->id_or_neg_offset = -(j + sparts_offset);
  495 :   415 :   143 :         sparts[k].gpart->id_or_neg_offset = -(k + sparts_offset);
  496 :   416 :   199 :           bparts[j].gpart->id_or_neg_offset = -(j + bparts_offset);
  497 :   417 :   204 :         bparts[k].gpart->id_or_neg_offset = -(k + bparts_offset);
  498 :   418 :   259 :           sinks[j].gpart->id_or_neg_offset = -(j + sinks_offset);
  499 :   419 :   264 :         sinks[k].gpart->id_or_neg_offset = -(k + sinks_offset);
  500 :   421 :   274 :   sp->gpart->x[0] = sp->x[0];
  501 :   422 :   275 :   sp->gpart->x[1] = sp->x[1];
  502 :   423 :   276 :   sp->gpart->x[2] = sp->x[2];
  503 :   424 :   297 :   p->gpart->x[0] = p->x[0];
  504 :   425 :   298 :   p->gpart->x[1] = p->x[1];
  505 :   426 :   299 :   p->gpart->x[2] = p->x[2];
  506 :   427 :   339 :     sp->gpart->mass = mass_star;
  507 :   428 :   343 :     p->gpart->mass = new_mass_gas;
  508 :   430 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  509 :   431 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  510 :   432 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  511 :   434 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  512 :   435 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  513 :   436 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  514 :   438 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  515 :   439 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  516 :   440 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  517 :   441 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  518 :   442 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  519 :   443 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  520 :   444 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  521 :   445 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  522 :   446 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  523 :   447 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  524 :   448 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  525 :   449 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  526 :   450 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  527 :   451 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  528 :   452 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  529 :   453 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  530 :   454 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  531 :   455 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  532 :   457 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  533 :   458 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  534 :   459 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  535 :   460 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  536 :   461 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  537 :   462 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  538 :   463 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  539 :   464 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  540 :   465 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
./fof_data.group_stellar_mass:
   34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
   35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
   36 :   649 :     sp->gpart->type = swift_type_dark_matter;
  534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
  535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
  536 :   355 :       sp->gpart->fof_data.group_mass;
  670 :  3629 :   sp->gpart->fof_data.is_grouppable = 1;
  707 :    34 :   647 :     sp->gpart->time_bin = time_bin_inhibited;
  708 :    35 :   648 :     sp->gpart->id_or_neg_offset = sp->id;
  709 :    36 :   649 :     sp->gpart->type = swift_type_dark_matter;
 1183 :   534 :   321 :   const double galaxy_stellar_mass = max(sp->gpart->fof_data.group_stellar_mass,
 1184 :   535 :   349 :       sp->gpart->fof_data.group_stellar_mass;
 1185 :   536 :   355 :       sp->gpart->fof_data.group_mass;
 1261 :    37 :   ret[0] = sp->gpart->fof_data.group_id;
 1269 :   321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
 1270 :   322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
 1271 :   323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
 1272 :   326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
 1273 :   327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
 1274 :   328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
 1275 :   331 :   sp->gpart->v_full[0] = sp->v[0];
 1276 :   332 :   sp->gpart->v_full[1] = sp->v[1];
 1277 :   333 :   sp->gpart->v_full[2] = sp->v[2];
 1447 :   934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
 1490 :   251 :   sp->gpart->mass += gas_mass;
 1506 :   279 :   sp->gpart->v_full[0] = sp->v[0];
 1507 :   280 :   sp->gpart->v_full[1] = sp->v[1];
 1508 :   281 :   sp->gpart->v_full[2] = sp->v[2];
 1586 :   274 :   sp->gpart->x[0] = sp->x[0];
 1587 :   275 :   sp->gpart->x[1] = sp->x[1];
 1588 :   276 :   sp->gpart->x[2] = sp->x[2];
 1591 :   339 :     sp->gpart->mass = mass_star;
 1664 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1665 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1666 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1818 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1819 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1820 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 1972 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 1973 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 1974 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2121 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2122 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2123 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2270 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2271 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2272 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2420 :   478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2421 :   479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2422 :   480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2569 :   627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2570 :   628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2571 :   629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2718 :   776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2719 :   777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2720 :   778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 2869 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 2870 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 2871 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 3018 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 3019 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 3020 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
 3167 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
 3168 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
 3169 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
./fof_io.h:
   31 :   ret[0] = p->gpart->fof_data.group_id;
   37 :   ret[0] = sp->gpart->fof_data.group_id;
   43 :   ret[0] = bp->gpart->fof_data.group_id;
./hydro/AnarchyPU/hydro_io.h:
  136 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  137 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  138 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  143 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  144 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  145 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./hydro/Gadget2/hydro_csds.h:
   54 :     acc[0] += p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
   55 :     acc[1] += p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
   56 :     acc[2] += p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
./hydro/Gadget2/hydro_io.h:
  127 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  128 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  129 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  134 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  135 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  136 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./hydro/Gasoline/hydro_io.h:
  138 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  139 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  140 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  145 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  146 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  147 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./hydro/Gizmo/MFM/hydro_velocities.h:
   98 :     p->gpart->v_full[0] = p->v_full[0];
   99 :     p->gpart->v_full[1] = p->v_full[1];
  100 :     p->gpart->v_full[2] = p->v_full[2];
./hydro/Gizmo/MFV/hydro_flux.h:
  254 :     p->gpart->mass = p->conserved.mass;
./hydro/Gizmo/MFV/hydro_velocities.h:
  149 :     p->gpart->v_full[0] = p->v[0];
  150 :     p->gpart->v_full[1] = p->v[1];
  151 :     p->gpart->v_full[2] = p->v[2];
./hydro/Gizmo/hydro.h:
  696 :     a_grav[0] = p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  697 :     a_grav[1] = p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  698 :     a_grav[2] = p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  700 :     grav_kick_factor[0] = dt_grav * p->gpart->a_grav[0];
  701 :     grav_kick_factor[1] = dt_grav * p->gpart->a_grav[1];
  702 :     grav_kick_factor[2] = dt_grav * p->gpart->a_grav[2];
  704 :       grav_kick_factor[0] += dt_grav_mesh * p->gpart->a_grav_mesh[0];
  705 :       grav_kick_factor[1] += dt_grav_mesh * p->gpart->a_grav_mesh[1];
  706 :       grav_kick_factor[2] += dt_grav_mesh * p->gpart->a_grav_mesh[2];
./hydro/Gizmo/hydro_getters.h:
  310 :     v[0] += p->gpart->a_grav[0] * dt_kick_grav;
  311 :     v[1] += p->gpart->a_grav[1] * dt_kick_grav;
  312 :     v[2] += p->gpart->a_grav[2] * dt_kick_grav;
./hydro/Minimal/hydro_io.h:
  141 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  142 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  143 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  148 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  149 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  150 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./hydro/Phantom/hydro_io.h:
  137 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  138 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  139 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  144 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  145 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  146 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./hydro/Planetary/hydro_io.h:
  152 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  153 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  154 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  159 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  160 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  161 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./hydro/PressureEnergy/hydro_io.h:
  138 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  139 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  140 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  145 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  146 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  147 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./hydro/PressureEnergyMorrisMonaghanAV/hydro_io.h:
  139 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  140 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  141 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  146 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  147 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  148 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./hydro/PressureEntropy/hydro_io.h:
  139 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  140 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  141 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  146 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  147 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  148 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./hydro/SPHENIX/hydro_csds.h:
   54 :     acc[0] += p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
   55 :     acc[1] += p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
   56 :     acc[2] += p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
./hydro/SPHENIX/hydro_io.h:
  134 :     ret[0] += p->gpart->a_grav[0] * dt_kick_grav;
  135 :     ret[1] += p->gpart->a_grav[1] * dt_kick_grav;
  136 :     ret[2] += p->gpart->a_grav[2] * dt_kick_grav;
  141 :     ret[0] += p->gpart->a_grav_mesh[0] * dt_kick_grav_mesh;
  142 :     ret[1] += p->gpart->a_grav_mesh[1] * dt_kick_grav_mesh;
  143 :     ret[2] += p->gpart->a_grav_mesh[2] * dt_kick_grav_mesh;
./hydro/Shadowswift/hydro.h:
  551 :     p->gpart->v_full[0] = p->v[0];
  552 :     p->gpart->v_full[1] = p->v[1];
  553 :     p->gpart->v_full[2] = p->v[2];
./kick.h:
  250 :     p->v_full[0] += p->gpart->a_grav[0] * dt_kick_grav;
  251 :     p->v_full[1] += p->gpart->a_grav[1] * dt_kick_grav;
  252 :     p->v_full[2] += p->gpart->a_grav[2] * dt_kick_grav;
  257 :     p->v_full[0] += p->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  258 :     p->v_full[1] += p->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  259 :     p->v_full[2] += p->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  264 :     p->gpart->v_full[0] = p->v_full[0];
  265 :     p->gpart->v_full[1] = p->v_full[1];
  266 :     p->gpart->v_full[2] = p->v_full[2];
  321 :   sp->v[0] += sp->gpart->a_grav[0] * dt_kick_grav;
  322 :   sp->v[1] += sp->gpart->a_grav[1] * dt_kick_grav;
  323 :   sp->v[2] += sp->gpart->a_grav[2] * dt_kick_grav;
  326 :   sp->v[0] += sp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  327 :   sp->v[1] += sp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  328 :   sp->v[2] += sp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  331 :   sp->gpart->v_full[0] = sp->v[0];
  332 :   sp->gpart->v_full[1] = sp->v[1];
  333 :   sp->gpart->v_full[2] = sp->v[2];
  378 :   bp->v[0] += bp->gpart->a_grav[0] * dt_kick_grav;
  379 :   bp->v[1] += bp->gpart->a_grav[1] * dt_kick_grav;
  380 :   bp->v[2] += bp->gpart->a_grav[2] * dt_kick_grav;
  383 :   bp->v[0] += bp->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  384 :   bp->v[1] += bp->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  385 :   bp->v[2] += bp->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  388 :   bp->gpart->v_full[0] = bp->v[0];
  389 :   bp->gpart->v_full[1] = bp->v[1];
  390 :   bp->gpart->v_full[2] = bp->v[2];
  437 :   sink->v[0] += sink->gpart->a_grav[0] * dt_kick_grav;
  438 :   sink->v[1] += sink->gpart->a_grav[1] * dt_kick_grav;
  439 :   sink->v[2] += sink->gpart->a_grav[2] * dt_kick_grav;
  442 :   sink->v[0] += sink->gpart->a_grav_mesh[0] * dt_kick_mesh_grav;
  443 :   sink->v[1] += sink->gpart->a_grav_mesh[1] * dt_kick_mesh_grav;
  444 :   sink->v[2] += sink->gpart->a_grav_mesh[2] * dt_kick_mesh_grav;
  447 :   sink->gpart->v_full[0] = sink->v[0];
  448 :   sink->gpart->v_full[1] = sink->v[1];
  449 :   sink->gpart->v_full[2] = sink->v[2];
./part.c:
   47 :       parts[k].gpart->id_or_neg_offset = -(k + offset);
   63 :       sparts[k].gpart->id_or_neg_offset = -(k + offset);
   79 :       sinks[k].gpart->id_or_neg_offset = -(k + offset);
   95 :       bparts[k].gpart->id_or_neg_offset = -(k + offset);
  433 :       if (parts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  438 :       if (parts[k].x[0] != parts[k].gpart->x[0] ||
  439 :           parts[k].x[1] != parts[k].gpart->x[1] ||
  440 :           parts[k].x[2] != parts[k].gpart->x[2])
  444 :       if (hydro_get_mass(&parts[k]) != parts[k].gpart->mass)
  448 :       if (parts[k].time_bin != parts[k].gpart->time_bin)
  460 :       if (sparts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  465 :       if (sparts[k].x[0] != sparts[k].gpart->x[0] ||
  466 :           sparts[k].x[1] != sparts[k].gpart->x[1] ||
  467 :           sparts[k].x[2] != sparts[k].gpart->x[2])
  471 :       if (sparts[k].mass != sparts[k].gpart->mass)
  475 :       if (sparts[k].time_bin != sparts[k].gpart->time_bin)
  487 :       if (bparts[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  492 :       if (bparts[k].x[0] != bparts[k].gpart->x[0] ||
  493 :           bparts[k].x[1] != bparts[k].gpart->x[1] ||
  494 :           bparts[k].x[2] != bparts[k].gpart->x[2])
  498 :       if (bparts[k].mass != bparts[k].gpart->mass)
  502 :       if (bparts[k].time_bin != bparts[k].gpart->time_bin)
  514 :       if (sinks[k].gpart->id_or_neg_offset != -(ptrdiff_t)k) {
  519 :       if (sinks[k].x[0] != sinks[k].gpart->x[0] ||
  520 :           sinks[k].x[1] != sinks[k].gpart->x[1] ||
  521 :           sinks[k].x[2] != sinks[k].gpart->x[2])
  525 :       if (sinks[k].mass != sinks[k].gpart->mass)
  529 :       if (sinks[k].time_bin != sinks[k].gpart->time_bin)
./runner_black_holes.c:
  108 :         p->gpart->mass = hydro_get_mass(p);
  339 :         cell_bp->gpart->mass = cell_bp->mass;
  340 :         cell_bp->gpart->v_full[0] = cell_bp->v[0];
  341 :         cell_bp->gpart->v_full[1] = cell_bp->v[1];
  342 :         cell_bp->gpart->v_full[2] = cell_bp->v[2];
./runner_time_integration.c:
  187 :           xp->a_grav[0] = p->gpart->a_grav[0] + p->gpart->a_grav_mesh[0];
  188 :           xp->a_grav[1] = p->gpart->a_grav[1] + p->gpart->a_grav_mesh[1];
  189 :           xp->a_grav[2] = p->gpart->a_grav[2] + p->gpart->a_grav_mesh[2];
  747 :         if (p->gpart != NULL) p->gpart->time_bin = p->time_bin;
  934 :         sp->gpart->time_bin = get_time_bin(ti_new_step);
 1008 :         sink->gpart->time_bin = get_time_bin(ti_new_step);
 1078 :         bp->gpart->time_bin = get_time_bin(ti_new_step);
 1445 :           p->gpart->time_bin = p->time_bin;
 1597 :         if (p->gpart != NULL) p->gpart->time_bin = new_time_bin;
 1620 :           p->gpart->time_bin = p->time_bin;
./sink/GEAR/sink.h:
  251 :   sp->gpart->mass += gas_mass;
  279 :   sp->gpart->v_full[0] = sp->v[0];
  280 :   sp->gpart->v_full[1] = sp->v[1];
  281 :   sp->gpart->v_full[2] = sp->v[2];
  321 :   spi->gpart->mass += spj->mass;
  337 :   spi->gpart->v_full[0] = spi->v[0];
  338 :   spi->gpart->v_full[1] = spi->v[1];
  339 :   spi->gpart->v_full[2] = spi->v[2];
./sink/GEAR/sink_iact.h:
   66 :     float potential_i = pi->gpart->potential;
   67 :     float potential_j = pj->gpart->potential;
./space.c:
 2239 :       if (parts[k].time_bin != parts[k].gpart->time_bin) {
 2241 :               parts[k].gpart->time_bin);
./space_first_init.c:
  150 :     /* Check part->gpart->part linkeage. */
  151 :     if (p[k].gpart && p[k].gpart->id_or_neg_offset != -(k + delta))
  328 :     if (sp[k].gpart && sp[k].gpart->id_or_neg_offset != -(k + delta))
  419 :     if (bp[k].gpart && bp[k].gpart->id_or_neg_offset != -(k + delta))
  485 :     if (sink[k].gpart && sink[k].gpart->id_or_neg_offset != -(k + delta))
./space_rebuild.c:
  223 :           s->parts[k].gpart->id_or_neg_offset = -k;
  226 :           s->parts[nr_parts].gpart->id_or_neg_offset = -nr_parts;
  275 :           s->sparts[k].gpart->id_or_neg_offset = -k;
  278 :           s->sparts[nr_sparts].gpart->id_or_neg_offset = -nr_sparts;
  325 :           s->bparts[k].gpart->id_or_neg_offset = -k;
  328 :           s->bparts[nr_bparts].gpart->id_or_neg_offset = -nr_bparts;
  376 :           s->sinks[k].gpart->id_or_neg_offset = -k;
  379 :           s->sinks[nr_sinks].gpart->id_or_neg_offset = -nr_sinks;
./space_sort.c:
   76 :           parts[j].gpart->id_or_neg_offset = -(j + parts_offset);
   82 :         parts[k].gpart->id_or_neg_offset = -(k + parts_offset);
  138 :           sparts[j].gpart->id_or_neg_offset = -(j + sparts_offset);
  143 :         sparts[k].gpart->id_or_neg_offset = -(k + sparts_offset);
  199 :           bparts[j].gpart->id_or_neg_offset = -(j + bparts_offset);
  204 :         bparts[k].gpart->id_or_neg_offset = -(k + bparts_offset);
  259 :           sinks[j].gpart->id_or_neg_offset = -(j + sinks_offset);
  264 :         sinks[k].gpart->id_or_neg_offset = -(k + sinks_offset);
./star_formation/GEAR/star_formation.h:
  274 :   sp->gpart->x[0] = sp->x[0];
  275 :   sp->gpart->x[1] = sp->x[1];
  276 :   sp->gpart->x[2] = sp->x[2];
  297 :   p->gpart->x[0] = p->x[0];
  298 :   p->gpart->x[1] = p->x[1];
  299 :   p->gpart->x[2] = p->x[2];
  339 :     sp->gpart->mass = mass_star;
  343 :     p->gpart->mass = new_mass_gas;
./stars/Basic/stars_csds.h:
   40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
   41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
   42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
./stars/GEAR/stars_csds.h:
   42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
   43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
   44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
./stars/fof_data:
   19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
   20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
   21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  478 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  479 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  480 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  627 :   173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  628 :   174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  629 :   175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  776 :   327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  777 :   328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  778 :   329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
./stars/fof_data.:
   19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
   20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
   21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  173 :    42 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  174 :    43 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  175 :    44 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
  327 :    19 :    40 :   acc[0] = sp->gpart->a_grav[0] + sp->gpart->a_grav_mesh[0];
  328 :    20 :    41 :   acc[1] = sp->gpart->a_grav[1] + sp->gpart->a_grav_mesh[1];
  329 :    21 :    42 :   acc[2] = sp->gpart->a_grav[2] + sp->gpart->a_grav_mesh[2];
